define(["jquery","espEnvironment","espService","espModel","prompter"],function($,espEnvironment,espService,espModel,prompter){return function(config){if(espEnvironment.externalValue("coursewareobjectEditorForOldApi")){var entry=config.entry||config.$template,questionType=config.questionType||config.entry||config.$template,params={chapter_id:espEnvironment.location.params.chapter_id,chapter_name:espEnvironment.location.params.chapter_name,creator:espEnvironment.location.params.creator,question_type:questionType,nonQuestionData:"true"};return espEnvironment.location.params.question_base&&(params.question_base=espEnvironment.location.params.question_base),$.post(espEnvironment.url.external("coursewareobjectEditorForOldApi",{entry:entry}),params).then(function(metadata){return espEnvironment.url.makeRoot("/")("/",$.extend({},espEnvironment.location.params,{file_path:metadata.physic_path,id:metadata.id,question_type:questionType,interaction:"true"}))})}if(espEnvironment.externalValue("coursewareobjectEditorForOld")){var entry=config.entry;if(!entry){var idx=config.$template.indexOf("_");entry=-1==idx?config.$template:config.$template.substring(idx+1)}return espEnvironment.url.external("coursewareobjectEditorForOld",$.extend({entry:entry,edu_chapter_id:espEnvironment.location.params.chapter_id,token_info:espEnvironment.encryptedLoginInfo},espEnvironment.location.params))}}});