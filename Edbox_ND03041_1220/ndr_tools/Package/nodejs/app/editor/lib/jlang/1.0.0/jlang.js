!function(global){function EventManagerDef(supportEvents){var events={},specifiedEvent=!1;if("array"==typeof supportEvents){for(var i=0;i<supportEvents.length;i++)events[supportEvents[i]]=[];specifiedEvent=!0}this.on=function(eventName,callback){if(eventName){if("string"!=typeof eventName)for(var key in eventName)this.on(key,eventName[key]);var callbacks=events[eventName]||!specifiedEvent&&(events[eventName]=[]);return callbacks&&$.isFunction(callback)&&callbacks.push(callback),this}},this.off=function(eventName,callback){if("string"!=typeof eventName)for(var key in eventName)this.off(key,eventName[key]);var callbacks=events[eventName];if(callbacks)if(callback){for(var i=0;i<callbacks.length;i++)if(callback==callbacks[i]){callbacks.splice(i,1);break}}else callbacks.length=0;return this},this.trigger=function(eventName){var results=[],callbacks=events[eventName];if(callbacks){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);for(var i=0;i<callbacks.length;i++){var result=callbacks[i].apply(null,args);results.push(result)}}return results}}var jlang=global.jlang={};jlang.extend=function(target){target||(target={});for(var i=1;i<arguments.length;i++){var obj=arguments[i];if(obj)for(var key in obj)null!==obj[key]&&void 0!==obj[key]&&(target[key]=obj[key])}return target},jlang.proxy=function(fn,context,before,after,interceptorContext){if("function"==typeof fn){return function(){if("function"==typeof before){var beforeResult=before.apply(interceptorContext||context||this,arguments);if(void 0!==beforeResult)return beforeResult}var result=fn.apply(context||this,arguments);if("function"==typeof after){var afterResult=after.apply(interceptorContext||context||this,arguments);if(void 0!==afterResult)return afterResult}return result}}},jlang.decorate=function(decorator,target,interceptors){for(var key in target){var value=target[key];"function"==typeof value&&(decorator[key]=jlang.proxy(value,target,interceptors["before_"+key],interceptors["after_"+key],decorator))}return decorator},jlang.asEventManager=function(obj,client,supportEvents){"array"==typeof client&&(supportEvents=client,client=null);var em=jlang.extend(obj,new EventManagerDef(supportEvents));client&&(client.on=em.on,client.off=em.off)},jlang.EventManager=function(client,supportEvents){"array"==typeof client&&(supportEvents=client,client=null);var em=new EventManagerDef(supportEvents);return client&&(client.on=em.on,client.off=em.off),em}}(window);