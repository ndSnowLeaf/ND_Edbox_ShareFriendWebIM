!function(){function loadImageLib(query,dialog){$.ajax({url:CKEDITOR.config.assetServer+"/v0.2/assets?words="+(query.keyword||"")+"&type=image&page="+query.pageIndex+"&size="+query.pageSize,type:"get",contentType:"application/json; charset=utf-8",dataType:"json",success:function(data){var div=dialog.getContentElement("imageLib","selectImageLib").getElement().$;$(div).html("");for(var items=data.items,i=0;i<items.length;i++){var item=items[i],src=item.href;-1==src.indexOf("http:")&&(src=CKEDITOR.config.assetServer+src);$("<div class='imageItem' style='float:left;height:160px;width:160px;padding:0 20px 20px 20px;'><img src='"+src+"' style='width:160px'/><p>"+item.title+"</p></div>").appendTo($(div))}$(div).find("img").click(function(){$(div).find("img").removeClass("focus"),$(this).addClass("focus");var src=this.src;dialog.setValueOf("info","txtUrl",src)})}})}var imageDialog=function(editor,dialogType){function commitContent(){var args=arguments,inlineStyleField=this.getContentElement("advanced","txtdlgGenStyle");inlineStyleField&&inlineStyleField.commit.apply(inlineStyleField,args),this.foreach(function(widget){widget.commit&&"txtdlgGenStyle"!=widget.id&&widget.commit.apply(widget,args)})}function commitInternally(targetFields){if(!incommit){incommit=1;var dialog=this.getDialog(),element=dialog.imageElement;if(element){this.commit(IMAGE,element),targetFields=[].concat(targetFields);for(var field,length=targetFields.length,i=0;i<length;i++)(field=dialog.getContentElement.apply(dialog,targetFields[i].split(":")))&&field.setup(IMAGE,element)}incommit=0}}var incommit,previewPreloader,IMAGE=1,regexGetSize=/^\s*(\d+)((px)|\%)?\s*$/i,onSizeChange=function(){var value=this.getValue(),dialog=this.getDialog(),aMatch=value.match(regexGetSize);if(aMatch&&("%"==aMatch[2]&&switchLockRatio(dialog,!1),value=aMatch[1]),dialog.lockRatio){var oImageOriginal=dialog.originalElement;"true"==oImageOriginal.getCustomData("isReady")&&("txtHeight"==this.id?(value&&"0"!=value&&(value=Math.round(oImageOriginal.$.width*(value/oImageOriginal.$.height))),isNaN(value)||dialog.setValueOf("info","txtWidth",value)):(value&&"0"!=value&&(value=Math.round(oImageOriginal.$.height*(value/oImageOriginal.$.width))),isNaN(value)||dialog.setValueOf("info","txtHeight",value)))}updatePreview(dialog)},updatePreview=function(dialog){return dialog.originalElement&&dialog.preview?(dialog.commitContent(4,dialog.preview),0):1},switchLockRatio=function(dialog,value){if(!dialog.getContentElement("info","ratioLock"))return null;var oImageOriginal=dialog.originalElement;if(!oImageOriginal)return null;if("check"==value){if(!dialog.userlockRatio&&"true"==oImageOriginal.getCustomData("isReady")){var width=dialog.getValueOf("info","txtWidth"),height=dialog.getValueOf("info","txtHeight"),originalRatio=1e3*oImageOriginal.$.width/oImageOriginal.$.height,thisRatio=1e3*width/height;dialog.lockRatio=!1,width||height?isNaN(originalRatio)||isNaN(thisRatio)||Math.round(originalRatio)==Math.round(thisRatio)&&(dialog.lockRatio=!0):dialog.lockRatio=!0}}else void 0!==value?dialog.lockRatio=value:(dialog.userlockRatio=1,dialog.lockRatio=!dialog.lockRatio);var ratioButton=CKEDITOR.document.getById(btnLockSizesId);if(dialog.lockRatio?ratioButton.removeClass("cke_btn_unlocked"):ratioButton.addClass("cke_btn_unlocked"),ratioButton.setAttribute("aria-checked",dialog.lockRatio),CKEDITOR.env.hc){ratioButton.getChild(0).setHtml(dialog.lockRatio?CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢")}return dialog.lockRatio},resetSize=function(dialog){var oImageOriginal=dialog.originalElement;if("true"==oImageOriginal.getCustomData("isReady")){var widthField=dialog.getContentElement("info","txtWidth"),heightField=dialog.getContentElement("info","txtHeight");widthField&&widthField.setValue(oImageOriginal.$.width),heightField&&heightField.setValue(oImageOriginal.$.height)}updatePreview(dialog)},setupDimension=function(type,element){function checkDimension(size,defaultValue){var aMatch=size.match(regexGetSize);return aMatch?("%"==aMatch[2]&&(aMatch[1]+="%",switchLockRatio(dialog,!1)),aMatch[1]):defaultValue}if(type==IMAGE){var dialog=this.getDialog(),value="",dimension="txtWidth"==this.id?"width":"height",size=element.getAttribute(dimension);size&&(value=checkDimension(size,value)),value=checkDimension(element.getStyle(dimension),value),this.setValue(value)}},onImgLoadEvent=function(){var original=this.originalElement,loader=CKEDITOR.document.getById(imagePreviewLoaderId);original.setCustomData("isReady","true"),original.removeListener("load",onImgLoadEvent),original.removeListener("error",onImgLoadErrorEvent),original.removeListener("abort",onImgLoadErrorEvent),loader&&loader.setStyle("display","none"),this.dontResetSize||resetSize(this),this.firstLoad&&CKEDITOR.tools.setTimeout(function(){switchLockRatio(this,"check")},0,this),this.firstLoad=!1,this.dontResetSize=!1,updatePreview(this)},onImgLoadErrorEvent=function(){var original=this.originalElement,loader=CKEDITOR.document.getById(imagePreviewLoaderId);original.removeListener("load",onImgLoadEvent),original.removeListener("error",onImgLoadErrorEvent),original.removeListener("abort",onImgLoadErrorEvent);var noimage=CKEDITOR.getUrl(CKEDITOR.plugins.get("image").path+"images/noimage.png");this.preview&&this.preview.setAttribute("src",noimage),loader&&loader.setStyle("display","none"),switchLockRatio(this,!1)},numbering=function(id){return CKEDITOR.tools.getNextId()+"_"+id},btnLockSizesId=numbering("btnLockSizes"),btnResetSizeId=numbering("btnResetSize"),imagePreviewLoaderId=numbering("ImagePreviewLoader"),previewLinkId=numbering("previewLink"),previewImageId=numbering("previewImage");return{title:editor.lang.image["image"==dialogType?"title":"titleButton"],minWidth:860,minHeight:360,onShow:function(){this.imageElement=!1,this.linkElement=!1,this.imageEditMode=!1,this.linkEditMode=!1,this.lockRatio=!0,this.userlockRatio=0,this.dontResetSize=!1,this.firstLoad=!0,this.addLink=!1;var editor=this.getParentEditor(),sel=editor.getSelection(),element=sel&&sel.getSelectedElement(),link=element&&editor.elementPath(element).contains("a",1),loader=CKEDITOR.document.getById(imagePreviewLoaderId);if(loader&&loader.setStyle("display","none"),previewPreloader=new CKEDITOR.dom.element("img",editor.document),this.preview=CKEDITOR.document.getById(previewImageId),this.originalElement=editor.document.createElement("img"),this.originalElement.setAttribute("alt",""),this.originalElement.setCustomData("isReady","false"),link){this.linkElement=link,this.linkEditMode=!0;var linkChildren=link.getChildren();if(1==linkChildren.count()){var childTagName=linkChildren.getItem(0).getName();"img"!=childTagName&&"input"!=childTagName||(this.imageElement=linkChildren.getItem(0),"img"==this.imageElement.getName()?this.imageEditMode="img":"input"==this.imageElement.getName()&&(this.imageEditMode="input"))}"image"==dialogType&&this.setupContent(2,link)}this.customImageElement?(this.imageEditMode="img",this.imageElement=this.customImageElement,delete this.customImageElement):(element&&"img"==element.getName()&&!element.data("cke-realelement")||element&&"input"==element.getName()&&"image"==element.getAttribute("type"))&&(this.imageEditMode=element.getName(),this.imageElement=element),this.imageEditMode?(this.cleanImageElement=this.imageElement,this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(IMAGE,this.imageElement)):this.imageElement=editor.document.createElement("img"),switchLockRatio(this,!0),CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display","none"))},onOk:function(){if(this.imageEditMode){var imgTagName=this.imageEditMode;"image"==dialogType&&"input"==imgTagName&&confirm(editor.lang.image.button2Img)?(imgTagName="img",this.imageElement=editor.document.createElement("img"),this.imageElement.setAttribute("alt",""),editor.insertElement(this.imageElement)):"image"!=dialogType&&"img"==imgTagName&&confirm(editor.lang.image.img2Button)?(imgTagName="input",this.imageElement=editor.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),editor.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==dialogType?this.imageElement=editor.document.createElement("img"):(this.imageElement=editor.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt","");this.linkEditMode||(this.linkElement=editor.document.createElement("a")),this.commitContent(IMAGE,this.imageElement),this.commitContent(2,this.linkElement),this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style"),this.imageEditMode?!this.linkEditMode&&this.addLink?(editor.insertElement(this.linkElement),this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(editor.getSelection().selectElement(this.linkElement),editor.insertElement(this.imageElement)):this.addLink?this.linkEditMode?editor.insertElement(this.imageElement):(editor.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):editor.insertElement(this.imageElement)},onLoad:function(){"image"!=dialogType&&this.hidePage("Link");var doc=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(doc.getById(btnResetSizeId),5),this.addFocusable(doc.getById(btnLockSizesId),5)),this.commitContent=commitContent},onHide:function(){this.preview&&this.commitContent(8,this.preview),this.originalElement&&(this.originalElement.removeListener("load",onImgLoadEvent),this.originalElement.removeListener("error",onImgLoadErrorEvent),this.originalElement.removeListener("abort",onImgLoadErrorEvent),this.originalElement.remove(),this.originalElement=!1),delete this.imageElement},contents:[{id:"imageLib",label:editor.lang.ndimage.imagelib,elements:[{type:"hbox",widths:["280px","110px"],align:"right",children:[{id:"imageLibSearchText",type:"text"},{type:"button",id:"imageLibSearchButton",align:"center",label:editor.lang.ndimage.searchlib,onClick:function(){var dialog=this.getDialog(),keyword=dialog.getValueOf("imageLib","imageLibSearchText");keyword||(keyword=""),loadImageLib({type:"image",pageIndex:1,pageSize:100,keyword:keyword},dialog)}}]},{type:"html",id:"selectImageLib",style:"width:95%;",onLoad:function(){var dialog=this.getDialog(),keyword=dialog.getValueOf("imageLib","imageLibSearchText");keyword||(keyword=""),loadImageLib({type:"image",pageIndex:1,pageSize:100,keyword:keyword},dialog)},html:'<div style="height:350px;float:left;"></div>'}]},{id:"info",label:editor.lang.image.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["280px","110px"],align:"right",children:[{id:"txtUrl",type:"text",label:editor.lang.common.url,required:!0,onChange:function(){var dialog=this.getDialog(),newUrl=this.getValue();if(newUrl.length>0){dialog=this.getDialog();var original=dialog.originalElement;dialog.preview&&dialog.preview.removeStyle("display"),original.setCustomData("isReady","false");var loader=CKEDITOR.document.getById(imagePreviewLoaderId);loader&&loader.setStyle("display",""),original.on("load",onImgLoadEvent,dialog),original.on("error",onImgLoadErrorEvent,dialog),original.on("abort",onImgLoadErrorEvent,dialog),original.setAttribute("src",newUrl),dialog.preview&&(previewPreloader.setAttribute("src",newUrl),dialog.preview.setAttribute("src",previewPreloader.$.src),updatePreview(dialog))}else dialog.preview&&(dialog.preview.removeAttribute("src"),dialog.preview.setStyle("display","none"))},setup:function(type,element){if(type==IMAGE){var url=element.data("cke-saved-src")||element.getAttribute("src"),field=this;this.getDialog().dontResetSize=!0,field.setValue(url),field.setInitValue()}},commit:function(type,element){type==IMAGE&&(this.getValue()||this.isChanged())?(element.data("cke-saved-src",this.getValue()),element.setAttribute("src",this.getValue())):8==type&&(element.setAttribute("src",""),element.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(editor.lang.image.urlMissing)},{type:"button",id:"browse",style:"display:inline-block;margin-top:14px;",align:"center",label:editor.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"}]}]},{id:"txtAlt",type:"text",label:editor.lang.image.alt,accessKey:"T",default:"",onChange:function(){updatePreview(this.getDialog())},setup:function(type,element){type==IMAGE&&this.setValue(element.getAttribute("alt"))},commit:function(type,element){type==IMAGE?(this.getValue()||this.isChanged())&&element.setAttribute("alt",this.getValue()):4==type?element.setAttribute("alt",this.getValue()):8==type&&element.removeAttribute("alt")}},{type:"hbox",children:[{id:"basic",type:"vbox",children:[{type:"hbox",requiredContent:"img{width,height}",widths:["50%","50%"],children:[{type:"vbox",padding:1,children:[{type:"text",width:"45px",id:"txtWidth",label:editor.lang.common.width,onKeyUp:onSizeChange,onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:function(){var aMatch=this.getValue().match(/(^\s*(\d+)((px)|\%)?\s*$)|^$/i),isValid=!(!aMatch||0===parseInt(aMatch[1],10));return isValid||alert(editor.lang.common.invalidWidth),isValid},setup:setupDimension,commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE)value&&editor.activeFilter.check("img{width,height}")?element.setStyle("width",CKEDITOR.tools.cssLength(value)):element.removeStyle("width"),!internalCommit&&element.removeAttribute("width");else if(4==type){var aMatch=value.match(regexGetSize);if(aMatch)element.setStyle("width",CKEDITOR.tools.cssLength(value));else{var oImageOriginal=this.getDialog().originalElement;"true"==oImageOriginal.getCustomData("isReady")&&element.setStyle("width",oImageOriginal.$.width+"px")}}else 8==type&&(element.removeAttribute("width"),element.removeStyle("width"))}},{type:"text",id:"txtHeight",width:"45px",label:editor.lang.common.height,onKeyUp:onSizeChange,onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:function(){var aMatch=this.getValue().match(/(^\s*(\d+)((px)|\%)?\s*$)|^$/i),isValid=!(!aMatch||0===parseInt(aMatch[1],10));return isValid||alert(editor.lang.common.invalidHeight),isValid},setup:setupDimension,commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE)value&&editor.activeFilter.check("img{width,height}")?element.setStyle("height",CKEDITOR.tools.cssLength(value)):element.removeStyle("height"),!internalCommit&&element.removeAttribute("height");else if(4==type){var aMatch=value.match(regexGetSize);if(aMatch)element.setStyle("height",CKEDITOR.tools.cssLength(value));else{var oImageOriginal=this.getDialog().originalElement;"true"==oImageOriginal.getCustomData("isReady")&&element.setStyle("height",oImageOriginal.$.height+"px")}}else 8==type&&(element.removeAttribute("height"),element.removeStyle("height"))}}]},{id:"ratioLock",type:"html",style:"margin-top:30px;width:40px;height:40px;",onLoad:function(){var resetButton=CKEDITOR.document.getById(btnResetSizeId),ratioButton=CKEDITOR.document.getById(btnLockSizesId);resetButton&&(resetButton.on("click",function(evt){resetSize(this),evt.data&&evt.data.preventDefault()},this.getDialog()),resetButton.on("mouseover",function(){this.addClass("cke_btn_over")},resetButton),resetButton.on("mouseout",function(){this.removeClass("cke_btn_over")},resetButton)),ratioButton&&(ratioButton.on("click",function(evt){switchLockRatio(this);var oImageOriginal=this.originalElement,width=this.getValueOf("info","txtWidth");if("true"==oImageOriginal.getCustomData("isReady")&&width){var height=oImageOriginal.$.height/oImageOriginal.$.width*width;isNaN(height)||(this.setValueOf("info","txtHeight",Math.round(height)),updatePreview(this))}evt.data&&evt.data.preventDefault()},this.getDialog()),ratioButton.on("mouseover",function(){this.addClass("cke_btn_over")},ratioButton),ratioButton.on("mouseout",function(){this.removeClass("cke_btn_over")},ratioButton))},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+editor.lang.image.lockRatio+'" class="cke_btn_locked" id="'+btnLockSizesId+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+editor.lang.image.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+editor.lang.image.resetSize+'" class="cke_btn_reset" id="'+btnResetSizeId+'" role="button"><span class="cke_label">'+editor.lang.image.resetSize+"</span></a></div>"}]},{type:"vbox",padding:1,children:[{type:"text",id:"txtBorder",requiredContent:"img{border-width}",width:"60px",label:editor.lang.image.border,default:"",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateBorder),setup:function(type,element){if(type==IMAGE){var value,borderStyle=element.getStyle("border-width");borderStyle=borderStyle&&borderStyle.match(/^(\d+px)(?: \1 \1 \1)?$/),value=borderStyle&&parseInt(borderStyle[1],10),isNaN(parseInt(value,10))&&(value=element.getAttribute("border")),this.setValue(value)}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);type==IMAGE||4==type?(isNaN(value)?!value&&this.isChanged()&&element.removeStyle("border"):(element.setStyle("border-width",CKEDITOR.tools.cssLength(value)),element.setStyle("border-style","solid")),internalCommit||type!=IMAGE||element.removeAttribute("border")):8==type&&(element.removeAttribute("border"),element.removeStyle("border-width"),element.removeStyle("border-style"),element.removeStyle("border-color"))}},{type:"text",id:"txtHSpace",requiredContent:"img{margin-left,margin-right}",width:"60px",label:editor.lang.image.hSpace,default:"",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateHSpace),setup:function(type,element){if(type==IMAGE){var value,marginLeftPx,marginRightPx,marginLeftStyle=element.getStyle("margin-left"),marginRightStyle=element.getStyle("margin-right");marginLeftStyle=marginLeftStyle&&marginLeftStyle.match(/^\d+px$/),marginRightStyle=marginRightStyle&&marginRightStyle.match(/^\d+px$/),marginLeftPx=parseInt(marginLeftStyle,10),marginRightPx=parseInt(marginRightStyle,10),value=marginLeftPx==marginRightPx&&marginLeftPx,isNaN(parseInt(value,10))&&(value=element.getAttribute("hspace")),this.setValue(value)}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);type==IMAGE||4==type?(isNaN(value)?!value&&this.isChanged()&&(element.removeStyle("margin-left"),element.removeStyle("margin-right")):(element.setStyle("margin-left",CKEDITOR.tools.cssLength(value)),element.setStyle("margin-right",CKEDITOR.tools.cssLength(value))),internalCommit||type!=IMAGE||element.removeAttribute("hspace")):8==type&&(element.removeAttribute("hspace"),element.removeStyle("margin-left"),element.removeStyle("margin-right"))}},{type:"text",id:"txtVSpace",requiredContent:"img{margin-top,margin-bottom}",width:"60px",label:editor.lang.image.vSpace,default:"",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateVSpace),setup:function(type,element){if(type==IMAGE){var value,marginTopPx,marginBottomPx,marginTopStyle=element.getStyle("margin-top"),marginBottomStyle=element.getStyle("margin-bottom");marginTopStyle=marginTopStyle&&marginTopStyle.match(/^\d+px$/),marginBottomStyle=marginBottomStyle&&marginBottomStyle.match(/^\d+px$/),marginTopPx=parseInt(marginTopStyle,10),marginBottomPx=parseInt(marginBottomStyle,10),value=marginTopPx==marginBottomPx&&marginTopPx,isNaN(parseInt(value,10))&&(value=element.getAttribute("vspace")),this.setValue(value)}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);type==IMAGE||4==type?(isNaN(value)?!value&&this.isChanged()&&(element.removeStyle("margin-top"),element.removeStyle("margin-bottom")):(element.setStyle("margin-top",CKEDITOR.tools.cssLength(value)),element.setStyle("margin-bottom",CKEDITOR.tools.cssLength(value))),internalCommit||type!=IMAGE||element.removeAttribute("vspace")):8==type&&(element.removeAttribute("vspace"),element.removeStyle("margin-top"),element.removeStyle("margin-bottom"))}},{id:"cmbAlign",requiredContent:"img{float}",type:"select",widths:["35%","65%"],style:"width:90px",label:editor.lang.common.align,default:"",items:[[editor.lang.common.notSet,""],[editor.lang.common.alignLeft,"left"],[editor.lang.common.alignRight,"right"]],onChange:function(){updatePreview(this.getDialog()),commitInternally.call(this,"advanced:txtdlgGenStyle")},setup:function(type,element){if(type==IMAGE){var value=element.getStyle("float");switch(value){case"inherit":case"none":value=""}!value&&(value=(element.getAttribute("align")||"").toLowerCase()),this.setValue(value)}},commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE||4==type){if(value?element.setStyle("float",value):element.removeStyle("float"),!internalCommit&&type==IMAGE)switch(value=(element.getAttribute("align")||"").toLowerCase()){case"left":case"right":element.removeAttribute("align")}}else 8==type&&element.removeStyle("float")}}]}]},{type:"vbox",height:"250px",children:[{type:"html",id:"htmlPreview",style:"width:95%;",html:"<div>"+CKEDITOR.tools.htmlEncode(editor.lang.common.preview)+'<br><div id="'+imagePreviewLoaderId+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+previewLinkId+'"><img id="'+previewImageId+'" alt="" /></a>'+(editor.config.image_previewText||"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Maecenas feugiat consequat diam. Maecenas metus. Vivamus diam purus, cursus a, commodo non, facilisis vitae, nulla. Aenean dictum lacinia tortor. Nunc iaculis, nibh non iaculis aliquam, orci felis euismod neque, sed ornare massa mauris sed velit. Nulla pretium mi et risus. Fusce mi pede, tempor id, cursus ac, ullamcorper nec, enim. Sed tortor. Curabitur molestie. Duis velit augue, condimentum at, ultrices a, luctus ut, orci. Donec pellentesque egestas eros. Integer cursus, augue in cursus faucibus, eros pede bibendum sem, in tempus tellus justo quis ligula. Etiam eget tortor. Vestibulum rutrum, est ut placerat elementum, lectus nisl aliquam velit, tempor aliquam eros nunc nonummy metus. In eros metus, gravida a, gravida sed, lobortis id, turpis. Ut ultrices, ipsum at venenatis fringilla, sem nulla lacinia tellus, eget aliquet turpis mauris non enim. Nam turpis. Suspendisse lacinia. Curabitur ac tortor ut ipsum egestas elementum. Nunc imperdiet gravida mauris.")+"</td></tr></table></div></div>"}]}]}]},{id:"Link",requiredContent:"a[href]",label:editor.lang.image.linkTab,padding:0,elements:[{id:"txtUrl",type:"text",label:editor.lang.common.url,style:"width: 100%",default:"",setup:function(type,element){if(2==type){var href=element.data("cke-saved-href");href||(href=element.getAttribute("href")),this.setValue(href)}},commit:function(type,element){if(2==type&&(this.getValue()||this.isChanged())){var url=this.getValue();element.data("cke-saved-href",url),element.setAttribute("href",url),!this.getValue()&&editor.config.image_removeLinkByEmptyURL||(this.getDialog().addLink=!0)}}},{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:editor.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:editor.lang.common.browseServer},{id:"cmbTarget",type:"select",requiredContent:"a[target]",label:editor.lang.common.target,default:"",items:[[editor.lang.common.notSet,""],[editor.lang.common.targetNew,"_blank"],[editor.lang.common.targetTop,"_top"],[editor.lang.common.targetSelf,"_self"],[editor.lang.common.targetParent,"_parent"]],setup:function(type,element){2==type&&this.setValue(element.getAttribute("target")||"")},commit:function(type,element){2==type&&(this.getValue()||this.isChanged())&&element.setAttribute("target",this.getValue())}}]},{id:"Upload",hidden:!1,filebrowser:"uploadButton",label:editor.lang.image.upload,elements:[{type:"html",id:"uploadHtml",style:"width:95%;",html:'<div><div  id="filelist"></div><a id="pickfiles" href="javascript:;">[选择文件]</a></div>',onLoad:function(){var dialog=this.getDialog(),container=$(dialog.getContentElement("Upload","uploadHtml").getInputElement().$);uploader=create_uploader(container)}}]}]}};CKEDITOR.dialog.add("ndimageDialog",function(editor){return imageDialog(editor,"image")})}();