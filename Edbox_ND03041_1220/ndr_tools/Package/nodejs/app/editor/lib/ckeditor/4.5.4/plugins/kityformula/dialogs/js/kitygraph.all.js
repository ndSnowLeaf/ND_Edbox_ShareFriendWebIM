!function(){function define(id,deps,factory){if(_modules[id]={exports:{},value:null,factory:null},2===arguments.length&&(factory=deps),"[object Object]"===_modules.toString.call(factory))_modules[id].value=factory;else{if("function"!=typeof factory)throw new Error("define函数未定义的行为");_modules[id].factory=factory}}function require(id){var module=_modules[id],exports=null;return module?module.value?module.value:(exports=module.factory.call(null,require,module.exports,module),exports&&(module.exports=exports),module.value=module.exports,module.value):null}function use(id){return require(id)}var _modules={};define("animate/animator",["animate/timeline","graphic/eventhandler","animate/frame","core/utils","core/class","animate/easing","graphic/shape","graphic/svg","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require){function parseTime(str){var value=parseFloat(str,10);return/ms/.test(str)?value:/s/.test(str)?1e3*value:/min/.test(str)?60*value*1e3:value}var Timeline=require("animate/timeline"),easingTable=require("animate/easing"),Animator=require("core/class").createClass("Animator",{constructor:function(beginValue,finishValue,setter){if(1==arguments.length){var opt=arguments[0];this.beginValue=opt.beginValue,this.finishValue=opt.finishValue,this.setter=opt.setter}else this.beginValue=beginValue,this.finishValue=finishValue,this.setter=setter},start:function(target,duration,easing,delay,callback){4===arguments.length&&"function"==typeof delay&&(callback=delay,delay=0);var timeline=this.create(target,duration,easing,callback);return delay=parseTime(delay),delay>0?setTimeout(function(){timeline.play()},delay):timeline.play(),timeline},create:function(target,duration,easing,callback){var timeline;return duration=duration&&parseTime(duration)||Animator.DEFAULT_DURATION,easing=easing||Animator.DEFAULT_EASING,"string"==typeof easing&&(easing=easingTable[easing]),timeline=new Timeline(this,target,duration,easing),"function"==typeof callback&&timeline.on("finish",callback),timeline},reverse:function(){return new Animator(this.finishValue,this.beginValue,this.setter)}});Animator.DEFAULT_DURATION=300,Animator.DEFAULT_EASING="linear";var Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{animate:function(animator,duration,easing,delay,callback){function dequeue(){queue.shift(),queue.length&&setTimeout(queue[0].t.play.bind(queue[0].t),queue[0].d)}var queue=this._KityAnimateQueue=this._KityAnimateQueue||[],timeline=animator.create(this,duration,easing,callback);return timeline.on("finish",dequeue),queue.push({t:timeline,d:delay}),1==queue.length&&setTimeout(timeline.play.bind(timeline),delay),this},timeline:function(){return this._KityAnimateQueue[0].t},stop:function(){var queue=this._KityAnimateQueue;if(queue)for(;queue.length;)queue.shift().stop()}}),Animator}),define("animate/easing",[],function(require,exports,module){var easings={linear:function(t,b,c,d){return c*(t/d)+b},swing:function(t,b,c,d){return easings.easeOutQuad(t,b,c,d)},ease:function(t,b,c,d){return easings.easeInOutCubic(t,b,c,d)},easeInQuad:function(t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(t,b,c,d){return 0===t?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(t,b,c,d){return t==d?b+c:c*(1-Math.pow(2,-10*t/d))+b},easeInOutExpo:function(t,b,c,d){return 0===t?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(2-Math.pow(2,-10*--t))+b},easeInCirc:function(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)+b)},easeOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin(2*(t*d-s)*Math.PI/p)+c+b)},easeInOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;if(0===t)return b;if(2==(t/=d/2))return b+c;if(p||(p=.3*d*1.5),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return t<1?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)+b:a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)*.5+c+b},easeInBack:function(t,b,c,d,s){return void 0==s&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(t,b,c,d,s){return void 0==s&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(t,b,c,d,s){return void 0==s&&(s=1.70158),(t/=d/2)<1?c/2*t*t*((1+(s*=1.525))*t-s)+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},easeInBounce:function(t,b,c,d){return c-easings.easeOutBounce(d-t,0,c,d)+b},easeOutBounce:function(t,b,c,d){return(t/=d)<1/2.75?7.5625*c*t*t+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(t,b,c,d){return t<d/2?.5*easings.easeInBounce(2*t,0,c,d)+b:.5*easings.easeOutBounce(2*t-d,0,c,d)+.5*c+b}};return easings}),define("animate/frame",[],function(require,exports){function pushFrame(frame){1===pendingFrames.push(frame)&&requestAnimationFrame(executePendingFrames)}function executePendingFrames(){var frames=pendingFrames;for(pendingFrames=[];frames.length;)executeFrame(frames.pop())}function requestFrame(action){var frame=initFrame(action);return pushFrame(frame),frame}function releaseFrame(frame){var index=pendingFrames.indexOf(frame);~index&&pendingFrames.splice(index,1)}function initFrame(action){var frame={index:0,time:+new Date,elapsed:0,action:action,next:function(){pushFrame(frame)}};return frame}function executeFrame(frame){var time=+new Date,dur=time-frame.time;dur>200&&(dur=1e3/60),frame.dur=dur,frame.elapsed+=dur,frame.time=time,frame.action.call(null,frame),frame.index++}var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(fn){return setTimeout(fn,1e3/60)},pendingFrames=[];exports.requestFrame=requestFrame,exports.releaseFrame=releaseFrame}),define("animate/motionanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/geometry","core/utils","graphic/point","graphic/vector","graphic/matrix","graphic/path","graphic/svg"],function(require){var Animator=require("animate/animator"),g=require("graphic/geometry"),Path=require("graphic/path"),MotionAnimator=require("core/class").createClass("MotionAnimator",{base:Animator,constructor:function(path){var me=this;this.callBase({beginValue:0,finishValue:1,setter:function(target,value){var path=me.motionPath instanceof Path?me.motionPath.getPathData():me.motionPath,point=g.pointAtPath(path,value);target.setTranslate(point.x,point.y),target.setRotate(point.tan.getAngle())}}),this.updatePath(path)},updatePath:function(path){this.motionPath=path}});return require("core/class").extendClass(Path,{motion:function(path,duration,easing,delay,callback){return this.animate(new MotionAnimator(path),duration,easing,delay,callback)}}),MotionAnimator}),define("animate/opacityanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require){var Animator=require("animate/animator"),OpacityAnimator=require("core/class").createClass("OpacityAnimator",{base:Animator,constructor:function(opacity){this.callBase({beginValue:function(target){return target.getOpacity()},finishValue:opacity,setter:function(target,value){target.setOpacity(value)}})}}),Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{fxOpacity:function(opacity,duration,easing,delay,callback){return this.animate(new OpacityAnimator(opacity),duration,easing,delay,callback)},fadeTo:function(){return this.fxOpacity.apply(this,arguments)},fadeIn:function(){return this.fxOpacity.apply(this,[1].concat([].slice.call(arguments)))},fadeOut:function(){return this.fxOpacity.apply(this,[0].concat([].slice.call(arguments)))}}),OpacityAnimator}),define("animate/pathanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/geometry","core/utils","graphic/point","graphic/vector","graphic/matrix","graphic/path","graphic/svg"],function(require){var Animator=require("animate/animator"),g=require("graphic/geometry"),PathAnimator=require("core/class").createClass("OpacityAnimator",{base:Animator,constructor:function(path){this.callBase({beginValue:function(target){return this.beginPath=target.getPathData(),0},finishValue:1,setter:function(target,value){target.setPathData(g.pathTween(this.beginPath,path,value))}})}}),Path=require("graphic/path");return require("core/class").extendClass(Path,{fxPath:function(path,duration,easing,delay,callback){return this.animate(new PathAnimator(path),duration,easing,delay,callback)}}),PathAnimator}),define("animate/rotateanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require){var Animator=require("animate/animator"),RotateAnimator=require("core/class").createClass("RotateAnimator",{base:Animator,constructor:function(deg,ax,ay){this.callBase({beginValue:0,finishValue:deg,setter:function(target,value,timeline){var delta=timeline.getDelta();target.rotate(delta,ax,ay)}})}}),Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{fxRotate:function(deg,duration,easing,delay,callback){return this.animate(new RotateAnimator(deg),duration,easing,delay,callback)},fxRotateAnchor:function(deg,ax,ay,duration,easing,delay,callback){return this.animate(new RotateAnimator(deg,ax,ay),duration,easing,delay,callback)}}),RotateAnimator}),define("animate/scaleanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require){var Animator=require("animate/animator"),ScaleAnimator=require("core/class").createClass("ScaleAnimator",{base:Animator,constructor:function(sx,sy){this.callBase({beginValue:0,finishValue:1,setter:function(target,value,timeline){var delta=timeline.getDelta(),kx=Math.pow(sx,delta),ky=Math.pow(sy,delta);target.scale(ky,kx)}})}}),Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{fxScale:function(sx,sy,duration,easing,delay,callback){return this.animate(new ScaleAnimator(sx,sy),duration,easing,delay,callback)}}),ScaleAnimator}),define("animate/timeline",["graphic/eventhandler","core/utils","graphic/shapeevent","core/class","animate/frame"],function(require){function getPercentValue(b,f,p){return utils.paralle(b,f,function(b,f){return b+(f-b)*p})}function getDelta(v1,v2){return utils.paralle(v1,v2,function(v1,v2){return v2-v1})}function TimelineEvent(timeline,type,param){this.timeline=timeline,this.target=timeline.target,this.type=type;for(var name in param)param.hasOwnProperty(name)&&(this[name]=param[name])}var EventHandler=require("graphic/eventhandler"),frame=require("animate/frame"),utils=require("core/utils"),Timeline=require("core/class").createClass("Timeline",{mixins:[EventHandler],constructor:function(animator,target,duration,easing){this.callMixin(),this.target=target,this.time=0,this.duration=duration,this.easing=easing,this.animator=animator,this.beginValue=animator.beginValue,this.finishValue=animator.finishValue,this.setter=animator.setter,this.status="ready"},nextFrame:function(frame){"playing"==this.status&&(this.time+=frame.dur,this.setValue(this.getValue()),this.time>=this.duration&&this.timeUp(),frame.next())},getPlayTime:function(){return this.rollbacking?this.duration-this.time:this.time},getTimeProportion:function(){return this.getPlayTime()/this.duration},getValueProportion:function(){return this.easing(this.getPlayTime(),0,1,this.duration)},getValue:function(){return getPercentValue(this.beginValue,this.finishValue,this.getValueProportion())},setValue:function(value){this.lastValue=this.currentValue,this.currentValue=value,this.setter.call(this.target,this.target,value,this)},getDelta:function(){return this.lastValue=void 0===this.lastValue?this.beginValue:this.lastValue,getDelta(this.lastValue,this.currentValue)},play:function(){var lastStatus=this.status;switch(this.status="playing",lastStatus){case"ready":utils.isFunction(this.beginValue)&&(this.beginValue=this.beginValue.call(this.target,this.target)),utils.isFunction(this.finishValue)&&(this.finishValue=this.finishValue.call(this.target,this.target)),this.time=0,this.frame=frame.requestFrame(this.nextFrame.bind(this));break;case"finished":case"stoped":this.time=0,this.frame=frame.requestFrame(this.nextFrame.bind(this));break;case"paused":this.frame.next()}return this.fire("play",new TimelineEvent(this,"play",{lastStatus:lastStatus})),this},pause:function(){return this.status="paused",this.fire("pause",new TimelineEvent(this,"pause")),frame.releaseFrame(this.frame),this},stop:function(){return this.status="stoped",this.setValue(this.finishValue),this.rollbacking=!1,this.fire("stop",new TimelineEvent(this,"stop")),frame.releaseFrame(this.frame),this},timeUp:function(){this.repeatOption?(this.time=0,this.rollback?this.rollbacking?(this.decreaseRepeat(),this.rollbacking=!1):(this.rollbacking=!0,this.fire("rollback",new TimelineEvent(this,"rollback"))):this.decreaseRepeat(),this.repeatOption?this.fire("repeat",new TimelineEvent(this,"repeat")):this.finish()):this.finish()},finish:function(){this.setValue(this.finishValue),this.status="finished",this.fire("finish",new TimelineEvent(this,"finish")),frame.releaseFrame(this.frame)},decreaseRepeat:function(){!0!==this.repeatOption&&this.repeatOption--},repeat:function(repeat,rollback){return this.repeatOption=repeat,this.rollback=rollback,this}});return Timeline.requestFrame=frame.requestFrame,Timeline.releaseFrame=frame.releaseFrame,Timeline}),define("animate/translateanimator",["animate/animator","animate/timeline","animate/easing","core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require){var Animator=require("animate/animator"),TranslateAnimator=require("core/class").createClass("TranslateAnimator",{base:Animator,constructor:function(x,y){this.callBase({x:0,y:0},{x:x,y:y},function(target,value,timeline){var delta=timeline.getDelta();target.translate(delta.x,delta.y)})}}),Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{fxTranslate:function(x,y,duration,easing,delay,callback){return this.animate(new TranslateAnimator(x,y),duration,easing,delay,callback)}}),TranslateAnimator}),define("core/browser",[],function(){return function(){var browser,agent=navigator.userAgent.toLowerCase(),opera=window.opera;browser={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(agent),opera:!!opera&&opera.version,webkit:agent.indexOf(" applewebkit/")>-1,mac:agent.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode},browser.gecko="Gecko"==navigator.product&&!browser.webkit&&!browser.opera&&!browser.ie;var version=0;if(browser.ie&&(version=1*(agent.match(/(msie\s|trident.*rv:)([\w.]+)/)[2]||0),browser.ie11Compat=11==document.documentMode,browser.ie9Compat=9==document.documentMode),browser.gecko){var geckoRelease=agent.match(/rv:([\d\.]+)/);geckoRelease&&(geckoRelease=geckoRelease[1].split("."),version=1e4*geckoRelease[0]+100*(geckoRelease[1]||0)+1*(geckoRelease[2]||0))}return/chrome\/(\d+\.\d)/i.test(agent)&&(browser.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(agent)&&!/chrome/i.test(agent)&&(browser.safari=+(RegExp.$1||RegExp.$2)),browser.opera&&(version=parseFloat(opera.version())),browser.webkit&&(version=parseFloat(agent.match(/ applewebkit\/(\d+)/)[1])),browser.version=version,browser.isCompatible=!browser.mobile&&(browser.ie&&version>=6||browser.gecko&&version>=10801||browser.opera&&version>=9.5||browser.air&&version>=1||browser.webkit&&version>=522||!1),browser}()}),define("core/class",[],function(require,exports){function Class(){}function checkBaseConstructorCall(targetClass,classname){if(!/this\.callBase/.test(targetClass.toString()))throw new Error(classname+" : 类构造函数没有调用父类的构造函数！为了安全，请调用父类的构造函数")}function inherit(constructor,BaseClass,classname){var KityClass=function(__inherit__flag){__inherit__flag!=KITY_INHERIT_FLAG&&KityClass.__KityConstructor.apply(this,arguments),this.__KityClassName=KityClass.__KityClassName};KityClass.__KityConstructor=constructor,KityClass.prototype=new BaseClass(KITY_INHERIT_FLAG);for(var methodName in BaseClass.prototype)BaseClass.prototype.hasOwnProperty(methodName)&&0!==methodName.indexOf("__Kity")&&(KityClass.prototype[methodName]=BaseClass.prototype[methodName]);return KityClass.prototype.constructor=KityClass,KityClass}function mixin(NewClass,mixins){if(!1==mixins instanceof Array)return NewClass;var i,proto,method,length=mixins.length;for(NewClass.__KityMixins={constructor:[]},i=0;i<length;i++){proto=mixins[i].prototype;for(method in proto)!1!==proto.hasOwnProperty(method)&&0!==method.indexOf("__Kity")&&("constructor"===method?NewClass.__KityMixins.constructor.push(proto[method]):NewClass.prototype[method]=NewClass.__KityMixins[method]=proto[method])}return NewClass}function extend(BaseClass,extension){extension.__KityClassName&&(extension=extension.prototype);for(var methodName in extension)if(extension.hasOwnProperty(methodName)&&methodName.indexOf("__Kity")&&"constructor"!=methodName){var method=BaseClass.prototype[methodName]=extension[methodName];method.__KityMethodClass=BaseClass,method.__KityMethodName=methodName}return BaseClass}Function.prototype.bind=Function.prototype.bind||function(thisObj){var args=Array.prototype.slice.call(arguments,1);return this.apply(thisObj,args)},Class.__KityClassName="Class",Class.prototype.base=function(name){return arguments.callee.caller.__KityMethodClass.__KityBaseClass.prototype[name].apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callBase=function(){var caller=arguments.callee.caller;return caller.__KityMethodClass.__KityBaseClass.prototype[caller.__KityMethodName].apply(this,arguments)},Class.prototype.mixin=function(name){var caller=arguments.callee.caller,mixins=caller.__KityMethodClass.__KityMixins;return mixins?mixins[name].apply(this,Array.prototype.slice.call(arguments,1)):this},Class.prototype.callMixin=function(){var caller=arguments.callee.caller,methodName=caller.__KityMethodName,mixins=caller.__KityMethodClass.__KityMixins;if(!mixins)return this;var method=mixins[methodName];if("constructor"==methodName){for(var i=0,l=method.length;i<l;i++)method[i].call(this);return this}return method.apply(this,arguments)},Class.prototype.pipe=function(fn){return"function"==typeof fn&&fn.call(this,this),this},Class.prototype.getType=function(){return this.__KityClassName},Class.prototype.getClass=function(){return this.constructor};var KITY_INHERIT_FLAG="__KITY_INHERIT_FLAG_"+ +new Date;Class.prototype._accessProperty=function(){return this._propertyRawData||(this._propertyRawData={})},exports.createClass=function(classname,defines){var constructor,NewClass,BaseClass;return 1===arguments.length&&(defines=arguments[0],classname="AnonymousClass"),BaseClass=defines.base||Class,defines.hasOwnProperty("constructor")?(constructor=defines.constructor,BaseClass!=Class&&checkBaseConstructorCall(constructor,classname)):constructor=function(){this.callBase.apply(this,arguments),this.callMixin.apply(this,arguments)},NewClass=inherit(constructor,BaseClass,classname),NewClass=mixin(NewClass,defines.mixins),NewClass.__KityClassName=constructor.__KityClassName=classname,NewClass.__KityBaseClass=constructor.__KityBaseClass=BaseClass,NewClass.__KityMethodName=constructor.__KityMethodName="constructor",NewClass.__KityMethodClass=constructor.__KityMethodClass=NewClass,delete defines.mixins,delete defines.constructor,delete defines.base,NewClass=extend(NewClass,defines)},exports.extendClass=extend}),define("core/utils",[],function(){var utils={each:function(obj,iterator,context){if(null!==obj)if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++)if(!1===iterator.call(context,obj[i],i,obj))return!1}else for(var key in obj)if(obj.hasOwnProperty(key)&&!1===iterator.call(context,obj[key],key,obj))return!1},extend:function(t){for(var a=arguments,notCover=!!this.isBoolean(a[a.length-1])&&a[a.length-1],len=this.isBoolean(a[a.length-1])?a.length-1:a.length,i=1;i<len;i++){var x=a[i];for(var k in x)notCover&&t.hasOwnProperty(k)||(t[k]=x[k])}return t},deepExtend:function(t,s){for(var a=arguments,notCover=!!this.isBoolean(a[a.length-1])&&a[a.length-1],len=this.isBoolean(a[a.length-1])?a.length-1:a.length,i=1;i<len;i++){var x=a[i];for(var k in x)notCover&&t.hasOwnProperty(k)||(this.isObject(t[k])&&this.isObject(x[k])?this.deepExtend(t[k],x[k],notCover):t[k]=x[k])}return t},clone:function(obj){var cloned={};for(var m in obj)obj.hasOwnProperty(m)&&(cloned[m]=obj[m]);return cloned},copy:function(obj){return"object"!=typeof obj?obj:"function"==typeof obj?null:JSON.parse(JSON.stringify(obj))},queryPath:function(path,obj){for(var arr=path.split("."),i=0,tmp=obj,l=arr.length;i<l;){if(!(arr[i]in tmp))return;if(tmp=tmp[arr[i]],++i>=l||void 0===tmp)return tmp}},getValue:function(value,defaultValue){return void 0!==value?value:defaultValue},flatten:function(arr){var i,result=[],length=arr.length;for(i=0;i<length;i++)arr[i]instanceof Array?result=result.concat(utils.flatten(arr[i])):result.push(arr[i]);return result},paralle:function(v1,v2,op){var Class,index,name,value;if(v1 instanceof Array){for(value=[],index=0;index<v1.length;index++)value.push(utils.paralle(v1[index],v2[index],op));return value}if(v1 instanceof Object){if((Class=v1.getClass&&v1.getClass())&&Class.parse)v1=v1.valueOf(),v2=v2.valueOf(),value=utils.paralle(v1,v2,op),value=Class.parse(value);else{value={};for(name in v1)v1.hasOwnProperty(name)&&v2.hasOwnProperty(name)&&(value[name]=utils.paralle(v1[name],v2[name],op))}return value}return!1===isNaN(parseFloat(v1))?op(v1,v2):value},parallelize:function(op){return function(v1,v2){return utils.paralle(v1,v2,op)}}};return utils.each(["String","Function","Array","Number","RegExp","Object","Boolean"],function(v){utils["is"+v]=function(obj){return Object.prototype.toString.apply(obj)=="[object "+v+"]"}}),utils}),define("filter/effect/colormatrixeffect",["filter/effect/effect","graphic/svg","core/class","core/utils"],function(require,exports,module){var Effect=require("filter/effect/effect"),Utils=require("core/utils"),ColorMatrixEffect=require("core/class").createClass("ColorMatrixEffect",{base:Effect,constructor:function(type,input){this.callBase(Effect.NAME_COLOR_MATRIX),this.set("type",Utils.getValue(type,ColorMatrixEffect.TYPE_MATRIX)),this.set("in",Utils.getValue(input,Effect.INPUT_SOURCE_GRAPHIC))}});return Utils.extend(ColorMatrixEffect,{TYPE_MATRIX:"matrix",TYPE_SATURATE:"saturate",TYPE_HUE_ROTATE:"hueRotate",TYPE_LUMINANCE_TO_ALPHA:"luminanceToAlpha",MATRIX_ORIGINAL:"10000010000010000010".split("").join(" "),MATRIX_EMPTY:"00000000000000000000".split("").join(" ")}),ColorMatrixEffect}),define("filter/effect/compositeeffect",["filter/effect/effect","graphic/svg","core/class","core/utils"],function(require,exports,module){var Effect=require("filter/effect/effect"),Utils=require("core/utils"),CompositeEffect=require("core/class").createClass("CompositeEffect",{base:Effect,constructor:function(operator,input,input2){this.callBase(Effect.NAME_COMPOSITE),this.set("operator",Utils.getValue(operator,CompositeEffect.OPERATOR_OVER)),input&&this.set("in",input),input2&&this.set("in2",input2)}});return Utils.extend(CompositeEffect,{OPERATOR_OVER:"over",OPERATOR_IN:"in",OPERATOR_OUT:"out",OPERATOR_ATOP:"atop",OPERATOR_XOR:"xor",OPERATOR_ARITHMETIC:"arithmetic"}),CompositeEffect}),define("filter/effect/convolvematrixeffect",["filter/effect/effect","graphic/svg","core/class","core/utils"],function(require,exports,module){var Effect=require("filter/effect/effect"),Utils=require("core/utils"),ConvolveMatrixEffect=require("core/class").createClass("ConvolveMatrixEffect",{base:Effect,constructor:function(edgeMode,input){this.callBase(Effect.NAME_CONVOLVE_MATRIX),this.set("edgeMode",Utils.getValue(edgeMode,ConvolveMatrixEffect.MODE_DUPLICATE)),this.set("in",Utils.getValue(input,Effect.INPUT_SOURCE_GRAPHIC))}});return Utils.extend(ConvolveMatrixEffect,{MODE_DUPLICATE:"duplicate",MODE_WRAP:"wrap",MODE_NONE:"none"}),ConvolveMatrixEffect}),define("filter/effect/effect",["graphic/svg","core/class","core/utils"],function(require,exports,module){var svg=require("graphic/svg"),Effect=require("core/class").createClass("Effect",{constructor:function(type){this.node=svg.createNode(type)},getId:function(){return this.node.id},setId:function(id){return this.node.id=id,this},set:function(key,value){return this.node.setAttribute(key,value),this},get:function(key){return this.node.getAttribute(key)},getNode:function(){return this.node},toString:function(){return this.node.getAttribute("result")||""}});return require("core/utils").extend(Effect,{NAME_GAUSSIAN_BLUR:"feGaussianBlur",NAME_OFFSET:"feOffset",NAME_COMPOSITE:"feComposite",NAME_COLOR_MATRIX:"feColorMatrix",NAME_CONVOLVE_MATRIX:"feConvolveMatrix",INPUT_SOURCE_GRAPHIC:"SourceGraphic",INPUT_SOURCE_ALPHA:"SourceAlpha",INPUT_BACKGROUND_IMAGE:"BackgroundImage",INPUT_BACKGROUND_ALPHA:"BackgroundAlpha",INPUT_FILL_PAINT:"FillPaint",INPUT_STROKE_PAINT:"StrokePaint"}),Effect}),define("filter/effect/gaussianblureffect",["filter/effect/effect","graphic/svg","core/class","core/utils"],function(require,exports,module){var Effect=require("filter/effect/effect"),Utils=require("core/utils");return require("core/class").createClass("GaussianblurEffect",{base:Effect,constructor:function(stdDeviation,input){this.callBase(Effect.NAME_GAUSSIAN_BLUR),this.set("stdDeviation",Utils.getValue(stdDeviation,1)),this.set("in",Utils.getValue(input,Effect.INPUT_SOURCE_GRAPHIC))}})}),define("filter/effect/offseteffect",["filter/effect/effect","graphic/svg","core/class","core/utils"],function(require,exports,module){var Effect=require("filter/effect/effect"),Utils=require("core/utils");return require("core/class").createClass("OffsetEffect",{base:Effect,constructor:function(dx,dy,input){this.callBase(Effect.NAME_OFFSET),this.set("dx",Utils.getValue(dx,0)),this.set("dy",Utils.getValue(dy,0)),this.set("in",Utils.getValue(input,Effect.INPUT_SOURCE_GRAPHIC))}})}),define("filter/effectcontainer",["core/class","graphic/container"],function(require){return require("core/class").createClass("EffectContainer",{base:require("graphic/container"),addEffect:function(point,pos){return this.addItem.apply(this,arguments)},prependEffect:function(){return this.prependItem.apply(this,arguments)},appendEffect:function(){return this.appendItem.apply(this,arguments)},removeEffect:function(pos){return this.removeItem.apply(this,arguments)},addEffects:function(){return this.addItems.apply(this,arguments)},setEffects:function(){return this.setItems.apply(this,arguments)},getEffect:function(){return this.getItem.apply(this,arguments)},getEffects:function(){return this.getItems.apply(this,arguments)},getFirstEffect:function(){return this.getFirstItem.apply(this,arguments)},getLastEffect:function(){return this.getLastItem.apply(this,arguments)},handleAdd:function(effectItem,pos){var count=this.getEffects().length,nextEffectItem=this.getItem(pos+1);if(count===pos+1)return void this.node.appendChild(effectItem.getNode());this.node.insertBefore(effectItem.getNode(),nextEffectItem.getNode())}})}),define("filter/filter",["graphic/svg","core/class","filter/effectcontainer","graphic/container","graphic/shape","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){var svg=require("graphic/svg"),Class=require("core/class"),Filter=Class.createClass("Filter",{mixins:[require("filter/effectcontainer")],constructor:function(x,y,width,height){this.node=svg.createNode("filter"),void 0!==x&&this.set("x",x),void 0!==y&&this.set("y",y),void 0!==width&&this.set("width",width),void 0!==height&&this.set("height",height)},getId:function(){return this.id},setId:function(id){return this.node.id=id,this},set:function(key,value){return this.node.setAttribute(key,value),this},get:function(key){return this.node.getAttribute(key)},getNode:function(){return this.node}}),Shape=require("graphic/shape");return Class.extendClass(Shape,{applyFilter:function(filter){var filterId=filter.get("id");return filterId&&this.node.setAttribute("filter","url(#"+filterId+")"),this}}),Filter}),define("filter/gaussianblurfilter",["filter/effect/gaussianblureffect","filter/effect/effect","core/utils","core/class","filter/filter","graphic/svg","filter/effectcontainer","graphic/shape"],function(require,exports,module){var GaussianblurEffect=require("filter/effect/gaussianblureffect");return require("core/class").createClass("GaussianblurFilter",{base:require("filter/filter"),constructor:function(stdDeviation){this.callBase(),this.addEffect(new GaussianblurEffect(stdDeviation))}})}),define("filter/projectionfilter",["filter/effect/gaussianblureffect","filter/effect/effect","core/utils","core/class","graphic/svg","filter/effect/colormatrixeffect","graphic/color","graphic/standardcolor","filter/effect/compositeeffect","filter/effect/offseteffect","filter/filter","filter/effectcontainer","graphic/shape"],function(require,exports,module){var GaussianblurEffect=require("filter/effect/gaussianblureffect"),Effect=require("filter/effect/effect"),ColorMatrixEffect=require("filter/effect/colormatrixeffect"),Color=require("graphic/color"),Utils=require("core/utils"),CompositeEffect=require("filter/effect/compositeeffect"),OffsetEffect=require("filter/effect/offseteffect");return require("core/class").createClass("ProjectionFilter",{base:require("filter/filter"),constructor:function(stdDeviation,dx,dy){this.callBase(),this.gaussianblurEffect=new GaussianblurEffect(stdDeviation,Effect.INPUT_SOURCE_ALPHA),this.gaussianblurEffect.set("result","gaussianblur"),this.addEffect(this.gaussianblurEffect),this.offsetEffect=new OffsetEffect(dx,dy,this.gaussianblurEffect),this.offsetEffect.set("result","offsetBlur"),this.addEffect(this.offsetEffect),this.colorMatrixEffect=new ColorMatrixEffect(ColorMatrixEffect.TYPE_MATRIX,this.offsetEffect),this.colorMatrixEffect.set("values",ColorMatrixEffect.MATRIX_ORIGINAL),this.colorMatrixEffect.set("result","colorOffsetBlur"),this.addEffect(this.colorMatrixEffect),
this.compositeEffect=new CompositeEffect(CompositeEffect.OPERATOR_OVER,Effect.INPUT_SOURCE_GRAPHIC,this.colorMatrixEffect),this.addEffect(this.compositeEffect)},setColor:function(color){var matrix=null,colorValue=[];if(Utils.isString(color)&&(color=Color.parse(color)),!color)return this;matrix=ColorMatrixEffect.MATRIX_EMPTY.split(" "),colorValue.push(color.get("r")),colorValue.push(color.get("g")),colorValue.push(color.get("b"));for(var i=0,len=colorValue.length;i<len;i++)matrix[5*i+3]=colorValue[i]/255;return matrix[18]=color.get("a"),this.colorMatrixEffect.set("values",matrix.join(" ")),this},setOpacity:function(opacity){var matrix=this.colorMatrixEffect.get("values").split(" ");return matrix[18]=opacity,this.colorMatrixEffect.set("values",matrix.join(" ")),this},setOffset:function(dx,dy){this.setOffsetX(dx),this.setOffsetY(dy)},setOffsetX:function(dx){this.offsetEffect.set("dx",dx)},setOffsetY:function(dy){this.offsetEffect.set("dy",dy)},setDeviation:function(deviation){this.gaussianblurEffect.set("stdDeviation",deviation)}})}),define("graphic/bezier",["core/class","graphic/pointcontainer","graphic/container","graphic/path","core/utils","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){return require("core/class").createClass("Bezier",{mixins:[require("graphic/pointcontainer")],base:require("graphic/path"),constructor:function(bezierPoints){this.callBase(),bezierPoints=bezierPoints||[],this.changeable=!0,this.setBezierPoints(bezierPoints)},getBezierPoints:function(){return this.getPoints()},setBezierPoints:function(bezierPoints){return this.setPoints(bezierPoints)},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var drawer=null,bezierPoints=this.getBezierPoints();if(!(bezierPoints.length<2)){drawer=this.getDrawer(),drawer.clear();var vertex=bezierPoints[0].getVertex(),forward=null,backward=null;drawer.moveTo(vertex.x,vertex.y);for(var i=1,len=bezierPoints.length;i<len;i++)vertex=bezierPoints[i].getVertex(),backward=bezierPoints[i].getBackward(),forward=bezierPoints[i-1].getForward(),drawer.bezierTo(forward.x,forward.y,backward.x,backward.y,vertex.x,vertex.y);return this}}})}),define("graphic/bezierpoint",["graphic/shapepoint","core/class","graphic/point","graphic/vector","graphic/matrix"],function(require,exports,module){var ShapePoint=require("graphic/shapepoint"),Vector=require("graphic/vector"),BezierPoint=require("core/class").createClass("BezierPoint",{constructor:function(x,y,isSmooth){this.vertex=new ShapePoint(x,y),this.forward=new ShapePoint(x,y),this.backward=new ShapePoint(x,y),this.setSmooth(void 0===isSmooth||isSmooth),this.setSymReflaction(!0)},clone:function(){var newPoint=new BezierPoint,tmp=null;return tmp=this.getVertex(),newPoint.setVertex(tmp.x,tmp.y),tmp=this.getForward(),newPoint.setForward(tmp.x,tmp.y),tmp=this.getBackward(),newPoint.setBackward(tmp.x,tmp.y),newPoint.setSmooth(newPoint.isSmooth()),newPoint},setVertex:function(x,y){return this.vertex.setPoint(x,y),this.update(),this},moveTo:function(x,y){var oldForward=this.forward.getPoint(),oldBackward=this.backward.getPoint(),oldVertex=this.vertex.getPoint(),distance={left:x-oldVertex.x,top:y-oldVertex.y};this.forward.setPoint(oldForward.x+distance.left,oldForward.y+distance.top),this.backward.setPoint(oldBackward.x+distance.left,oldBackward.y+distance.top),this.vertex.setPoint(x,y),this.update()},setForward:function(x,y){return this.forward.setPoint(x,y),this.smooth&&this.updateAnother(this.forward,this.backward),this.update(),this},setBackward:function(x,y){return this.backward.setPoint(x,y),this.smooth&&this.updateAnother(this.backward,this.forward),this.update(),this},setSymReflaction:function(value){this.symReflaction=value},isSymReflaction:function(){return this.symReflaction},updateAnother:function(p,q){var v=this.getVertex(),pv=Vector.fromPoints(p.getPoint(),v),vq=Vector.fromPoints(v,q.getPoint());vq=Vector.normalize(pv,this.isSymReflaction()?pv.length():vq.length()),q.setPoint(v.x+vq.x,v.y+vq.y)},setSmooth:function(isSmooth){return this.smooth=!!isSmooth,this},getVertex:function(){return this.vertex.getPoint()},getForward:function(){return this.forward.getPoint()},getBackward:function(){return this.backward.getPoint()},isSmooth:function(){return this.smooth},update:function(){if(!this.container)return this;this.container.update&&this.container.update(this)}});return BezierPoint}),define("graphic/box",["core/class"],function(require,exports,module){var Box=require("core/class").createClass("Box",{constructor:function(x,y,width,height){var box=arguments[0];box&&"object"==typeof box&&(x=box.x,y=box.y,width=box.width,height=box.height),width<0&&(x-=width=-width),height<0&&(y-=height=-height),this.x=x,this.y=y,this.width=width,this.height=height},getLeft:function(){return this.x},getRight:function(){return this.x+this.width},getTop:function(){return this.y},getBottom:function(){return this.y+this.height},getRangeX:function(){return[this.x,this.x+this.width]},getRangeY:function(){return[this.y,this.y+this.height]},merge:function(another){var xMin=Math.min(this.x,another.x),xMax=Math.max(this.x+this.width,another.x+another.width),yMin=Math.min(this.y,another.y),yMax=Math.max(this.y+this.height,another.y+another.height);return new Box(xMin,yMin,xMax-xMin,yMax-yMin)},valueOf:function(){return[this.x,this.y,this.width,this.height]},toString:function(){return this.valueOf().join(" ")}});return Box}),define("graphic/circle",["core/class","graphic/ellipse","core/utils","graphic/point","graphic/path"],function(require,exports,module){return require("core/class").createClass("Circle",{base:require("graphic/ellipse"),constructor:function(radius,cx,cy){this.callBase(radius,radius,cx,cy)},getRadius:function(){return this.getRadiusX()},setRadius:function(radius){return this.callBase(radius,radius)}})}),define("graphic/clip",["core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box","graphic/shapecontainer","graphic/container"],function(require,exports,module){var Class=require("core/class"),Shape=require("graphic/shape"),Clip=Class.createClass("Clip",{base:Shape,mixins:[require("graphic/shapecontainer")],constructor:function(){this.callBase("clipPath")},clip:function(shape){return shape.getNode().setAttribute("clip-path","url(#"+this.getId()+")"),this}});return Class.extendClass(Shape,{clipWith:function(clip){return clip.clip(this),this}}),Clip}),define("graphic/color",["core/utils","graphic/standardcolor","core/class"],function(require,exports,module){var Utils=require("core/utils"),StandardColor=require("graphic/standardcolor"),ColorUtils={},Color=require("core/class").createClass("Color",{constructor:function(){var colorValue=null;"string"==typeof arguments[0]?null===(colorValue=ColorUtils.parseToValue(arguments[0]))&&(colorValue={r:0,g:0,b:0,h:0,s:0,l:0,a:1}):(colorValue={r:0|arguments[0],g:0|arguments[1],b:0|arguments[2],a:parseFloat(arguments[3])||1},colorValue=ColorUtils.overflowFormat(colorValue),colorValue=Utils.extend(colorValue,ColorUtils.rgbValueToHslValue(colorValue))),this._color=colorValue},set:function(name,value){if(!Color._MAX_VALUE[name])throw new Error("Color set(): Illegal parameter");return"a"!==name&&(value=Math.floor(value)),"h"==name&&(value=(value+360)%360),this._color[name]=Math.max(Color._MIN_VALUE[name],Math.min(Color._MAX_VALUE[name],value)),-1!=="rgb".indexOf(name)?this._color=Utils.extend(this._color,ColorUtils.rgbValueToHslValue(this._color)):-1!=="hsl".indexOf(name)&&(this._color=Utils.extend(this._color,ColorUtils.hslValueToRGBValue(this._color))),this},inc:function(name,value){return value=this.get(name)+value,"h"==name?value=(value+360)%360:(value=Math.min(Color._MAX_VALUE[name],value),value=Math.max(Color._MIN_VALUE[name],value)),this.clone().set(name,value)},dec:function(name,value){return this.inc(name,-value)},clone:function(){return new Color(this.toRGBA())},get:function(name){return Color._MAX_VALUE[name]?this._color[name]:null},getValues:function(){return Utils.clone(this._color)},valueOf:function(){return this.getValues()},toRGB:function(){return ColorUtils.toString(this._color,"rgb")},toRGBA:function(){return ColorUtils.toString(this._color,"rgba")},toHEX:function(){return ColorUtils.toString(this._color,"hex")},toHSL:function(){return ColorUtils.toString(this._color,"hsl")},toHSLA:function(){return ColorUtils.toString(this._color,"hsla")},toString:function(){return 1===this._color.a?this.toRGB():this.toRGBA()}});return Utils.extend(Color,{_MAX_VALUE:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},_MIN_VALUE:{r:0,g:0,b:0,h:0,s:0,l:0,a:0},R:"r",G:"g",B:"b",H:"h",S:"s",L:"l",A:"a",parse:function(valStr){var rgbValue;return Utils.isString(valStr)&&(rgbValue=ColorUtils.parseToValue(valStr)),Utils.isObject(valStr)&&"r"in valStr&&(rgbValue=valStr),null===rgbValue?new Color:new Color(rgbValue.r,rgbValue.g,rgbValue.b,rgbValue.a)},createHSL:function(h,s,l){return Color.createHSLA(h,s,l,1)},createHSLA:function(h,s,l,a){var colorValue=null;return s+="%",l+="%",colorValue=["hsla("+h,s,l,a+")"],Color.parse(colorValue.join(", "))},createRGB:function(r,g,b){return Color.createRGBA(r,g,b,1)},createRGBA:function(r,g,b,a){return new Color(r,g,b,a)}}),Utils.extend(ColorUtils,{parseToValue:function(valStr){var rgbaValue={};if(valStr=StandardColor.EXTEND_STANDARD[valStr]||StandardColor.COLOR_STANDARD[valStr]||valStr,/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(valStr))rgbaValue=ColorUtils.hexToValue(valStr);else if(/^(rgba?)/i.test(valStr))rgbaValue=ColorUtils.rgbaToValue(valStr);else{if(!/^(hsla?)/i.test(valStr))return null;rgbaValue=ColorUtils.hslaToValue(valStr)}return ColorUtils.overflowFormat(rgbaValue)},hexToValue:function(hexStr){var result={},keys=["r","g","b"];return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(hexStr)?(hexStr=RegExp.$1.split(""),Utils.each(keys,function(key,index){3===hexStr.length?result[key]=ColorUtils.toNumber(hexStr[index]+hexStr[index]):result[key]=ColorUtils.toNumber(hexStr[2*index]+hexStr[2*index+1])}),result=Utils.extend(result,ColorUtils.rgbValueToHslValue(result)),result.a=1,result):null},rgbaToValue:function(rgbaStr){var result={},hasAlpha=!1,keys=["r","g","b"];return/^(rgba?)/i.test(rgbaStr)?(hasAlpha=4===RegExp.$1.length,rgbaStr=rgbaStr.replace(/^rgba?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),Utils.each(keys,function(key,index){result[key]=0|rgbaStr[index]}),result=Utils.extend(result,ColorUtils.rgbValueToHslValue(result)),result.a=hasAlpha?parseFloat(rgbaStr[3]):1,result):null},hslaToValue:function(hslaStr){var result={},hasAlpha=!1;return/^(hsla?)/i.test(hslaStr)?(hasAlpha=4===RegExp.$1.length,hslaStr=hslaStr.replace(/^hsla?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),result.h=0|hslaStr[0],result.s=0|hslaStr[1],result.l=0|hslaStr[2],result=Utils.extend(result,ColorUtils.hslValueToRGBValue(result)),result=ColorUtils.hslValueToRGBValue(result),result.a=hasAlpha?parseFloat(hslaStr[3]):1,result):null},hslValueToRGBValue:function(hslValue){function trans(v1,v2,vH){return vH<0?vH+=1:vH>1&&(vH-=1),6*vH<1?v1+6*(v2-v1)*vH:2*vH<1?v2:3*vH<2?v1+(v2-v1)*(2/3-vH)*6:v1}var q=null,p=null,result={};return hslValue=Utils.extend({},hslValue),hslValue.h=hslValue.h/360,hslValue.s=hslValue.s/100,hslValue.l=hslValue.l/100,0===hslValue.s?result.r=result.g=result.b=hslValue.l:(q=hslValue.l<.5?hslValue.l*(1+hslValue.s):hslValue.l+hslValue.s-hslValue.l*hslValue.s,p=2*hslValue.l-q,result.r=trans(p,q,hslValue.h+1/3),result.g=trans(p,q,hslValue.h),result.b=trans(p,q,hslValue.h-1/3)),result.r=Math.min(Math.round(255*result.r),255),result.g=Math.min(Math.round(255*result.g),255),result.b=Math.min(Math.round(255*result.b),255),result},rgbValueToHslValue:function(rgbValue){var max=null,min=null,result={};return rgbValue=Utils.extend({},rgbValue),rgbValue.r=rgbValue.r/255,rgbValue.g=rgbValue.g/255,rgbValue.b=rgbValue.b/255,max=Math.max(rgbValue.r,rgbValue.g,rgbValue.b),min=Math.min(rgbValue.r,rgbValue.g,rgbValue.b),max===min?result.h=0:max===rgbValue.r?rgbValue.g>=rgbValue.b?result.h=60*(rgbValue.g-rgbValue.b)/(max-min):result.h=60*(rgbValue.g-rgbValue.b)/(max-min)+360:max===rgbValue.g?result.h=60*(rgbValue.b-rgbValue.r)/(max-min)+120:max===rgbValue.b&&(result.h=60*(rgbValue.r-rgbValue.g)/(max-min)+240),result.l=(max+min)/2,0===result.l||max===min?result.s=0:result.l>0&&result.l<=.5?result.s=(max-min)/(max+min):result.s=(max-min)/(2-max-min),result.h=Math.round(result.h),result.s=Math.round(100*result.s),result.l=Math.round(100*result.l),result},toString:function(colorValue,type){var vals=[];return colorValue=Utils.extend({},colorValue),-1!==type.indexOf("hsl")&&(colorValue.s+="%",colorValue.l+="%"),"hex"!==type?(Utils.each(type.split(""),function(key){vals.push(colorValue[key])}),(type+"("+vals.join(", ")+")").toLowerCase()):(vals.push(ColorUtils.toHexValue(+colorValue.r)),vals.push(ColorUtils.toHexValue(+colorValue.g)),vals.push(ColorUtils.toHexValue(+colorValue.b)),("#"+vals.join("")).toLowerCase())},toNumber:function(value){return 0|Number("0x"+value)},toHexValue:function(value){var result=value.toString(16);return 1===result.length?"0"+result:result},overflowFormat:function(value){var tmpValue=Utils.extend({},value);return Utils.each("rgba".split(""),function(key){tmpValue.hasOwnProperty(key)&&(tmpValue[key]=Math.min(Color._MAX_VALUE[key],tmpValue[key]),tmpValue[key]=Math.max(Color._MIN_VALUE[key],tmpValue[key]))}),tmpValue}}),Color}),define("graphic/container",["core/class"],function(require,exports,module){function itemRemove(){return this.container.removeItem(this),this}return require("core/class").createClass("Container",{getItems:function(){return this.items||(this.items=[])},getItem:function(index){return this.getItems()[index]},getFirstItem:function(){return this.getItem(0)},getLastItem:function(){return this.getItem(this.getItems().length-1)},indexOf:function(item){return this.getItems().indexOf(item)},eachItem:function(fn){var i,items=this.getItems(),length=items.length;for(i=0;i<length;i++)fn.call(this,i,items[i]);return this},addItem:function(item,pos,noEvent){var items=this.getItems(),length=items.length;return~items.indexOf(item)?this:(pos>=0&&pos<length||(pos=length),items.splice(pos,0,item),"object"==typeof item&&(item.container=this,item.remove=itemRemove),this.handleAdd(item,pos),noEvent||this.onContainerChanged("add",[item]),this)},addItems:function(items){for(var i=0,l=items.length;i<l;i++)this.addItem(items[i],-1,!0);return this.onContainerChanged("add",items),this},setItems:function(items){return this.clear().addItems(items)},appendItem:function(item){return this.addItem(item)},prependItem:function(item){return this.addItem(item,0)},removeItem:function(pos,noEvent){if("number"!=typeof pos)return this.removeItem(this.indexOf(pos));var items=this.getItems(),item=(items.length,items[pos]);return void 0===item?this:(items.splice(pos,1),item.container&&delete item.container,item.remove&&delete item.remove,this.handleRemove(item,pos),noEvent||this.onContainerChanged("remove",[item]),this)},clear:function(){for(var item,removed=[];item=this.getFirstItem();)removed.push(item),this.removeItem(0,!0);return this.onContainerChanged("remove",removed),this},onContainerChanged:function(type,items){},handleAdd:function(item,index){},handleRemove:function(item,index){}})}),define("graphic/curve",["core/utils","core/class","graphic/path","graphic/shape","graphic/svg","graphic/geometry","graphic/pointcontainer","graphic/container"],function(require,exports,module){var Utils=require("core/utils"),CurveUtil={getCurvePanLines:function(points,smoothFactor){var centerPoints=CurveUtil.getCenterPoints(points),panLines=CurveUtil.getPanLine(points.length,centerPoints);return CurveUtil.getMovedPanLines(points,panLines,smoothFactor)},getCenterPoints:function(points){for(var centerPoints={},key=null,i=0,j=0,len=points.length;i<len;i++)j=i===len-1?0:i+1,key=i+","+j,centerPoints[key]={x:(points[i].x+points[j].y)/2,y:(points[i].x+points[j].y)/2};return centerPoints},getPanLine:function(length,points){for(var j,result={},pointIndex=null,i=0;i<length;i++){var point1=null,point2=null;j=(i+1)%length,pointIndex=j,point1=points[i+","+j],i=j,j=(i+1)%length,point2=points[i+","+j],result[pointIndex]={points:[{x:point1.x,y:point1.y},{x:point2.x,y:point2.y}],center:{x:(point1.x+point2.x)/2,y:(point1.y+point2.y)/2}},i=(pointIndex+length-1)%length}return result},getMovedPanLines:function(points,panLines,smoothFactor){var result={};return Utils.each(points,function(point,index){var currentPanLine=panLines[index],center=currentPanLine.center,distance={x:center.x-point.x,y:center.y-point.y},currentResult=result[index]={points:[],center:{x:point.x,y:point.y}};Utils.each(currentPanLine.points,function(controlPoint,index){var moved={x:controlPoint.x-distance.x,y:controlPoint.y-distance.y},vertex=currentResult.center,dx=moved.x-vertex.x,dy=moved.y-vertex.y;moved.x=vertex.x+smoothFactor*dx,moved.y=vertex.y+smoothFactor*dy,currentResult.points.push(moved)})}),result}};return require("core/class").createClass("Curve",{base:require("graphic/path"),mixins:[require("graphic/pointcontainer")],constructor:function(points,isColse){this.callBase(),this.setPoints(points||[]),this.closeState=!!isColse,this.changeable=!0,this.smoothFactor=1,this.update()},onContainerChanged:function(){this.changeable&&this.update()},setSmoothFactor:function(factor){return this.smoothFactor=factor<0?0:factor,this.update(),this},getSmoothFactor:function(){return this.smoothFactor},update:function(){var points=this.getPoints(),withControlPoints=null,drawer=this.getDrawer(),curPoint=null,curControlPoint=null,prevControlPoint=null;if(drawer.clear(),0===points.length)return this;if(drawer.moveTo(points[0]),1===points.length)return this;if(2===points.length)return drawer.lineTo(points[1]),this;withControlPoints=CurveUtil.getCurvePanLines(points,this.getSmoothFactor());for(var i=1,len=points.length;i<len;i++)curPoint=withControlPoints[i].center,curControlPoint=this.closeState||i!=len-1?withControlPoints[i].points[0]:withControlPoints[i].center,prevControlPoint=this.closeState||1!=i?withControlPoints[i-1].points[1]:withControlPoints[i-1].center,drawer.bezierTo(prevControlPoint.x,prevControlPoint.y,curControlPoint.x,curControlPoint.y,curPoint.x,curPoint.y);return this.closeState&&(curPoint=withControlPoints[0].center,curControlPoint=withControlPoints[0].points[0],prevControlPoint=withControlPoints[points.length-1].points[1],drawer.bezierTo(prevControlPoint.x,prevControlPoint.y,curControlPoint.x,curControlPoint.y,curPoint.x,curPoint.y)),this},close:function(){return this.closeState=!0,this.update()},open:function(){return this.closeState=!1,this.update()},isClose:function(){return!!this.closeState}})}),define("graphic/data",["core/class"],function(require,exports,module){return require("core/class").createClass("Data",{constructor:function(){this._data={}},setData:function(name,value){return this._data[name]=value,this},getData:function(name){return this._data[name]},removeData:function(name){return delete this._data[name],this}})}),define("graphic/defbrush",["core/class","graphic/resource","graphic/svg"],function(require,exports,module){return require("core/class").createClass("GradientBrush",{base:require("graphic/resource"),constructor:function(nodeType){this.callBase(nodeType)}})}),define("graphic/ellipse",["core/utils","graphic/point","core/class","graphic/path","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){var Point=(require("core/utils"),require("graphic/point"));return require("core/class").createClass("Ellipse",{base:require("graphic/path"),constructor:function(rx,ry,cx,cy){this.callBase(),this.rx=rx||0,this.ry=ry||0,this.cx=cx||0,this.cy=cy||0,this.update()},update:function(){var rx=this.rx,ry=this.ry,x1=this.cx+rx,x2=this.cx-rx,y=this.cy,drawer=this.getDrawer();return drawer.clear(),drawer.moveTo(x1,y),drawer.arcTo(rx,ry,0,1,1,x2,y),drawer.arcTo(rx,ry,0,1,1,x1,y),this},getRadius:function(){return{x:this.rx,y:this.ry}},getRadiusX:function(){return this.rx},getRadiusY:function(){return this.ry},getCenter:function(){return new Point(this.cx,this.cy)},getCenterX:function(){return this.cx},getCenterY:function(){return this.cy},setRadius:function(rx,ry){return this.rx=rx,this.ry=ry,this.update()},setRadiusX:function(rx){return this.rx=rx,this.update()},setRadiusY:function(ry){return this.ry=ry,this.update()},setCenter:function(cx,cy){if(1==arguments.length){var p=Point.parse(arguments[0]);cx=p.x,cy=p.y}return this.cx=cx,this.cy=cy,this.update()},setCenterX:function(cx){return this.cx=cx,this.update()},setCenterY:function(cy){return this.cy=cy,this.update()}})}),define("graphic/eventhandler",["core/utils","graphic/shapeevent","graphic/matrix","graphic/point","core/class"],function(require,exports,module){function _addEvent(type,handler,isOnce){return isOnce=!!isOnce,Utils.isString(type)&&(type=type.match(/\S+/g)),Utils.each(type,function(currentType){listen.call(this,this.node,currentType,handler,isOnce)},this),this}function _removeEvent(type,handler){var userHandlerList=null,eventId=this._EVNET_UID,isRemoveAll=void 0===handler;try{userHandlerList=USER_HANDLER_CACHE[eventId][type]}catch(e){return}return isRemoveAll||(isRemoveAll=!0,Utils.each(userHandlerList,function(fn,index){fn===handler?delete userHandlerList[index]:isRemoveAll=!1})),isRemoveAll&&(deleteDomEvent(this.node,type,INNER_HANDLER_CACHE[eventId][type]),delete USER_HANDLER_CACHE[eventId][type],delete INNER_HANDLER_CACHE[eventId][type]),this}function listen(node,type,handler,isOnce){var eid=this._EVNET_UID,targetObject=this;INNER_HANDLER_CACHE[eid]||(INNER_HANDLER_CACHE[eid]={}),INNER_HANDLER_CACHE[eid][type]||(INNER_HANDLER_CACHE[eid][type]=function(e){e=new ShapeEvent(e||window.event),Utils.each(USER_HANDLER_CACHE[eid][type],function(fn){var result;return fn&&(result=fn.call(targetObject,e),isOnce&&targetObject.off(type,fn)),result},targetObject)}),USER_HANDLER_CACHE[eid]||(USER_HANDLER_CACHE[eid]={}),USER_HANDLER_CACHE[eid][type]?USER_HANDLER_CACHE[eid][type].push(handler):(USER_HANDLER_CACHE[eid][type]=[handler],node&&bindDomEvent(node,type,INNER_HANDLER_CACHE[eid][type]))}function bindDomEvent(node,type,handler){node.addEventListener?node.addEventListener(type,handler,!1):node.attachEvent("on"+type,handler)}function deleteDomEvent(node,type,handler){node.removeEventListener?node.removeEventListener(type,handler,!1):node.detachEvent(type,handler)}function triggerDomEvent(node,type,params){var event=new CustomEvent(type,{bubbles:!0,cancelable:!0});event._kityParam=params,node.dispatchEvent(event)}function sendMessage(messageObj,type,msg){var event=null,handler=null;try{if(!(handler=INNER_HANDLER_CACHE[messageObj._EVNET_UID][type]))return}catch(exception){return}event=Utils.extend({type:type,target:messageObj},msg||{}),handler.call(messageObj,event)}!function(){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:void 0};var evt=document.createEvent("CustomEvent");return evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),evt}CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}();var Utils=require("core/utils"),ShapeEvent=require("graphic/shapeevent"),INNER_HANDLER_CACHE={},USER_HANDLER_CACHE={},guid=0;return require("core/class").createClass("EventHandler",{constructor:function(){this._EVNET_UID=++guid},addEventListener:function(type,handler){return _addEvent.call(this,type,handler,!1)},addOnceEventListener:function(type,handler){return _addEvent.call(this,type,handler,!0)},removeEventListener:function(type,handler){return _removeEvent.call(this,type,handler)},on:function(type,handler){return this.addEventListener.apply(this,arguments)},once:function(type,handler){return this.addOnceEventListener.apply(this,arguments)},off:function(){return this.removeEventListener.apply(this,arguments)},fire:function(type,params){return this.trigger.apply(this,arguments)},trigger:function(type,params){return this.node?triggerDomEvent(this.node,type,params):sendMessage(this,type,params),this}})}),define("graphic/geometry",["core/utils","graphic/point","core/class","graphic/vector","graphic/matrix","graphic/box"],function(require){function pathClone(path){var result,i,j,segment,segmentCopy;for(result=[],i=0;i<path.length;i++)for(segment=path[i],result.push(segmentCopy=[]),j=0;j<segment.length;j++)segmentCopy.push(segment[j]);return path.isUniform&&(result.isUniform=!0),path.isAbsolute&&(result.isAbsolute=!0),path.isCurve&&(result.isCurve=!0),result}function cacher(f,scope,postprocessor){function repush(array,item){for(var i=0,ii=array.length;i<ii;i++)if(array[i]===item)return array.push(array.splice(i,1)[0])}function newf(){var arg=Array.prototype.slice.call(arguments,0),args=arg.join("␀"),cache=newf.cache=newf.cache||{},count=newf.count=newf.count||[];return cache.hasOwnProperty(args)?(repush(count,args),postprocessor?postprocessor(cache[args]):cache[args]):(count.length>=1e3&&delete cache[count.shift()],count.push(args),cache[args]=f.apply(scope,arg),postprocessor?postprocessor(cache[args]):cache[args])}return newf}function a2c(x1,y1,rx,ry,angle,laf,sf,x2,y2,recursive){var xy,h,x,y,rx2,ry2,k,cx,cy,f1,f2,df,f2old,x2old,y2old,c1,s1,c2,s2,t,hx,hy,m1,m2,m3,m4,newres,i,ii,math=Math,PI=math.PI,abs=Math.abs,_120=120*PI/180,rad=PI/180*(+angle||0),res=[],rotate=function(x,y,rad){return{x:x*math.cos(rad)-y*math.sin(rad),y:x*math.sin(rad)+y*math.cos(rad)}};if(recursive?(f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3]):(xy=rotate(x1,y1,-rad),x1=xy.x,y1=xy.y,xy=rotate(x2,y2,-rad),x2=xy.x,y2=xy.y,math.cos(PI/180*angle),math.sin(PI/180*angle),x=(x1-x2)/2,y=(y1-y2)/2,h=x*x/(rx*rx)+y*y/(ry*ry),h>1&&(h=math.sqrt(h),rx*=h,ry*=h),rx2=rx*rx,ry2=ry*ry,k=(laf==sf?-1:1)*math.sqrt(abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x))),cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=math.asin(((y1-cy)/ry).toFixed(9)),f2=math.asin(((y2-cy)/ry).toFixed(9)),f1=x1<cx?PI-f1:f1,f2=x2<cx?PI-f2:f2,f1<0&&(f1=2*PI+f1),f2<0&&(f2=2*PI+f2),sf&&f1>f2&&(f1-=2*PI),!sf&&f2>f1&&(f2-=2*PI)),df=f2-f1,abs(df)>_120&&(f2old=f2,x2old=x2,y2old=y2,f2=f1+_120*(sf&&f2>f1?1:-1),x2=cx+rx*math.cos(f2),y2=cy+ry*math.sin(f2),res=a2c(x2,y2,rx,ry,angle,0,sf,x2old,y2old,[f2,f2old,cx,cy])),df=f2-f1,c1=math.cos(f1),s1=math.sin(f1),c2=math.cos(f2),s2=math.sin(f2),t=math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2],m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);for(res=[m2,m3,m4].concat(res).join().split(","),newres=[],i=0,ii=res.length;i<ii;i++)newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x;return newres}function q2c(x1,y1,ax,ay,x2,y2){return[1/3*x1+2/3*ax,1/3*y1+2/3*ay,1/3*x2+2/3*ax,1/3*y2+2/3*ay,x2,y2]}function cutBezier(bezierArray,t){var _=function(t){return function(p,q){return p+t*(q-p)}}(t||.5),ba=bezierArray,ax=ba[0],ay=ba[1],bx=ba[2],by=ba[3],cx=ba[4],cy=ba[5],dx=ba[6],dy=ba[7],ex=_(ax,bx),ey=_(ay,by),fx=_(bx,cx),fy=_(by,cy),gx=_(cx,dx),gy=_(cy,dy),hx=_(ex,fx),hy=_(ey,fy),jx=_(fx,gx),jy=_(fy,gy),kx=_(hx,jx),ky=_(hy,jy);return[[ax,ay,ex,ey,hx,hy,kx,ky],[kx,ky,jx,jy,gx,gy,dx,dy]]}var utils=require("core/utils"),Point=require("graphic/point"),Vector=require("graphic/vector"),Matrix=require("graphic/matrix"),g={},paramCounts={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};g.pathToString=function(pathSegment){return pathSegment=pathSegment||this,"string"==typeof pathSegment?pathSegment:pathSegment instanceof Array?(pathSegment=utils.flatten(pathSegment),pathSegment.join(",").replace(/,?([achlmqrstvxz]),?/gi,"$1")):void 0},g.parsePathString=cacher(function(pathString){var data=[];return pathString.replace(/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?\s*)+)/gi,function(a,b,c){var params=[],name=b.toLowerCase();if(c.replace(/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/gi,function(a,b){b&&params.push(+b)}),"m"==name&&params.length>2&&(data.push([b].concat(params.splice(0,2))),name="l",b="m"==b?"l":"L"),"r"==name)data.push([b].concat(params));else for(;params.length>=paramCounts[name]&&(data.push([b].concat(params.splice(0,paramCounts[name]))),paramCounts[name]););}),data.isUniform=!0,data.toString=g.pathToString,data}),g.pathToAbsolute=cacher(function(path){var r,pa,i,j,k,ii,jj,kk,pathArray=path.isUniform?path:g.parsePathString(g.pathToString(path)),res=[],x=0,y=0,mx=0,my=0,start=0;for("M"==pathArray[0][0]&&(x=+pathArray[0][1],y=+pathArray[0][2],mx=x,my=y,start++,res[0]=["M",x,y]),i=start,ii=pathArray.length;i<ii;i++){if(res.push(r=[]),pa=pathArray[i],pa[0]!=pa[0].toUpperCase())switch(r[0]=pa[0].toUpperCase(),r[0]){case"A":r[1]=pa[1],r[2]=pa[2],r[3]=pa[3],r[4]=pa[4],r[5]=pa[5],r[6]=+(pa[6]+x),r[7]=+(pa[7]+y);break;case"V":r[1]=+pa[1]+y;break;case"H":r[1]=+pa[1]+x;break;case"M":mx=+pa[1]+x,my=+pa[2]+y;break;default:for(j=1,jj=pa.length;j<jj;j++)r[j]=+pa[j]+(j%2?x:y)}else for(k=0,kk=pa.length;k<kk;k++)r[k]=pa[k];switch(r[0]){case"Z":x=mx,y=my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":mx=r[r.length-2],my=r[r.length-1];break;default:x=r[r.length-2],y=r[r.length-1]}}return res.isUniform=!0,res.isAbsolute=!0,res.toString=g.pathToString,res}),g.pathToCurve=cacher(function(path){var i,command,param,initPoint,currentPoint,endPoint,shouldClose,lastControlPoint,aussumedControlPoint,controlPoint1,controlPoint2,res=[];for(path.isAbsolute||(path=g.pathToAbsolute(path)),i=0;i<path.length;i++)if(command=path[i][0],param=path[i].slice(1),"M"!=command){switch("Z"==command&&(shouldClose=!0,command="L",param=initPoint),endPoint=param.slice(param.length-2),"H"==command&&(endPoint=[param[0],currentPoint[1]],command="L"),"V"==command&&(endPoint=[currentPoint[0],param[0]],command="L"),"S"!=command&&"T"!=command||(aussumedControlPoint=[currentPoint[0]+(currentPoint[0]-lastControlPoint[0]),currentPoint[1]+(currentPoint[1]-lastControlPoint[1])]),command){case"L":controlPoint1=currentPoint,controlPoint2=endPoint;break;case"C":controlPoint1=param.slice(0,2),controlPoint2=param.slice(2,4);break;case"S":controlPoint1=aussumedControlPoint.slice(),controlPoint2=param.slice(0,2);break;case"Q":lastControlPoint=param.slice(0,2),param=q2c.apply(null,currentPoint.concat(param)),controlPoint1=param.slice(0,2),controlPoint2=param.slice(2,4);break;case"T":param=q2c.apply(null,currentPoint.concat(aussumedControlPoint).concat(param)),controlPoint1=param.slice(0,2),controlPoint2=param.slice(2,4);break;case"A":param=a2c.apply(null,currentPoint.concat(param)),controlPoint1=param.slice(0,2),controlPoint2=param.slice(2,4)}res.push(["C"].concat(controlPoint1).concat(controlPoint2).concat(endPoint)),currentPoint=endPoint,"Q"!=command&&(lastControlPoint=controlPoint2),shouldClose&&(res.push(["Z"]),shouldClose=!1)}else initPoint=lastControlPoint=currentPoint=param,res.push(path[i]);return res.isUniform=!0,res.isAbsolute=!0,res.isCurve=!0,res.toString=g.pathToString,res}),g.cutBezier=cacher(cutBezier),g.subBezier=function(bezierArray,t,t0){var b2t=cutBezier(bezierArray,t)[0];return t0?cutBezier(b2t,t0/t)[1]:b2t},g.pointAtBezier=function(bezierArray,t){var b2t=cutBezier(bezierArray,t)[0],p=Point.parse(b2t.slice(6)),c=Point.parse(b2t.slice(4,2)),v=Vector.fromPoints(c,p);return p.tan=0===t?g.pointAtBezier(bezierArray,.01).tan:v.normalize(),p},g.bezierLength=cacher(function bezierLength(bezierArray,tolerate){function len(p,q){var dx=p[0]-q[0],dy=p[1]-q[1];return Math.sqrt(dx*dx+dy*dy)}tolerate=Math.max(tolerate||.001,1e-9);var cutted,p,q,m,cuttedLength;return cutted=cutBezier(bezierArray),p=bezierArray.slice(0,2),q=bezierArray.slice(6),m=cutted[1].slice(0,2),cuttedLength=len(p,m)+len(m,q),cuttedLength-len(p,q)<tolerate?cuttedLength:bezierLength(cutted[0],tolerate/2)+bezierLength(cutted[1],tolerate/3)});var getBezierPathSegmentRanges=cacher(function(pathSegment){var i,ii,segment,position,bezierLength,segmentRanges,totalLength;for(segmentRanges=[],totalLength=0,i=0,
ii=pathSegment.length;i<ii;i++)segment=pathSegment[i],"M"!=segment[0]?"Z"!=segment[0]?(bezierLength=g.bezierLength(position.concat(segment.slice(1))),segmentRanges.push([totalLength,totalLength+bezierLength]),totalLength+=bezierLength,position=segment.slice(4)):segmentRanges.push(null):(position=segment.slice(1),segmentRanges.push(null));return segmentRanges.totalLength=totalLength,segmentRanges});g.subPath=function(path,t1,t0){var dt;if(t0=t0||0,dt=t1-t0,dt-=0|dt,t0-=0|t0,(t1=t0+dt)>1)return g.subPath(path,1,t0).concat(g.subPath(path,t1-1));path.isCurve||(path=g.pathToCurve(path));var i,ii,a,b,d,position,bezier,subBezier,stared,segmentRanges=getBezierPathSegmentRanges(path),totalLength=segmentRanges.totalLength,t1Length=totalLength*t1,t0Length=totalLength*(t0||0),subPath=[];for(i=0,ii=path.length;i<ii;i++)if("M"!=path[i][0]){if("Z"!=path[i][0])if(a=segmentRanges[i][0],b=segmentRanges[i][1],d=b-a,bezier=position.concat(path[i].slice(1)),t0Length>b)position=bezier.slice(bezier.length-2);else{if(t0Length>=a)subBezier=g.subBezier(bezier,Math.min((t1Length-a)/d,1),(t0Length-a)/d),stared=!0,position=subBezier.slice(0,2),subPath.push(["M"].concat(subBezier.slice(0,2))),subPath.push(["C"].concat(subBezier.slice(2)));else if(t1Length>=b)subPath.push(path[i].slice());else{if(!(t1Length>=a))break;subBezier=g.subBezier(bezier,(t1Length-a)/d),subPath.push(["C"].concat(subBezier.slice(2))),stared=!1}position=bezier.slice(bezier.length-2)}}else position=path[i].slice(1),stared&&subPath.push(path[i].slice());return subPath.isAbsolute=!0,subPath.isCurve=!0,subPath.isUniform=!0,subPath.toString=g.pathToString,subPath},g.pointAtPath=function(path,t){path.isCurve||(path=g.pathToCurve(path));var subPath=g.subPath(path,t),lastCurve="Z"==subPath[subPath.length-1][0]?subPath[subPath.length-2]:subPath[subPath.length-1];lastCurve=lastCurve.slice(1);var p=Point.parse(lastCurve.slice(4)),c=Point.parse(lastCurve.slice(2,4));return p.tan=Vector.fromPoints(c,p).normalize(),p},g.pathLength=cacher(function(path){return path.isCurve||(path=g.pathToCurve(path)),getBezierPathSegmentRanges(path).totalLength}),g.pathKeyPoints=cacher(function(path){var i,ii,keyPoints;for(path.isCurve||(path=g.pathToCurve(path)),keyPoints=[],i=0,ii=path.length;i<ii;i++)"z"!=path[i][0]&&keyPoints.push(path[i].slice(path[i].length-2));return keyPoints});var alignCurve=cacher(function(path1,path2){function command(p,i){return p[i||p.i]&&p[i||p.i][0]}function param(p,i){return p[i||p.i]&&p[i||p.i].slice(1)}function point(p,i){var _param=param(p,i);return _param&&_param.slice(-2)}function fixZ(p){return"Z"==command(p)&&(p.splice(p.i,1),!0)}function fixM(p){return"M"==command(p)&&(p.o.splice(p.o.i,0,["M"].concat(point(p.o,p.o.i-1))),p.i++,p.o.i++,!0)}function fill(p){for(var lastPoint,i=1;!lastPoint;)lastPoint=point(p,p.length-i++);for(p.o.i=p.i;p.length<p.o.length;)fixZ(p.o)||fixM(p.o)||(p.push(["C"].concat(lastPoint).concat(lastPoint).concat(lastPoint)),p.i++,p.o.i++)}path1.isCurve||(path1=g.pathToCurve(path1)),path2.isCurve||(path2=g.pathToCurve(path2));var p1=pathClone(path1),p2=pathClone(path2);for(p1.i=0,p2.i=0,p1.o=p2,p2.o=p1;p1.i<p1.length&&p2.i<p2.length;)fixZ(p1)||fixZ(p2)||(command(p1)!=command(p2)?fixM(p1)||fixM(p2)||(p1.i++,p2.i++):(p1.i++,p2.i++));return p1.i==p1.length&&fill(p1),p2.i==p2.length&&fill(p2),delete p1.i,delete p1.o,delete p2.i,delete p2.o,[p1,p2]});return g.alignCurve=alignCurve,g.pathTween=function(path1,path2,t){if(0===t)return path1;if(1===t)return path2;var seg,i,j,aligned=alignCurve(path1,path2),result=[];for(path1=aligned[0],path2=aligned[1],i=0;i<path1.length;i++)for(result.push(seg=[]),seg.push(path1[i][0]),j=1;j<path1[i].length;j++)seg.push(path1[i][j]+t*(path2[i][j]-path1[i][j]));return result.isUniform=result.isCurve=result.isAbsolute=!0,result},g.transformPath=cacher(function(path,matrix){var i,ii,j,result,pair;for(path.isCurve||(path=g.pathToCurve(path)),result=[],i=0,ii=path.length;i<ii;i++)for(result.push([path[i][0]]),j=1;j<path[i].length;j+=2)pair=path[i].slice(j,j+2),pair=matrix.transformPoint(Point.parse(pair)),result.push(pair);return result}),require("core/class").extendClass(Matrix,{transformPath:function(path){return g.transformPath(path,this)}}),g}),define("graphic/gradientbrush",["graphic/svg","graphic/defbrush","core/class","graphic/resource","graphic/color","core/utils","graphic/standardcolor"],function(require,exports,module){var svg=require("graphic/svg"),DefBrush=require("graphic/defbrush"),Color=require("graphic/color");return require("core/class").createClass("GradientBrush",{base:DefBrush,constructor:function(gradientNodeType){this.callBase(gradientNodeType),this.stops=[]},addStop:function(offset,color,opacity){var gstop=svg.createNode("stop");return color instanceof Color||(color=Color.parse(color)),void 0===opacity&&(opacity=color.get("a")),gstop.setAttribute("offset",offset),gstop.setAttribute("stop-color",color.toRGB()),opacity<1&&gstop.setAttribute("stop-opacity",opacity),this.node.appendChild(gstop),this}})}),define("graphic/group",["graphic/shapecontainer","graphic/container","core/utils","core/class","graphic/shape","graphic/svg","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){var ShapeContainer=require("graphic/shapecontainer");return require("core/class").createClass("Group",{mixins:[ShapeContainer],base:require("graphic/shape"),constructor:function(){this.callBase("g")}})}),define("graphic/hyperlink",["graphic/shapecontainer","graphic/container","core/utils","core/class","graphic/shape","graphic/svg","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){var ShapeContainer=require("graphic/shapecontainer");return require("core/class").createClass("HyperLink",{mixins:[ShapeContainer],base:require("graphic/shape"),constructor:function(url){this.callBase("a"),this.setHref(url)},setHref:function(href){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",href),this},getHref:function(){return this.node.getAttributeNS("xlink:href")},setTarget:function(target){return this.node.setAttribute("target",target),this},getTarget:function(){return this.node.getAttribute("target")}})}),define("graphic/image",["core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){return require("core/class").createClass("Image",{base:require("graphic/shape"),constructor:function(url,width,height,x,y){this.callBase("image"),this.url=url,this.width=width||0,this.height=height||0,this.x=x||0,this.y=y||0,this.update()},update:function(){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.url),this.node.setAttribute("x",this.x),this.node.setAttribute("y",this.y),this.node.setAttribute("width",this.width),this.node.setAttribute("height",this.height),this},setUrl:function(url){return this.url=""===url?null:url,this.update()},getUrl:function(){return this.url},setWidth:function(width){return this.width=width,this.update()},getWidth:function(){return this.width},setHeight:function(height){return this.height=height,this.update()},getHeight:function(){return this.height},setX:function(x){return this.x=x,this.update()},getX:function(){return this.x},setY:function(y){return this.y=y,this.update()},getY:function(){return this.y}})}),define("graphic/line",["core/class","graphic/path","core/utils","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){return require("core/class").createClass("Line",{base:require("graphic/path"),constructor:function(x1,y1,x2,y2){this.callBase(),this.point1={x:x1||0,y:y1||0},this.point2={x:x2||0,y:y2||0},this.update()},setPoint1:function(x,y){return this.point1.x=x,this.point1.y=y,this.update()},setPoint2:function(x,y){return this.point2.x=x,this.point2.y=y,this.update()},getPoint1:function(){return{x:this.point1.x,y:this.point1.y}},getPoint2:function(){return{x:this.point2.x,y:this.point2.y}},update:function(){var drawer=this.getDrawer();return drawer.clear(),drawer.moveTo(this.point1.x,this.point1.y),drawer.lineTo(this.point2.x,this.point2.y),this}})}),define("graphic/lineargradientbrush",["graphic/svg","graphic/gradientbrush","graphic/defbrush","graphic/color","core/class"],function(require,exports,module){var GradientBrush=(require("graphic/svg"),require("graphic/gradientbrush"));return require("core/class").createClass("LinearGradientBrush",{base:GradientBrush,constructor:function(builder){this.callBase("linearGradient"),this.setStartPosition(0,0),this.setEndPosition(1,0),"function"==typeof builder&&builder.call(this,this)},setStartPosition:function(px,py){return this.node.setAttribute("x1",px),this.node.setAttribute("y1",py),this},setEndPosition:function(px,py){return this.node.setAttribute("x2",px),this.node.setAttribute("y2",py),this},getStartPosition:function(){return{x:+this.node.getAttribute("x1"),y:+this.node.getAttribute("y1")}},getEndPosition:function(){return{x:+this.node.getAttribute("x2"),y:+this.node.getAttribute("y2")}}})}),define("graphic/marker",["graphic/point","core/class","graphic/resource","graphic/svg","graphic/shapecontainer","graphic/container","core/utils","graphic/shape","graphic/viewbox","graphic/path","graphic/geometry"],function(require,exports,module){var Point=require("graphic/point"),Marker=require("core/class").createClass("Marker",{base:require("graphic/resource"),mixins:[require("graphic/shapecontainer"),require("graphic/viewbox")],constructor:function(){this.callBase("marker"),this.setOrient("auto")},setRef:function(x,y){return 1===arguments.length&&(y=x.y,x=x.x),this.node.setAttribute("refX",x),this.node.setAttribute("refY",y),this},getRef:function(){return new Point(+this.node.getAttribute("refX"),+this.node.getAttribute("refY"))},setWidth:function(width){return this.node.setAttribute("markerWidth",this.width=width),this},setOrient:function(orient){return this.node.setAttribute("orient",this.orient=orient),this},getOrient:function(){return this.orient},getWidth:function(){return+this.width},setHeight:function(height){return this.node.setAttribute("markerHeight",this.height=height),this},getHeight:function(){return+this.height}}),Path=require("graphic/path");return require("core/class").extendClass(Path,{setMarker:function(marker,pos){return pos=pos||"end",marker?this.node.setAttribute("marker-"+pos,marker.toString()):this.node.removeAttribute("marker-"+pos),this}}),Marker}),define("graphic/mask",["core/class","graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box","graphic/shapecontainer","graphic/container"],function(require,exports,module){var Class=require("core/class"),Shape=require("graphic/shape"),Mask=Class.createClass("Mask",{base:Shape,mixins:[require("graphic/shapecontainer")],constructor:function(){this.callBase("mask")},mask:function(shape){return shape.getNode().setAttribute("mask","url(#"+this.getId()+")"),this}});return Class.extendClass(Shape,{maskWith:function(mask){return mask.mask(this),this}}),Mask}),define("graphic/matrix",["core/utils","graphic/box","core/class","graphic/point"],function(require,exports,module){function mergeMatrixData(m2,m1){return{a:m1.a*m2.a+m1.c*m2.b,b:m1.b*m2.a+m1.d*m2.b,c:m1.a*m2.c+m1.c*m2.d,d:m1.b*m2.c+m1.d*m2.d,e:m1.a*m2.e+m1.c*m2.f+m1.e,f:m1.b*m2.e+m1.d*m2.f+m1.f}}function d2r(deg){return deg*Math.PI/180}var utils=require("core/utils"),Box=require("graphic/box"),mPattern=/matrix\((.+)\)/i,Point=require("graphic/point"),Matrix=require("core/class").createClass("Matrix",{constructor:function(){arguments.length?this.setMatrix.apply(this,arguments):this.setMatrix(1,0,0,1,0,0)},translate:function(x,y){return this.m=mergeMatrixData(this.m,{a:1,c:0,e:x,b:0,d:1,f:y}),this},rotate:function(deg){var rad=d2r(deg),sin=Math.sin(rad),cos=Math.cos(rad);return this.m=mergeMatrixData(this.m,{a:cos,c:-sin,e:0,b:sin,d:cos,f:0}),this},scale:function(sx,sy){return void 0===sy&&(sy=sx),this.m=mergeMatrixData(this.m,{a:sx,c:0,e:0,b:0,d:sy,f:0}),this},skew:function(degX,degY){void 0===degY&&(degY=degX);var tx=Math.tan(d2r(degX)),ty=Math.tan(d2r(degY));return this.m=mergeMatrixData(this.m,{a:1,c:tx,e:0,b:ty,d:1,f:0}),this},inverse:function(){var k,aa,bb,cc,dd,ee,ff,m=this.m,a=m.a,b=m.b,c=m.c,d=m.d,e=m.e,f=m.f;return k=a*d-b*c,aa=d/k,bb=-b/k,cc=-c/k,dd=a/k,ee=(c*f-e*d)/k,ff=(b*e-a*f)/k,new Matrix(aa,bb,cc,dd,ee,ff)},setMatrix:function(a,b,c,d,e,f){return 1===arguments.length?this.m=utils.clone(arguments[0]):this.m={a:a,b:b,c:c,d:d,e:e,f:f},this},getMatrix:function(){return utils.clone(this.m)},getTranslate:function(){var m=this.m;return{x:m.e/m.a,y:m.f/m.d}},mergeMatrix:function(matrix){return new Matrix(mergeMatrixData(this.m,matrix.m))},merge:function(matrix){return this.mergeMatrix(matrix)},toString:function(){return this.valueOf().join(" ")},valueOf:function(){var m=this.m;return[m.a,m.b,m.c,m.d,m.e,m.f]},equals:function(matrix){var m1=this.m,m2=matrix.m;return m1.a==m2.a&&m1.b==m2.b&&m1.c==m2.c&&m1.d==m2.d&&m1.e==m2.e&&m1.f==m2.f},transformPoint:function(){return Matrix.transformPoint.apply(null,[].slice.call(arguments).concat([this.m]))},transformBox:function(box){return Matrix.transformBox(box,this.m)}});return Matrix.parse=function(str){var match,f=parseFloat;if(str instanceof Array)return new Matrix({a:str[0],b:str[1],c:str[2],d:str[3],e:str[4],f:str[5]});if(match=mPattern.exec(str)){var values=match[1].split(",");return 6!=values.length&&(values=match[1].split(" ")),new Matrix({a:f(values[0]),b:f(values[1]),c:f(values[2]),d:f(values[3]),e:f(values[4]),f:f(values[5])})}return new Matrix},Matrix.transformPoint=function(x,y,m){return 2===arguments.length&&(m=y,y=x.y,x=x.x),new Point(m.a*x+m.c*y+m.e,m.b*x+m.d*y+m.f)},Matrix.transformBox=function(box,matrix){for(var bp,rp,xMin=Number.MAX_VALUE,xMax=-Number.MAX_VALUE,yMin=Number.MAX_VALUE,yMax=-Number.MAX_VALUE,bps=[[box.x,box.y],[box.x+box.width,box.y],[box.x,box.y+box.height],[box.x+box.width,box.y+box.height]],rps=[];bp=bps.pop();)rp=Matrix.transformPoint(bp[0],bp[1],matrix),rps.push(rp),xMin=Math.min(xMin,rp.x),xMax=Math.max(xMax,rp.x),yMin=Math.min(yMin,rp.y),yMax=Math.max(yMax,rp.y);return box=new Box({x:xMin,y:yMin,width:xMax-xMin,height:yMax-yMin}),utils.extend(box,{closurePoints:rps,left:xMin,right:xMax,top:yMin,bottom:yMax,cx:(xMin+xMax)/2,cy:(yMin+yMax)/2}),box},Matrix.getCTM=function(target,refer){var ctm={a:1,b:0,c:0,d:1,e:0,f:0};switch(refer=refer||"parent"){case"screen":ctm=target.node.getScreenCTM();break;case"doc":case"paper":ctm=target.node.getCTM();break;case"view":case"top":target.getPaper()&&(ctm=target.node.getTransformToElement(target.getPaper().shapeNode));break;case"parent":target.node.parentNode&&(ctm=target.node.getTransformToElement(target.node.parentNode));break;default:refer.node&&(ctm=target.node.getTransformToElement(refer.shapeNode||refer.node))}return ctm?new Matrix(ctm.a,ctm.b,ctm.c,ctm.d,ctm.e,ctm.f):new Matrix},Matrix}),define("graphic/palette",["graphic/standardcolor","graphic/color","core/utils","core/class"],function(require,exports,module){var StandardColor=require("graphic/standardcolor"),Color=require("graphic/color"),Utils=require("core/utils"),Palette=require("core/class").createClass("Palette",{constructor:function(){this.color={}},get:function(name){var colorValue=this.color[name]||StandardColor.EXTEND_STANDARD[name]||StandardColor.COLOR_STANDARD[name]||"";return colorValue?new Color(colorValue):null},getColorValue:function(name){return this.color[name]||StandardColor.EXTEND_STANDARD[name]||StandardColor.COLOR_STANDARD[name]||""},add:function(name,value){return this.color[name]="string"==typeof value?new Color(value).toRGBA():value.toRGBA(),value},remove:function(name){return!!this.color.hasOwnProperty(name)&&(delete this.color[name],!0)}});return Utils.extend(Palette,{getColor:function(name){var colorValue=StandardColor.EXTEND_STANDARD[name]||StandardColor.COLOR_STANDARD[name];return colorValue?new Color(colorValue):null},getColorValue:function(name){return StandardColor.EXTEND_STANDARD[name]||StandardColor.COLOR_STANDARD[name]||""},addColor:function(name,value){return StandardColor.EXTEND_STANDARD[name]="string"==typeof value?new Color(value).toRGBA():value.toRGBA(),value},removeColor:function(name){return!!StandardColor.EXTEND_STANDARD.hasOwnProperty(name)&&(delete StandardColor.EXTEND_STANDARD[name],!0)}}),Palette}),define("graphic/paper",["core/class","core/utils","graphic/svg","graphic/container","graphic/shapecontainer","graphic/shape","graphic/viewbox","graphic/eventhandler","graphic/shapeevent","graphic/styled","graphic/matrix","graphic/box","graphic/point","graphic/data","graphic/pen"],function(require,exports,module){var Class=require("core/class"),utils=require("core/utils"),svg=require("graphic/svg"),Container=require("graphic/container"),ShapeContainer=require("graphic/shapecontainer"),ViewBox=require("graphic/viewbox"),EventHandler=require("graphic/eventhandler"),Styled=require("graphic/styled"),Matrix=require("graphic/matrix"),Paper=Class.createClass("Paper",{mixins:[ShapeContainer,EventHandler,Styled,ViewBox],constructor:function(container){this.callBase(),this.node=this.createSVGNode(),this.node.paper=this,this.node.appendChild(this.resourceNode=svg.createNode("defs")),this.node.appendChild(this.shapeNode=svg.createNode("g")),this.resources=new Container,this.setWidth("100%").setHeight("100%"),container&&this.renderTo(container),this.callMixin()},renderTo:function(container){utils.isString(container)&&(container=document.getElementById(container)),this.container=container,container.appendChild(this.node)},createSVGNode:function(){var node=svg.createNode("svg");return node.setAttribute("xmlns","http://www.w3.org/2000/svg"),node.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),node},getNode:function(){return this.node},getContainer:function(){return this.container},getWidth:function(){return this.node.clientWidth},setWidth:function(width){return this.node.setAttribute("width",width),this},getHeight:function(){return this.node.clientHeight},setHeight:function(height){return this.node.setAttribute("height",height),this},setViewPort:function(cx,cy,zoom){var viewport,box;1==arguments.length&&(viewport=arguments[0],cx=viewport.center.x,cy=viewport.center.y,zoom=viewport.zoom),zoom=zoom||1,box=this.getViewBox();var matrix=new Matrix,dx=box.x+box.width/2-cx,dy=box.y+box.height/2-cy;return matrix.translate(-cx,-cy),matrix.scale(zoom),matrix.translate(cx,cy),matrix.translate(dx,dy),this.shapeNode.setAttribute("transform","matrix("+matrix+")"),this.viewport={center:{x:cx,y:cy},offset:{x:dx,y:dy},zoom:zoom},this},getViewPort:function(){if(!this.viewport){var box=this.getViewBox();return{zoom:1,center:{x:box.x+box.width/2,y:box.y+box.height/2},offset:{x:0,y:0}}}return this.viewport},getViewPortTransform:function(){var m=this.shapeNode.getCTM();return new Matrix(m.a,m.b,m.c,m.d,m.e,m.f)},getTransform:function(){return this.getViewPortTransform().reverse()},addResource:function(resource){return this.resources.appendItem(resource),resource.node&&this.resourceNode.appendChild(resource.node),this},removeResource:function(resource){return resource.remove&&resource.remove(),resource.node&&this.resourceNode.removeChild(resource.node),this},getPaper:function(){return this}}),Shape=require("graphic/shape");return Class.extendClass(Shape,{getPaper:function(){for(var parent=this.container;parent&&parent instanceof Paper==!1;)parent=parent.container;return parent},whenPaperReady:function(fn){function check(){var paper=me.getPaper();return paper&&fn&&fn.call(me,paper),paper}var me=this;return check()||this.on("add treeadd",function listen(){check()&&(me.off("add",listen),me.off("treeadd",listen))}),this}}),Paper}),define("graphic/path",["core/utils","core/class","graphic/shape","graphic/svg","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box","graphic/geometry","graphic/point","graphic/vector"],function(require,exports,module){var Utils=require("core/utils"),createClass=require("core/class").createClass,Shape=require("graphic/shape"),svg=require("graphic/svg"),g=require("graphic/geometry"),slice=Array.prototype.slice,PathDrawer=(Utils.flatten,createClass("PathDrawer",{constructor:function(path){this.segment=[],this.path=path,this.__clear=!1},getPath:function(){return this.path},redraw:function(){return this._transation=this._transation||[],this.clear()},done:function(){var transation=this._transation;return this._transation=null,this.push(transation),this},clear:function(){return this._transation?this._transation=[]:this.path.setPathData("M 0 0"),this._clear=!0,this},push:function(){var originData,segment=slice.call(arguments);return this._transation?(this._transation.push(segment),this):(this._clear?(originData="",this._clear=!1):originData=this.path.getPathData(),originData=originData||"",this.path.setPathData(originData+g.pathToString(segment)),this)},moveTo:function(x,y){return this.push("M",slice.call(arguments))},moveBy:function(dx,dy){return this.push("m",slice.call(arguments))},lineTo:function(x,y){return this.push("L",slice.call(arguments))},lineBy:function(dx,dy){return this.push("l",slice.call(arguments))},arcTo:function(rx,ry,xr,laf,sf,x,y){return this.push("A",slice.call(arguments))},arcBy:function(rx,ry,xr,laf,sf,dx,dy){return this.push("a",arguments)},carcTo:function(r,laf,sf,x,y){return this.push("A",[r,r,0].concat(slice.call(arguments,1)))},carcBy:function(r,laf,sf,dx,dy){return this.push("a",[r,r,0].concat(slice.call(arguments,1)))},bezierTo:function(x1,y1,x2,y2,x,y){return this.push("C",slice.call(arguments))},bezierBy:function(dx1,dy1,dx2,dy2,dx,dy){return this.push("c",slice.call(arguments))},close:function(){return this.push("z")}}));return createClass("Path",{base:Shape,constructor:function(data){this.callBase("path"),data&&this.setPathData(data),this.node.setAttribute("fill",svg.defaults.fill),this.node.setAttribute("stroke",svg.defaults.stroke)},setPathData:function(data){return data=data||"M0,0",this.pathdata=g.pathToString(data),this.node.setAttribute("d",this.pathdata),this.trigger("shapeupdate",{type:"pathdata"}),this},getPathData:function(){return this.pathdata||""},getDrawer:function(){return new PathDrawer(this)},isClosed:function(){var data=this.getPathData();return!!~data.indexOf("z")||!!~data.indexOf("Z")}})}),define("graphic/patternbrush",["graphic/defbrush","core/class","graphic/resource","graphic/shapecontainer","graphic/container","core/utils","graphic/shape","graphic/svg"],function(require,exports,module){var DefBrush=require("graphic/defbrush"),ShapeContainer=require("graphic/shapecontainer");require("graphic/svg");return require("core/class").createClass("PatternBrush",{base:DefBrush,mixins:[ShapeContainer],constructor:function(){this.callBase("pattern"),this.node.setAttribute("patternUnits","userSpaceOnUse")},setX:function(x){return this.x=x,this.node.setAttribute("x",x),this},setY:function(y){return this.y=y,this.node.setAttribute("y",y),this},setWidth:function(width){return this.width=width,this.node.setAttribute("width",width),this},setHeight:function(height){return this.height=height,this.node.setAttribute("height",height),this},getWidth:function(){return this.width},getHeight:function(){return this.height}})}),define("graphic/pen",["graphic/color","core/utils","graphic/standardcolor","core/class"],function(require,exports,module){var Color=require("graphic/color");return require("core/class").createClass("Pen",{constructor:function(brush,width){this.brush=brush,this.width=width||1,this.linecap=null,this.linejoin=null,this.dashArray=null,this.opacity=1},getBrush:function(){return this.brush},setBrush:function(brush){return this.brush=brush,this},setColor:function(color){return this.setBrush(color)},getColor:function(){return this.brush instanceof Color?this.brush:null},getWidth:function(){return this.width},setWidth:function(width){return this.width=width,this},getOpacity:function(){return this.opacity},setOpacity:function(opacity){this.opacity=opacity},getLineCap:function(){return this.linecap},setLineCap:function(linecap){return this.linecap=linecap,this},getLineJoin:function(){return this.linejoin},setLineJoin:function(linejoin){return this.linejoin=linejoin,this},getDashArray:function(){return this.dashArray},setDashArray:function(dashArray){return this.dashArray=dashArray,this},stroke:function(shape){var node=shape.node;node.setAttribute("stroke",this.brush.toString()),node.setAttribute("stroke-width",this.getWidth()),this.getOpacity()<1&&node.setAttribute("stroke-opacity",this.getOpacity()),this.getLineCap()&&node.setAttribute("stroke-linecap",this.getLineCap()),this.getLineJoin()&&node.setAttribute("stroke-linejoin",this.getLineJoin()),this.getDashArray()&&node.setAttribute("stroke-dasharray",this.getDashArray())}})}),define("graphic/pie",["core/class","graphic/sweep","graphic/point","graphic/path"],function(require,exports,module){return require("core/class").createClass({base:require("graphic/sweep"),constructor:function(radius,angle,angleOffset){this.callBase([0,radius],angle,angleOffset)},getRadius:function(){return this.getSectionArray()[1]},setRadius:function(radius){this.setSectionArray([0,radius])}})}),define("graphic/point",["core/class"],function(require,exports,module){var Point=require("core/class").createClass("Point",{constructor:function(x,y){this.x=x||0,this.y=y||0},offset:function(dx,dy){return 1==arguments.length&&(dy=dx.y,dx=dx.x),new Point(this.x+dx,this.y+dy)},valueOf:function(){return[this.x,this.y]},toString:function(){return this.valueOf().join(" ")},spof:function(){return new Point(.5+(0|this.x),.5+(0|this.y))}});return Point.fromPolar=function(radius,angle,unit){return"rad"!=unit&&(angle=angle/180*Math.PI),new Point(radius*Math.cos(angle),radius*Math.sin(angle))},Point.parse=function(unknown){return unknown instanceof Point?unknown:"string"==typeof unknown?Point.parse(unknown.split(/\s*[\s,]\s*/)):"0"in unknown&&"1"in unknown?new Point(unknown[0],unknown[1]):void 0},Point}),define("graphic/pointcontainer",["core/class","graphic/container"],function(require,exports,module){return require("core/class").createClass("PointContainer",{base:require("graphic/container"),constructor:function(){this.callBase()},addPoint:function(point,pos){return this.addItem.apply(this,arguments)},prependPoint:function(){return this.prependItem.apply(this,arguments)},appendPoint:function(){return this.appendItem.apply(this,arguments)},removePoint:function(pos){return this.removeItem.apply(this,arguments)},addPoints:function(){return this.addItems.apply(this,arguments)},setPoints:function(){return this.setItems.apply(this,arguments)},getPoint:function(){return this.getItem.apply(this,arguments)},getPoints:function(){return this.getItems.apply(this,arguments)},getFirstPoint:function(){return this.getFirstItem.apply(this,arguments)},getLastPoint:function(){return this.getLastItem.apply(this,arguments)}})}),define("graphic/poly",["core/utils","core/class","graphic/path","graphic/shape","graphic/svg","graphic/geometry","graphic/pointcontainer","graphic/container"],function(require,exports,module){require("core/utils");return require("core/class").createClass("Poly",{base:require("graphic/path"),mixins:[require("graphic/pointcontainer")],constructor:function(points,closeable){this.callBase(),this.closeable=!!closeable,this.setPoints(points||[]),this.changeable=!0,this.update()},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var drawer=this.getDrawer(),points=this.getPoints();if(drawer.clear(),!points.length)return this;drawer.moveTo(points[0]);for(var point,i=1,len=points.length;i<len;i++)point=points[i],drawer.lineTo(point);return this.closeable&&points.length>2&&drawer.close(),this}})}),define("graphic/polygon",["core/class","graphic/poly","core/utils","graphic/path","graphic/pointcontainer"],function(require,exports,module){return require("core/class").createClass("Polygon",{base:require("graphic/poly"),constructor:function(points){this.callBase(points,!0)}})}),define("graphic/polyline",["core/class","graphic/poly","core/utils","graphic/path","graphic/pointcontainer"],function(require,exports,module){return require("core/class").createClass("Polyline",{base:require("graphic/poly"),constructor:function(points){this.callBase(points)}})}),define("graphic/radialgradientbrush",["graphic/gradientbrush","graphic/svg","graphic/defbrush","graphic/color","core/class"],function(require,exports,module){var GradientBrush=require("graphic/gradientbrush");return require("core/class").createClass("RadialGradientBrush",{base:GradientBrush,constructor:function(builder){this.callBase("radialGradient"),this.setCenter(.5,.5),this.setFocal(.5,.5),this.setRadius(.5),"function"==typeof builder&&builder.call(this,this)},setCenter:function(cx,cy){return this.node.setAttribute("cx",cx),this.node.setAttribute("cy",cy),this},getCenter:function(){return{x:+this.node.getAttribute("cx"),y:+this.node.getAttribute("cy")}},setFocal:function(fx,fy){return this.node.setAttribute("fx",fx),this.node.setAttribute("fy",fy),this},getFocal:function(){return{x:+this.node.getAttribute("fx"),y:+this.node.getAttribute("fy")}},setRadius:function(r){return this.node.setAttribute("r",r),this},getRadius:function(){return+this.node.getAttribute("r")}})}),define("graphic/rect",["core/utils","graphic/point","core/class","graphic/path","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){var RectUtils={},Utils=require("core/utils"),Point=require("graphic/point");return Utils.extend(RectUtils,{formatRadius:function(width,height,radius){var minValue=Math.floor(Math.min(width/2,height/2));return Math.min(minValue,radius)}}),require("core/class").createClass("Rect",{base:require("graphic/path"),constructor:function(width,height,x,y,radius){this.callBase(),this.x=x||0,this.y=y||0,this.width=width||0,this.height=height||0,this.radius=RectUtils.formatRadius(this.width,this.height,radius||0),this.update()},update:function(){var x=this.x,y=this.y,w=this.width,h=this.height,r=this.radius,drawer=this.getDrawer().redraw();return r?(w-=2*r,h-=2*r,drawer.push("M",x+r,y),drawer.push("h",w),drawer.push("a",r,r,0,0,1,r,r),drawer.push("v",h),drawer.push("a",r,r,0,0,1,-r,r),drawer.push("h",-w),drawer.push("a",r,r,0,0,1,-r,-r),drawer.push("v",-h),drawer.push("a",r,r,0,0,1,r,-r),drawer.push("z")):(drawer.push("M",x,y),drawer.push("h",w),drawer.push("v",h),drawer.push("h",-w),drawer.push("z")),drawer.done(),this},setWidth:function(width){return this.width=width,this.update()},setHeight:function(height){return this.height=height,this.update()},setSize:function(width,height){return this.width=width,this.height=height,this.update()},getRadius:function(){return this.radius},setRadius:function(radius){return this.radius=radius,this.update()},getPosition:function(){return new Point(this.x,this.y)},setPosition:function(x,y){if(1==arguments.length){var p=Point.parse(arguments[0]);y=p.y,x=p.x}return this.x=x,this.y=y,this.update()},getWidth:function(){return this.width},getHeight:function(){return this.height},getPositionX:function(){return this.x},getPositionY:function(){return this.y},setPositionX:function(x){return this.x=x,this.update()},setPositionY:function(y){return this.y=y,this.update()}})}),define("graphic/regularpolygon",["graphic/point","core/class","graphic/path","core/utils","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){var Point=require("graphic/point");return require("core/class").createClass("RegularPolygon",{base:require("graphic/path"),constructor:function(side,radius,x,y){this.callBase(),this.radius=radius||0,this.side=Math.max(side||3,3),arguments.length>2&&3==arguments.length&&(y=x.y,x=x.x),this.center=new Point(x,y),this.draw()},
getSide:function(){return this.side},setSide:function(side){return this.side=side,this.draw()},getRadius:function(){return this.radius},setRadius:function(radius){return this.radius=radius,this.draw()},draw:function(){var i,radius=this.radius,side=this.side,step=2*Math.PI/side,drawer=this.getDrawer();for(drawer.clear(),drawer.moveTo(Point.fromPolar(radius,Math.PI/2,"rad").offset(this.center)),i=0;i<=side;i++)drawer.lineTo(Point.fromPolar(radius,step*i+Math.PI/2,"rad").offset(this.center));return drawer.close(),this}})}),define("graphic/resource",["graphic/svg","core/class"],function(require,exports,module){var svg=require("graphic/svg");return require("core/class").createClass("Resource",{constructor:function(nodeType){this.callBase(),this.node=svg.createNode(nodeType)},toString:function(){return"url(#"+this.node.id+")"}})}),define("graphic/ring",["core/class","graphic/sweep","graphic/point","graphic/path"],function(require,exports,module){return require("core/class").createClass({base:require("graphic/sweep"),constructor:function(innerRadius,outerRadius){this.callBase([innerRadius,outerRadius],360,0)},getInnerRadius:function(){return this.getSectionArray()[0]},getOuterRadius:function(){return this.getSectionArray()[1]},setInnerRadius:function(value){this.setSectionArray([value,this.getOuterRadius()])},setOuterRadius:function(value){this.setSectionArray([this.getInnerRadius(),value])}})}),define("graphic/shape",["graphic/svg","core/utils","graphic/eventhandler","graphic/shapeevent","core/class","graphic/styled","graphic/data","graphic/matrix","graphic/box","graphic/point","graphic/pen","graphic/color"],function(require,exports,module){var svg=require("graphic/svg"),utils=require("core/utils"),EventHandler=require("graphic/eventhandler"),Styled=require("graphic/styled"),Data=require("graphic/data"),Matrix=require("graphic/matrix"),slice=(require("graphic/pen"),Array.prototype.slice),Box=require("graphic/box");return require("core/class").createClass("Shape",{mixins:[EventHandler,Styled,Data],constructor:function(tagName){this.node=svg.createNode(tagName),this.node.shape=this,this.transform={translate:null,rotate:null,scale:null,matrix:null},this.callMixin()},getId:function(){return this.node.id},setId:function(id){return this.node.id=id,this},getNode:function(){return this.node},getBoundaryBox:function(){var box;try{box=this.node.getBBox()}catch(e){box={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}return new Box(box)},getRenderBox:function(refer){var box=this.getBoundaryBox();return this.getTransform(refer).transformBox(box)},getWidth:function(){return this.getRenderBox().width},getHeight:function(){return this.getRenderBox().height},getSize:function(){var box=this.getRenderBox();return delete box.x,delete box.y,box},setOpacity:function(value){return this.node.setAttribute("opacity",value),this},getOpacity:function(){var opacity=this.node.getAttribute("opacity");return opacity?+opacity:1},setVisible:function(value){return value?this.node.removeAttribute("display"):this.node.setAttribute("display","none"),this},getVisible:function(){this.node.getAttribute("display")},hasAncestor:function(node){for(var parent=this.container;parent;){if(parent===node)return!0;parent=parent.container}return!1},getTransform:function(refer){return Matrix.getCTM(this,refer)},clearTransform:function(){return this.node.removeAttribute("transform"),this.transform={translate:null,rotate:null,scale:null,matrix:null},this.trigger("shapeupdate",{type:"transform"}),this},_applyTransform:function(){var t=this.transform,result=[];return t.translate&&result.push(["translate(",t.translate,")"]),t.rotate&&result.push(["rotate(",t.rotate,")"]),t.scale&&result.push(["scale(",t.scale,")"]),t.matrix&&result.push(["matrix(",t.matrix,")"]),this.node.setAttribute("transform",utils.flatten(result).join(" ")),this},setMatrix:function(m){return this.transform.matrix=m,this._applyTransform()},setTranslate:function(t){return this.transform.translate=null!==t&&slice.call(arguments)||null,this._applyTransform()},setRotate:function(r){return this.transform.rotate=null!==r&&slice.call(arguments)||null,this._applyTransform()},setScale:function(s){return this.transform.scale=null!==s&&slice.call(arguments)||null,this._applyTransform()},translate:function(dx,dy){var m=this.transform.matrix||new Matrix;return void 0===dy&&(dy=0),this.transform.matrix=m.translate(dx,dy),this._applyTransform()},rotate:function(deg){var m=this.transform.matrix||new Matrix;return this.transform.matrix=m.rotate(deg),this._applyTransform()},scale:function(sx,sy){var m=this.transform.matrix||new Matrix;return void 0===sy&&(sy=sx),this.transform.matrix=m.scale(sx,sy),this._applyTransform()},skew:function(sx,sy){var m=this.transform.matrix||new Matrix;return void 0===sy&&(sy=sx),this.transform.matrix=m.skew(sx,sy),this._applyTransform()},stroke:function(pen,width){return pen&&pen.stroke?pen.stroke(this):(this.node.setAttribute("stroke",pen.toString()),width&&this.node.setAttribute("stroke-width",width)),this},fill:function(brush){return this.node.setAttribute("fill",brush.toString()),this},setAttr:function(a,v){var me=this;utils.isObject(a)&&utils.each(a,function(val,key){me.setAttr(key,val)}),void 0===v||null===v||""===v?this.node.removeAttribute(a):this.node.setAttribute(a,v)},getAttr:function(a){return this.node.getAttribute(a)}})}),define("graphic/shapecontainer",["graphic/container","core/class","core/utils","graphic/shape","graphic/svg","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){var Container=require("graphic/container"),utils=require("core/utils"),ShapeContainer=require("core/class").createClass("ShapeContainer",{base:Container,isShapeContainer:!0,handleAdd:function(shape,index){var parent=this.getShapeNode();parent.insertBefore(shape.node,parent.childNodes[index]||null),shape.trigger("add",{container:this}),shape.notifyTreeModification&&shape.notifyTreeModification("treeadd",this)},handleRemove:function(shape,index){this.getShapeNode().removeChild(shape.node),shape.trigger("remove",{container:this}),shape.notifyTreeModification&&shape.notifyTreeModification("treeremove",this)},notifyTreeModification:function(type,container){this.eachItem(function(index,shape){shape.notifyTreeModification&&shape.notifyTreeModification(type,container),shape.trigger(type,{container:container})})},getShape:function(index){return this.getItem(index)},addShape:function(shape,index){return this.addItem(shape,index)},appendShape:function(shape){return this.addShape(shape)},prependShape:function(shape){return this.addShape(shape,0)},replaceShape:function(replacer,origin){var index=this.indexOf(origin);if(-1!==index)return this.removeShape(index),this.addShape(replacer,index),this},addShapeBefore:function(shape,refer){var index=this.indexOf(refer);return this.addShape(shape,index)},addShapeAfter:function(shape,refer){var index=this.indexOf(refer);return this.addShape(shape,-1===index?void 0:index+1)},addShapes:function(shapes){return this.addItems(shapes)},removeShape:function(index){return this.removeItem(index)},getShapes:function(){return this.getItems()},getShapesByType:function(name){function getShapes(shape){name.toLowerCase()==shape.getType().toLowerCase()&&shapes.push(shape),shape.isShapeContainer&&utils.each(shape.getShapes(),function(n){getShapes(n)})}var shapes=[];return getShapes(this),shapes},getShapeById:function(id){return this.getShapeNode().getElementById(id).shape},arrangeShape:function(shape,index){return this.removeShape(shape).addShape(shape,index)},getShapeNode:function(){return this.shapeNode||this.node}}),Shape=require("graphic/shape");return require("core/class").extendClass(Shape,{bringTo:function(index){return this.container.arrangeShape(this,index),this},bringFront:function(){return this.bringTo(this.container.indexOf(this)+1)},bringBack:function(){return this.bringTo(this.container.indexOf(this)-1)},bringTop:function(){return this.container.removeShape(this).addShape(this),this},bringRear:function(){return this.bringTo(0)},bringRefer:function(referShape,offset){return referShape.container&&(this.remove&&this.remove(),referShape.container.addShape(this,referShape.container.indexOf(referShape)+(offset||0))),this},bringAbove:function(referShape){return this.bringRefer(referShape)},bringBelow:function(referShape){return this.bringRefer(referShape,1)},replaceBy:function(newShape){return this.container&&(newShape.bringAbove(this),this.remove()),this}}),ShapeContainer}),define("graphic/shapeevent",["graphic/matrix","core/utils","graphic/box","graphic/point","core/class"],function(require,exprots,module){var Matrix=require("graphic/matrix"),Utils=require("core/utils");require("graphic/point");return require("core/class").createClass("ShapeEvent",{constructor:function(event){var target=null;Utils.isObject(event.target)?Utils.extend(this,event):(this.type=event.type,target=event.target,target.correspondingUseElement&&(target=target.correspondingUseElement),this.originEvent=event,this.targetShape=target.shape||target.paper||event.currentTarget&&(event.currentTarget.shape||event.currentTarget.paper),event._kityParam&&Utils.extend(this,event._kityParam))},preventDefault:function(){var evt=this.originEvent;return!evt||(evt.preventDefault?(evt.preventDefault(),evt.cancelable):(evt.returnValue=!1,!0))},getPosition:function(refer,touchIndex){if(!this.originEvent)return null;var eventClient=this.originEvent.touches?this.originEvent.touches[touchIndex||0]:this.originEvent,clientX=eventClient&&eventClient.clientX||0,clientY=eventClient&&eventClient.clientY||0,node=this.targetShape.shapeNode||this.targetShape.node,point=Matrix.transformPoint(clientX,clientY,node.getScreenCTM().inverse());return Matrix.getCTM(this.targetShape,refer||"view").transformPoint(point)},stopPropagation:function(){var evt=this.originEvent;if(!evt)return!0;evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=!1}})}),define("graphic/shapepoint",["core/class","graphic/point"],function(require,exports,module){return require("core/class").createClass("ShapePoint",{base:require("graphic/point"),constructor:function(px,py){this.callBase(px,py)},setX:function(x){return this.setPoint(x,this.y)},setY:function(y){return this.setPoint(this.x,y)},setPoint:function(x,y){return this.x=x,this.y=y,this.update(),this},getPoint:function(){return this},update:function(){return this.container&&this.container.update&&this.container.update(),this}})}),define("graphic/standardcolor",[],{COLOR_STANDARD:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00"},EXTEND_STANDARD:{}}),define("graphic/star",["graphic/point","core/class","graphic/path","core/utils","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){var defaultRatioForStar={3:.2,5:.38196601125,6:.57735026919,8:.541196100146,10:.726542528005,12:.707106781187},Point=require("graphic/point");return require("core/class").createClass("Star",{base:require("graphic/path"),constructor:function(vertex,radius,shrink,offset,angleOffset){this.callBase(),this.vertex=vertex||3,this.radius=radius||0,this.shrink=shrink,this.offset=offset||new Point(0,0),this.angleOffset=angleOffset||0,this.draw()},getVertex:function(){return this.vertex},setVertex:function(value){return this.vertex=value,this.draw()},getRadius:function(){return this.radius},setRadius:function(value){return this.radius=value,this.draw()},getShrink:function(){return this.shrink},setShrink:function(value){return this.shrink=value,this.draw()},getOffset:function(){return this.offset},setOffset:function(value){return this.offset=value,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(value){return this.angleOffset=value,this.draw()},draw:function(){var i,angle,innerRadius=this.radius,outerRadius=this.radius*(this.shrink||defaultRatioForStar[this.vertex]||.5),vertex=this.vertex,offset=this.offset,angleStep=180/vertex,angleOffset=this.angleOffset,drawer=this.getDrawer();for(drawer.clear(),drawer.moveTo(Point.fromPolar(outerRadius,90)),i=1;i<=2*vertex;i++)angle=90+angleStep*i,i%2?drawer.lineTo(Point.fromPolar(innerRadius,angle+angleOffset).offset(offset)):drawer.lineTo(Point.fromPolar(outerRadius,angle));drawer.close()}})}),define("graphic/styled",["core/class"],function(require,exports,module){function getClassList(node){return node.classList||(node.classList=new ClassList(node)),node.classList}var ClassList=require("core/class").createClass("ClassList",{constructor:function(node){this._node=node,this._list=node.className.toString().split(" ")},_update:function(){this._node.className=this._list.join(" ")},add:function(name){this._list.push(name),this._update()},remove:function(name){var index=this._list.indexOf(name);~index&&this._list.splice(index,1),this._update()},contains:function(name){return!!~this._list.indexOf(name)}});return require("core/class").createClass("Styled",{addClass:function(name){return getClassList(this.node).add(name),this},removeClass:function(name){return getClassList(this.node).remove(name),this},hasClass:function(name){return getClassList(this.node).contains(name)},setStyle:function(styles){if(2==arguments.length)return this.node.style[arguments[0]]=arguments[1],this;for(var name in styles)styles.hasOwnProperty(name)&&(this.node.style[name]=styles[name]);return this}})}),define("graphic/svg",[],function(require,exports,module){var doc=document,id=0,svg={createNode:function(name){var node=doc.createElementNS(svg.ns,name);return node.id="kity_"+name+"_"+id++,node},defaults:{stroke:"none",fill:"none"},xlink:"http://www.w3.org/1999/xlink",ns:"http://www.w3.org/2000/svg"};return svg}),define("graphic/sweep",["graphic/point","core/class","graphic/path","core/utils","graphic/shape","graphic/svg","graphic/geometry"],function(require,exports,module){var Point=require("graphic/point");return require("core/class").createClass("Sweep",{base:require("graphic/path"),constructor:function(sectionArray,angle,angleOffset){this.callBase(),this.sectionArray=sectionArray||[],this.angle=angle||0,this.angleOffset=angleOffset||0,this.draw()},getSectionArray:function(){return this.sectionArray},setSectionArray:function(value){return this.sectionArray=value,this.draw()},getAngle:function(){return this.angle},setAngle:function(value){return this.angle=value,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(value){return this.angleOffset=value,this.draw()},draw:function(){var i,sectionArray=this.sectionArray;for(i=0;i<sectionArray.length;i+=2)this.drawSection(sectionArray[i],sectionArray[i+1]);return this},drawSection:function(from,to){var angleLength=this.angle&&(this.angle%360?this.angle%360:360),angleStart=this.angleOffset,angleHalf=angleStart+angleLength/2,angleEnd=angleStart+angleLength,drawer=this.getDrawer();if(drawer.redraw(),0===angleLength)return void drawer.done();drawer.moveTo(Point.fromPolar(from,angleStart)),drawer.lineTo(Point.fromPolar(to,angleStart)),to&&(drawer.carcTo(to,0,1,Point.fromPolar(to,angleHalf)),drawer.carcTo(to,0,1,Point.fromPolar(to,angleEnd))),drawer.lineTo(Point.fromPolar(from,angleEnd)),from&&(drawer.carcTo(from,0,1,Point.fromPolar(from,angleHalf)),drawer.carcTo(from,0,1,Point.fromPolar(from,angleStart))),drawer.close(),drawer.done()}})}),define("graphic/text",["graphic/textcontent","graphic/shape","core/class","graphic/shapecontainer","graphic/container","core/utils","graphic/svg"],function(require,exports,module){function getTextBoundOffset(text){var style=window.getComputedStyle(text.node),font=[style.fontFamily,style.fontSize,style.fontStretch,style.fontStyle,style.fontVariant,style.fontWeight].join("-");if(offsetHash[font])return offsetHash[font];var textContent=text.getContent();text.setContent("test");var bbox=text.getBoundaryBox(),y=text.getY()+ +text.node.getAttribute("dy"),topOffset=y-bbox.y,bottomOffset=topOffset-bbox.height;return text.setContent(textContent),offsetHash[font]={top:topOffset,bottom:bottomOffset,middle:(topOffset+bottomOffset)/2}}var TextContent=require("graphic/textcontent"),ShapeContainer=require("graphic/shapecontainer"),svg=require("graphic/svg"),offsetHash={};return require("core/class").createClass("Text",{base:TextContent,mixins:[ShapeContainer],constructor:function(content){this.callBase("text"),void 0!==content&&this.setContent(content)},setX:function(x){return this.node.setAttribute("x",x),this},setPosition:function(x,y){return this.setX(x).setY(y)},setY:function(y){return this.node.setAttribute("y",y),this},getX:function(){return+this.node.getAttribute("x")||0},getY:function(){return+this.node.getAttribute("y")||0},setFont:function(font){return this.callBase(font),this.setVerticalAlign(this.getVerticalAlign())},setTextAnchor:function(anchor){return this.node.setAttribute("text-anchor",anchor),this},getTextAnchor:function(){return this.node.getAttribute("text-anchor")||"start"},setVerticalAlign:function(align){return this.whenPaperReady(function(){var dy;switch(align){case"top":dy=getTextBoundOffset(this).top;break;case"bottom":dy=getTextBoundOffset(this).bottom;break;case"middle":dy=getTextBoundOffset(this).middle;break;default:dy=0}this.node.setAttribute("dy",dy)}),this.verticalAlign=align,this},getVerticalAlign:function(){return this.verticalAlign||"baseline"},setStartOffset:function(offset){this.shapeNode!=this.node&&this.shapeNode.setAttribute("startOffset",100*offset+"%")},addSpan:function(span){return this.addShape(span),this},setPath:function(path){var textpath=this.shapeNode;if(this.shapeNode==this.node){for(textpath=this.shapeNode=svg.createNode("textPath");this.node.firstChild;)this.shapeNode.appendChild(this.node.firstChild);this.node.appendChild(textpath)}return textpath.setAttributeNS(svg.xlink,"xlink:href","#"+path.node.id),this.setTextAnchor(this.getTextAnchor()),this}})}),define("graphic/textcontent",["graphic/shape","graphic/svg","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box","core/class"],function(require,exports,module){var Shape=require("graphic/shape");return require("core/class").createClass("TextContent",{base:Shape,constructor:function(nodeType){this.callBase(nodeType),this.shapeNode=this.shapeNode||this.node},clearContent:function(){for(;this.shapeNode.firstChild;)this.shapeNode.removeChild(this.shapeNode.firstChild);return this},setContent:function(content){return this.shapeNode.textContent=content,this},getContent:function(){return this.shapeNode.textContent},appendContent:function(content){return this.shapeNode.textContent+=content,this},setSize:function(value){return this.setFontSize(value)},setFontSize:function(value){return this.setFont({size:value})},setFontFamily:function(value){return this.setFont({family:value})},setFontBold:function(bold){return this.setFont({weight:bold?"bold":"normal"})},setFontItalic:function(italic){return this.setFont({style:italic?"italic":"normal"})},setFont:function(font){var node=this.node;return["family","size","weight","style"].forEach(function(section){null===font[section]?node.removeAttribute("font-"+section):font[section]&&node.setAttribute("font-"+section,font[section])}),this},getExtentOfChar:function(index){return this.node.getExtentOfChar(index)},getRotationOfChar:function(index){return this.node.getRotationOfChar(index)},getCharNumAtPosition:function(x,y){return this.node.getCharNumAtPosition(this.node.viewportElement.createSVGPoint(x,y))}})}),define("graphic/textspan",["graphic/textcontent","graphic/shape","core/class","graphic/styled"],function(require,exports,module){var TextContent=require("graphic/textcontent"),Styled=require("graphic/styled");return require("core/class").createClass("TextSpan",{base:TextContent,mixins:[Styled],constructor:function(content){this.callBase("tspan"),this.setContent(content)}})}),define("graphic/use",["graphic/svg","core/class","graphic/shape","core/utils","graphic/eventhandler","graphic/styled","graphic/data","graphic/matrix","graphic/pen","graphic/box"],function(require,exports,module){var Svg=require("graphic/svg"),Class=require("core/class"),Use=Class.createClass("Use",{base:require("graphic/shape"),constructor:function(shape){var shapeId=null;this.callBase("use"),shapeId=shape.getId(),shapeId&&this.node.setAttributeNS(Svg.xlink,"xlink:href","#"+shapeId),"none"===shape.node.getAttribute("fill")&&shape.node.removeAttribute("fill"),"none"===shape.node.getAttribute("stroke")&&shape.node.removeAttribute("stroke")}}),Shape=require("graphic/shape");return Class.extendClass(Shape,{use:function(){return new Use(this)}}),Use}),define("graphic/vector",["graphic/point","core/class","graphic/matrix","core/utils","graphic/box"],function(require,exports,module){var Point=require("graphic/point"),Matrix=require("graphic/matrix"),Vector=require("core/class").createClass("Vector",{base:Point,constructor:function(x,y){this.callBase(x,y)},square:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.square())},add:function(q){return new Vector(this.x+q.x,this.y+q.y)},minus:function(q){return new Vector(this.x-q.x,this.y-q.y)},dot:function(q){return this.x*q.x+this.y*q.y},project:function(q){return q.multipy(this.dot(q)/q.square())},normalize:function(length){return void 0===length&&(length=1),this.multipy(length/this.length())},multipy:function(scale){return new Vector(this.x*scale,this.y*scale)},rotate:function(angle,unit){"rad"==unit&&(angle=angle/Math.PI*180);var p=(new Matrix).rotate(angle).transformPoint(this);return new Vector(p.x,p.y)},vertical:function(){return new Vector(this.y,-this.x)},reverse:function(){return this.multipy(-1)},getAngle:function(){var length=this.length();if(0===length)return 0;var rad=Math.acos(this.x/length);return 180*(this.y>0?1:-1)*rad/Math.PI}});return Vector.fromPoints=function(p1,p2){return new Vector(p2.x-p1.x,p2.y-p1.y)},require("core/class").extendClass(Point,{asVector:function(){return new Vector(this.x,this.y)}}),Vector}),define("graphic/view",["graphic/shapecontainer","graphic/container","core/utils","core/class","graphic/shape","graphic/viewbox","graphic/view"],function(require,exports,module){var ShapeContainer=require("graphic/shapecontainer"),ViewBox=require("graphic/viewbox");return require("core/class").createClass("View",{mixins:[ShapeContainer,ViewBox],base:require("graphic/view"),constructor:function(){this.callBase("view")}})}),define("graphic/viewbox",["core/class"],function(require,exports,module){return require("core/class").createClass("ViewBox",{getViewBox:function(){var attr=this.node.getAttribute("viewBox");return null===attr?{x:0,y:0,width:this.node.clientWidth||this.node.parentNode.clientWidth,height:this.node.clientHeight||this.node.parentNode.clientHeight}:(attr=attr.split(" "),{x:+attr[0],y:+attr[1],width:+attr[2],height:+attr[3]})},setViewBox:function(x,y,width,height){return this.node.setAttribute("viewBox",[x,y,width,height].join(" ")),this}})}),define("kity",["core/utils","core/class","core/browser","graphic/bezier","graphic/pointcontainer","graphic/path","graphic/bezierpoint","graphic/shapepoint","graphic/vector","graphic/circle","graphic/ellipse","graphic/clip","graphic/shape","graphic/shapecontainer","graphic/color","graphic/standardcolor","graphic/container","graphic/curve","graphic/point","graphic/gradientbrush","graphic/svg","graphic/defbrush","graphic/group","graphic/hyperlink","graphic/image","graphic/line","graphic/lineargradientbrush","graphic/mask","graphic/matrix","graphic/box","graphic/marker","graphic/resource","graphic/viewbox","graphic/palette","graphic/paper","graphic/eventhandler","graphic/styled","graphic/geometry","graphic/patternbrush","graphic/pen","graphic/polygon","graphic/poly","graphic/polyline","graphic/pie","graphic/sweep","graphic/radialgradientbrush","graphic/rect","graphic/regularpolygon","graphic/ring","graphic/data","graphic/star","graphic/text","graphic/textcontent","graphic/textspan","graphic/use","animate/animator","animate/timeline","animate/easing","animate/opacityanimator","animate/rotateanimator","animate/scaleanimator","animate/frame","animate/translateanimator","animate/pathanimator","animate/motionanimator","filter/filter","filter/effectcontainer","filter/gaussianblurfilter","filter/effect/gaussianblureffect","filter/projectionfilter","filter/effect/effect","filter/effect/colormatrixeffect","filter/effect/compositeeffect","filter/effect/offseteffect","filter/effect/convolvematrixeffect"],function(require,exports,module){var kity={},utils=require("core/utils");return kity.version="2.0.0",utils.extend(kity,{createClass:require("core/class").createClass,extendClass:require("core/class").extendClass,Utils:utils,Browser:require("core/browser"),Bezier:require("graphic/bezier"),BezierPoint:require("graphic/bezierpoint"),Circle:require("graphic/circle"),Clip:require("graphic/clip"),Color:require("graphic/color"),Container:require("graphic/container"),Curve:require("graphic/curve"),Ellipse:require("graphic/ellipse"),GradientBrush:require("graphic/gradientbrush"),Group:require("graphic/group"),HyperLink:require("graphic/hyperlink"),Image:require("graphic/image"),Line:require("graphic/line"),LinearGradientBrush:require("graphic/lineargradientbrush"),Mask:require("graphic/mask"),Matrix:require("graphic/matrix"),Marker:require("graphic/marker"),Palette:require("graphic/palette"),Paper:require("graphic/paper"),Path:require("graphic/path"),PatternBrush:require("graphic/patternbrush"),Pen:require("graphic/pen"),Point:require("graphic/point"),Polygon:require("graphic/polygon"),Polyline:require("graphic/polyline"),Pie:require("graphic/pie"),RadialGradientBrush:require("graphic/radialgradientbrush"),Rect:require("graphic/rect"),RegularPolygon:require("graphic/regularpolygon"),Ring:require("graphic/ring"),Shape:require("graphic/shape"),ShapePoint:require("graphic/shapepoint"),ShapeContainer:require("graphic/shapecontainer"),Sweep:require("graphic/sweep"),Star:require("graphic/star"),Text:require("graphic/text"),TextSpan:require("graphic/textspan"),Use:require("graphic/use"),Vector:require("graphic/vector"),g:require("graphic/geometry"),Animator:require("animate/animator"),Easing:require("animate/easing"),OpacityAnimator:require("animate/opacityanimator"),RotateAnimator:require("animate/rotateanimator"),ScaleAnimator:require("animate/scaleanimator"),Timeline:require("animate/timeline"),TranslateAnimator:require("animate/translateanimator"),PathAnimator:require("animate/pathanimator"),MotionAnimator:require("animate/motionanimator"),Filter:require("filter/filter"),GaussianblurFilter:require("filter/gaussianblurfilter"),ProjectionFilter:require("filter/projectionfilter"),ColorMatrixEffect:require("filter/effect/colormatrixeffect"),CompositeEffect:require("filter/effect/compositeeffect"),ConvolveMatrixEffect:require("filter/effect/convolvematrixeffect"),Effect:require("filter/effect/effect"),GaussianblurEffect:require("filter/effect/gaussianblureffect"),OffsetEffect:require("filter/effect/offseteffect")}),window.kity=kity}),function(){try{inc.use("kity")}catch(e){use("kity")}}()}();