!function(){"use strict";function setupCells(setup){return function(cells){var fieldValue;if(cells.getAttribute)fieldValue=setup(cells);else{fieldValue=setup(cells[0]);for(var i=1;i<cells.length;i++)if(setup(cells[i])!==fieldValue){fieldValue=null;break}}void 0!==fieldValue&&(this.setValue(fieldValue),CKEDITOR.env.gecko&&"select"==this.type&&!fieldValue&&(this.getInputElement().$.selectedIndex=-1))}}function addTranslation(lang,texts){CKEDITOR.skins?CKEDITOR.plugins.setLang("backgrounds",lang,{backgrounds:texts}):CKEDITOR.plugins.setLang("backgrounds",lang,texts)}CKEDITOR.plugins.add("backgrounds",{init:function(editor){editor.addFeature&&editor.addFeature({name:"background image",allowedContent:{"table td th":{propertiesOnly:!0,attributes:"background",styles:"background-repeat,background-position"}}}),editor.getColorFromDialog||(editor.getColorFromDialog=function(callback,scope){var onClose=function(evt){releaseHandlers(this);var color="ok"==evt.name?this.getValueOf("picker","selectedColor"):null;callback.call(scope,color)},releaseHandlers=function(dialog){dialog.removeListener("ok",onClose),dialog.removeListener("cancel",onClose)},bindToDialog=function(dialog){dialog.on("ok",onClose),dialog.on("cancel",onClose)};editor.execCommand("colordialog"),editor._.storedDialogs&&editor._.storedDialogs.colordialog?bindToDialog(editor._.storedDialogs.colordialog):CKEDITOR.on("dialogDefinition",function(e){if("colordialog"==e.data.name){var definition=e.data.definition;e.removeListener(),definition.onLoad=CKEDITOR.tools.override(definition.onLoad,function(orginal){return function(){bindToDialog(this),definition.onLoad=orginal,"function"==typeof orginal&&orginal.call(this)}})}})})}}),CKEDITOR.on("dialogDefinition",function(ev){var dialogName=ev.data.name,dialogDefinition=ev.data.definition,editor=ev.editor,tabName=(editor.plugins.colordialog,"");if("table"!=dialogName&&"tableProperties"!=dialogName||(tabName="advanced"),"cellProperties"==dialogName&&(tabName="info",dialogDefinition.minHeight+=80),""!=tabName){var tab=dialogDefinition.getContents(tabName),lang=editor.lang.backgrounds;if(tab){var textInput={type:"text",label:lang.label,id:"background",setup:setupCells(function(selectedElement){return selectedElement.getAttribute("background")}),commit:function(data,selectedElement){var element=selectedElement||data,value=this.getValue();value?element.setAttribute("background",value):element.removeAttribute("background")}},browseButton={type:"button",id:"browse",hidden:"true",filebrowser:{action:"Browse",target:tabName+":background",url:editor.config.filebrowserImageBrowseUrl||editor.config.filebrowserBrowseUrl},label:editor.lang.common.browseServer,requiredContent:textInput.requiredContent},backgroundPosition={type:"select",label:lang.position,id:"backgroundPosition",items:[[lang.left_top,"left top"],[lang.left_center,"left center"],[lang.left_bottom,"left bottom"],[lang.center_top,"center top"],[lang.center_center,"center center"],[lang.center_bottom,"center bottom"],[lang.right_top,"right top"],[lang.right_center,"right center"],[lang.right_bottom,"right bottom"]],setup:setupCells(function(selectedElement){return selectedElement.getStyle("background-position")}),onChange:function(){var stylesInput=this.getDialog().getContentElement("advanced","advStyles");stylesInput&&stylesInput.updateStyle("background-position",this.getValue())},commit:function(data,selectedElement){var element=selectedElement||data,value=this.getValue(),oBackground=this.getDialog().getContentElement(tabName,"background"),background=oBackground&&oBackground.getValue();value&&background?element.setStyle("background-position",value):element.removeStyle("background-position")}},backgroundRepeat={type:"select",label:lang.repeat,id:"backgroundRepeat",items:[[lang.repeatBoth,""],[lang.repeatX,"repeat-x"],[lang.repeatY,"repeat-y"],[lang.repeatNone,"no-repeat"]],setup:setupCells(function(selectedElement){return selectedElement.getStyle("background-repeat")}),onChange:function(){var stylesInput=this.getDialog().getContentElement("advanced","advStyles");stylesInput&&stylesInput.updateStyle("background-repeat",this.getValue())},commit:function(data,selectedElement){var element=selectedElement||data,value=this.getValue(),oBackground=this.getDialog().getContentElement(tabName,"background"),background=oBackground&&oBackground.getValue();value&&background?element.setStyle("background-repeat",value):element.removeStyle("background-repeat")}},backgroundColor={type:"hbox",padding:0,widths:["30px","20px"],id:"bgColor",children:[{type:"text",id:"backgroundColor",label:lang.color,default:"",setup:setupCells(function(element){var bgColorAttr=element.getAttribute("backgroundColor");return element.getStyle("background-color")||bgColorAttr}),onChange:function(){var stylesInput=this.getDialog().getContentElement("advanced","advStyles");stylesInput&&stylesInput.updateStyle("background-color",this.getValue())},commit:function(data,selectedElement){var element=selectedElement||data,value=this.getValue();value?element.setStyle("background-color",value):element.removeStyle("background-color")}},{type:"button",id:"bgColorChoose",label:lang.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","middle")},onClick:function(element){editor.getColorFromDialog(function(color){var stylesInput=this.getDialog().getContentElement("advanced","advStyles"),input=this.getDialog().getContentElement("advanced","backgroundColor");input.setValue(color),stylesInput&&color&&stylesInput.updateStyle("background-color",color),input.focus()},this)}}]},backgroundAttachment={type:"select",label:lang.attachment,id:"backgroundAttachment",items:[[lang.attachmentScroll,""],[lang.attachmentFixed,"fixed"],[lang.attachmentLocal,"local"]],setup:setupCells(function(selectedElement){return selectedElement.getStyle("background-attachment")}),onChange:function(){var stylesInput=this.getDialog().getContentElement("advanced","advStyles");stylesInput&&stylesInput.updateStyle("background-attachment",this.getValue())},commit:function(data,selectedElement){var element=selectedElement||data,value=this.getValue(),oBackground=this.getDialog().getContentElement(tabName,"background"),background=oBackground&&oBackground.getValue();value&&background?element.setStyle("background-attachment",value):element.removeStyle("background-attachment")}};"cellProperties"==dialogName?(textInput.requiredContent="td[background];th[background]",backgroundPosition.requiredContent="td[background];th[background]",backgroundRepeat.requiredContent="td[background];th[background]",backgroundColor.requiredContent="td[background];th[background]"):(textInput.requiredContent="table[background]",backgroundPosition.requiredContent="table[background]",backgroundRepeat.requiredContent="table[background]",backgroundColor.requiredContent="table[background]"),"advanced"==tabName?(tab.add(textInput),tab.add(browseButton),tab.add({type:"hbox",widths:["","100px"],children:[backgroundPosition,backgroundRepeat]}),tab.add({type:"hbox",widths:["50%","50%"],children:[backgroundAttachment,backgroundColor]})):(browseButton.style="display:inline-block;margin-top:10px;",tab.add({type:"hbox",widths:["","100px"],children:[textInput,browseButton],requiredContent:textInput.requiredContent}),tab.add({type:"hbox",widths:["","100px"],children:[backgroundPosition,backgroundRepeat]}))}}},null,null,9),addTranslation("en",{label:"Background image",position:"Background position",repeat:"Background repeat",color:"Background Color",chooseColor:"Choose",attachment:"Background Attachment",attachmentScroll:"Scroll",attachmentFixed:"Fixed",attachmentLocal:"Local",repeatBoth:"Repeat",repeatX:"Horizontally",repeatY:"Verticaly",repeatNone:"None",left_top:"Left Top",left_center:"Left Center",left_bottom:"Left Bottom",center_top:"Center Top",center_center:"Center Center",center_bottom:"Center Bottom",right_top:"Right Top",right_center:" Right Center",right_bottom:"Right Bottom"}),addTranslation("es",{label:"Imagen de fondo",position:"Posición del fondo",repeat:"Repetición del fondo",color:"Color de fondo",chooseColor:"Elegir",attachment:"Desplazamiento",attachmentScroll:"Scroll",attachmentFixed:"Fixed",attachmentLocal:"Local",repeatBoth:"Repetir",repeatX:"Horizontalmente",repeatY:"Verticalmente",repeatNone:"Ninguno",left_top:"Izquierda arriba",left_center:"Izquierda centro",left_bottom:"Izquierda abajo",center_top:"Centro arriba",center_center:"Centro centro",center_bottom:"Centro abajo",right_top:"Derecha arriba",right_center:" Derecha centro",right_bottom:"Derecha abajo"}),addTranslation("nl",{label:"Achtergrond afbeelding",position:"Achtergrond positie",repeat:"Achtergrond herhaling",color:"Background Color",chooseColor:"Choose",attachment:"Background Attachment",attachmentScroll:"Scroll",attachmentFixed:"Fixed",attachmentLocal:"Local",repeatBoth:"Herhalen",repeatX:"Horizontaal",repeatY:"Verticaal",repeatNone:"Geen",left_top:"Links Boven",left_center:"Links Midden",left_bottom:"Links Onder",center_top:"Centreren Boven",center_center:"Centreren Midden",center_bottom:"Centreren Onder",right_top:"Rechts Boven",right_center:" Rechts Midden",right_bottom:"Rechts Onder"}),addTranslation("ru",{label:"Фоновое изображение",position:"Позиция фона",repeat:"Повтор фона",color:"Цвет фона",chooseColor:"Выбрать",attachment:"Привязка фона",attachmentScroll:"Прокручивать со страницей (scroll)",attachmentFixed:"Фиксированная (fixed)",attachmentLocal:"Прокрутка с элементом (local)",repeatBoth:"Повтор",repeatX:"Горизонтально",repeatY:"Вертикально",repeatNone:"Без повтора",left_top:"Слева сверху",left_center:"Слева в центре",left_bottom:"Слева снизу",center_top:"По центру, сверху",center_center:"По центру",center_bottom:"По центру, снизу",right_top:"Справа сверху",right_center:"Справа в центре",right_bottom:"Справа снизу"}),addTranslation("uk",{label:"Фонове зображення",position:"Позиція фону",repeat:"Повтор фону",color:"Колір фону",chooseColor:"Обрати",attachment:"Прив'язка фона",attachmentScroll:"Прокручувати зі сторінкою (scroll)",attachmentFixed:"Фіксована (fixed)",attachmentLocal:"Прокручувати із елементом (local)",repeatBoth:"Повтор",repeatX:"Горизонтально",repeatY:"Вертикально",repeatNone:"Без повтору",left_top:"Зліва згори",left_center:"Зліва посередині",left_bottom:"Зліва знизу",center_top:"По центру, зверху",center_center:"По центру",center_bottom:"По центру, знизу",right_top:"Справа згори",right_center:"Справа посередині",right_bottom:"Справа знизу"})}();