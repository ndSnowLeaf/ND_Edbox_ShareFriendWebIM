"use strict";var NodeHTTPParser=process.binding("http_parser").HTTPParser,version=NodeHTTPParser.RESPONSE?6:4,HttpParser=function(e){this._parser=new NodeHTTPParser("request"===e?NodeHTTPParser.REQUEST||"request":NodeHTTPParser.RESPONSE||"response"),this._type=e,this._complete=!1,this.headers={};var r=null,t=this;this._parser.onHeaderField=function(e,t,s){r=e.toString("utf8",t,t+s).toLowerCase()},this._parser.onHeaderValue=function(e,s,o){var a=e.toString("utf8",s,s+o);t.headers.hasOwnProperty(r)?t.headers[r]+=", "+a:t.headers[r]=a},this._parser.onHeadersComplete=this._parser[NodeHTTPParser.kOnHeadersComplete]=function(e,r,s,o,a,P){var p=arguments[0];if("object"==typeof p&&(o=p.method,a=p.url,P=p.statusCode,s=p.headers),t.method="number"==typeof o?HttpParser.METHODS[o]:o,t.statusCode=P,t.url=a,s){for(var n,i,T=0,h=s.length;T<h;T+=2)n=s[T].toLowerCase(),i=s[T+1],t.headers.hasOwnProperty(n)?t.headers[n]+=", "+i:t.headers[n]=i;t._complete=!0}}};HttpParser.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"REPORT",17:"MKACTIVITY",18:"CHECKOUT",19:"MERGE",24:"PATCH"},HttpParser.prototype.isComplete=function(){return this._complete},HttpParser.prototype.parse=function(e){var r=version<6?1:0,t=this._parser.execute(e,0,e.length)+r;this._complete&&(this.body=t<e.length?e.slice(t):new Buffer(0))},module.exports=HttpParser;