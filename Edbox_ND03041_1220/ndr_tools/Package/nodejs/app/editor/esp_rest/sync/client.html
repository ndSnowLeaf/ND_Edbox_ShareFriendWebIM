<!doctype html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><title>WebSocket test</title></head><body><h1>WebSocket test</h1><ul></ul>输入要发送的消息:<br>例如：{"eventName":"closeTool","eventData":{"syncId":"1111","toolKey":"la"}}<br><input style="width: 80%" id="in" type="text"><br><button onclick="send()">send</button><br><br><button onclick="addTool()">addTool</button> <button onclick="updateTool()">updateTool</button> <button onclick="closeTool()">closeTool</button><script></script><script type="text/javascript">function addTool(){var o=document.getElementById("in");console.log(o.value),socket.send(JSON.stringify({eventName:"addTool",eventData:{syncId:"1111",toolKey:"lalala",toolState:{a:1}}}))}function updateTool(){var o=document.getElementById("in");console.log(o.value),socket.send(JSON.stringify({eventName:"updateTool",eventData:{syncId:"1111",toolKey:"lalala",updateInfo:{b:2},toolState:{a:1}}}))}function closeTool(){socket.send(JSON.stringify({eventName:"closeTool",eventData:{syncId:"1111",toolKey:"la"}}))}function send(){var o=document.getElementById("in").value;console.log("发送消息"+o),socket.send(o)}var logger=document.getElementsByTagName("ul")[0],Socket=window.MozWebSocket||window.WebSocket,socket=new Socket("ws://"+location.hostname+":"+location.port+"/"),index=0,log=function(o){logger.innerHTML+="<li>"+o+"</li>"};socket.addEventListener("open",function(){log("OPEN: "+socket.protocol)}),socket.onerror=function(o){log("ERROR: "+o.message)},socket.onmessage=function(o){log("MESSAGE: "+o.data)},socket.onclose=function(o){log("CLOSE: "+o.code+", "+o.reason)}</script></body></html>