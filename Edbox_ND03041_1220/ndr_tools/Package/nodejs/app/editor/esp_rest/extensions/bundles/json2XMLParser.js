function isGeneralTool(e){return generalToolsList.indexOf(e)>-1}function convertQuestionType(e){return COMMON_QUESTION_CONFIG[e]?QT_COMMON:e}function getInteractionHints(e){var t={};return e.interaction_hints&&(t.hints=e.interaction_hints),t}function generateMainXMLContent(e,t,n){return e.replace(/\$\{uuid\}/g,t).replace("${timestamp}",n)}function textSelectParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/textSelects.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/textSelects.json?v="+a),o={};o.id=t.id,o.prompt=t.prompt,o.skin={code:"wood",css_url:"",name:"木纹",package_url:""},o.timer=t.timer,o.title=t.title;var c=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"textSelects.json",content:JSON.stringify(o)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(c)}),n}function magicBoxParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/magicBox.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/magicBox.json?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"magicBox.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function wordPuzzleParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/wordPuzzle.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/wordPuzzle.json?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"wordPuzzle.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function comicdialogueParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/comicdialogue.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/comicdialogue.json?v="+a);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"comicdialogue.json",content:JSON.stringify(t)}),n}function fillBlankParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/fillblank.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/fillblank.json?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"fillblank.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function guessWordParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/guessword.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/guessword.json?v="+a).replace("${resourcePath}","resources"),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"guessword.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function pointSequencingParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/pointsequencing.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/pointsequencing.json?v="+a).replace("${resourcePath}","resources"),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"pointsequencing.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function compareParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${question_title}",t.title).replace("${skin}","").replace("${question_url}","../resources/compare.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/compare.json?v="+a).replace("${questionPath}","resources"),o=getInteractionHints(t);n.main=i,n.page=s,n.sdp_package=p;var c=t.items;return n.extend_files.push({name:"compare.json",content:JSON.stringify(c)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function arithmeticParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${question_title}",t.title).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/arithmetic.xml?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/arithmetic.json?v="+a).replace("${questionPath}","resources"),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"arithmetic.xml",content:covertArithmeticJSONtoXml(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function covertArithmeticJSONtoXml(e){var t=(new DOMImplementation).createDocument("","",null),n=t.createProcessingInstruction("xml",'version="1.0" encoding="utf-8"');t.appendChild(n);var r=t.createElement("assessmentItem");r.setAttribute("xmlns","http://www.imsglobal.org/xsd/imsqti_v2p1"),r.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),r.setAttribute("identifier",""),r.setAttribute("title","ND竖式计算题"),r.setAttribute("adaptive","false"),r.setAttribute("timeDependent","false"),r.setAttribute("xsi:schemaLocation","http://www.imsglobal.org/xsd/imsqti_v2p1 http://www.imsglobal.org/xsd/imsqti_v2p1.xsd");var a=0,i="RESPONSE_1-";if(e.prompt){var s=t.createElement("itemBody"),p=t.createElement("div");p.setAttribute("questionType","data");var o=t.createElement("div");if(e.prompt.operator&&"/"==e.prompt.operator.operator){var c=t.createElement("div");if(c.setAttribute("type","result"),e.prompt.number_result){for(var l=e.prompt.number_result.items,d=0;d<l.length;d++)if(l[d].dot_show||"."!=l[d].num)if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),c.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);c.appendChild(f)}o.appendChild(c)}}var v=t.createElement("div");if(v.setAttribute("type","first"),e.prompt.number_first){for(var l=e.prompt.number_first.items,k=!1,d=0;d<l.length;d++)if((l[d].dot_show||"."!=l[d].num)&&!(l[d].dot_show&&k||l[d].dashed&&"."!==l[d].num)){if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),v.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);v.appendChild(f)}1==l[d].dot_show&&1==l[d].dashed&&(k=!0)}o.appendChild(v)}var $=t.createElement("div");if($.setAttribute("type","operator"),e.prompt.operator){var h=t.createTextNode(e.prompt.operator.operator);$.appendChild(h),o.appendChild($)}var b=t.createElement("div");if(b.setAttribute("type","second"),e.prompt.number_second){for(var l=e.prompt.number_second.items,d=0;d<l.length;d++)if(l[d].dot_show||"."!=l[d].num)if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),b.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);b.appendChild(f)}o.appendChild(b)}var C=t.createElement("div");if(C.setAttribute("type","procedure"),e.prompt.procedure){for(var x=e.prompt.procedure,O=0;O<x.length;O++){var P=t.createElement("div");P.setAttribute("offset",x[O].offset);for(var l=x[O].items,d=0;d<l.length;d++)if(l[d].dot_show||"."!=l[d].num)if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),P.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);P.appendChild(f)}C.appendChild(P)}o.appendChild(C)}if(e.prompt.operator&&"/"!=e.prompt.operator.operator){var c=t.createElement("div");if(c.setAttribute("type","result"),e.prompt.number_result){for(var l=e.prompt.number_result.items,d=0;d<l.length;d++)if(l[d].dot_show||"."!=l[d].num)if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),c.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);c.appendChild(f)}o.appendChild(c)}}var y=t.createElement("div");if(y.setAttribute("type","remainder"),e.prompt.remainder){var P=t.createElement("div");P.setAttribute("offset",e.prompt.remainder.offset.left_blank);for(var l=e.prompt.remainder.items,d=0;d<l.length;d++)if(l[d].dot_show||"."!=l[d].num)if(l[d].hide){var m=t.createElement("textEntryInteraction");m.setAttribute("responseIdentifier",i+ ++a),m.setAttribute("keyboard","number"),P.appendChild(m);var u=t.createElement("responseDeclaration");u.setAttribute("identifier",i+a),u.setAttribute("cardinality","single"),u.setAttribute("baseType","multipleString"),u.setAttribute("sequence","1-"+a);var _=t.createElement("correctResponse"),g=t.createElement("value"),h=t.createTextNode(l[d].num);g.appendChild(h),_.appendChild(g),u.appendChild(_),r.appendChild(u)}else{var f=t.createTextNode(l[d].num);P.appendChild(f)}y.appendChild(P),o.appendChild(y)}p.appendChild(o),s.appendChild(p),r.appendChild(s)}var I=t.createElement("outcomeDeclaration");I.setAttribute("identifier","SCORE"),I.setAttribute("cardinality","single"),I.setAttribute("baseType","float");var T=t.createElement("defaultValue"),g=t.createElement("value"),h=t.createTextNode("0.0");g.appendChild(h),T.appendChild(g),I.appendChild(T);var S=t.createElement("responseProcessing");S.setAttribute("template","http://www.imsglobal.org/question/qti_v2p1/rptemplates/match_correct");var E=t.createElement("modalFeedback");E.setAttribute("showHide","show"),E.setAttribute("outcomeIdentifier","FEEDBACK"),E.setAttribute("identifier","showHint"),E.setAttribute("sequence","1");var A=t.createElement("modalFeedback");return A.setAttribute("showHide","show"),A.setAttribute("outcomeIdentifier","FEEDBACK"),A.setAttribute("identifier","showHint"),A.setAttribute("sequence","1"),r.appendChild(I),r.appendChild(S),r.appendChild(E),r.appendChild(A),t.appendChild(r),(new XMLSerializer).serializeToString(t)}function classifiedParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/classified.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/classified.json?v="+a).replace("${resourcePath}","resources"),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"classified.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function imageMarkParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${question_url}","../resources/imagemark.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/imagemark.json?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"imagemark.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function orderParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/item.xml?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/item.xml?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"item.xml",content:itemParser.generateOrder(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function tableParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_url}","../resources/item.xml?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),p=r.sdp_package.replace("${skinPath}","../resources/item.xml?v="+a),o=getInteractionHints(t);return n.main=i,n.page=s,n.sdp_package=p,n.extend_files.push({name:"item.xml",content:itemParser.generateTable(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(o)}),n}function orderMemorycard(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i="p2p";switch(t.module_subtype){case"image2text":i="p2w";break;case"image2image":i="p2p";break;case"text2text":i="w2w"}var s=generateMainXMLContent(r.main,t.id,a),p=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_type}",i).replace("${question_url}","../resources/item.xml?v="+a).replace("${spirit_root}","${ref-path}/memorycard/spirit_root").replace("${hint_url}","../resources/hint.json?v="+a),o=r.sdp_package.replace("${questionPath}","resources"),c=getInteractionHints(t),l=itemParser.generateLinkup(t);return n.main=s,n.page=p,n.sdp_package=o,n.extend_files.push({name:"item.xml",content:l}),n.extend_files.push({name:"hint.json",content:JSON.stringify(c)}),n}function linkupParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i="p2p";switch(t.module_subtype){case"image2text":i="p2w";break;case"image2image":i="p2p";break;case"text2text":i="w2w"}var s=generateMainXMLContent(r.main,t.id,a),p=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${question_type}",i).replace("${question_url}","../resources/item.xml?v="+a).replace("${spirit_root}","${ref-path}/linkup/spirit_root").replace("${hint_url}","../resources/hint.json?v="+a),o=r.sdp_package.replace("${questionPath}","resources"),c=itemParser.generateLinkup(t),l=getInteractionHints(t);return n.main=s,n.page=p,n.sdp_package=o,n.extend_files.push({name:"item.xml",content:c}),n.extend_files.push({name:"hint.json",content:JSON.stringify(l)}),n}function fractionParse(e,t){var n={main:"",page:"",sdp_package:"",extend_files:[]},r=JSON.parse(e),a=(new Date).valueOf(),i=generateMainXMLContent(r.main,t.id,a),s="p2p";switch(t.module_subtype){case"image2text":s="p2w";break;case"image2image":s="p2p";break;case"text2text":s="w2w"}var p=r.page.replace("${question_id}",t.id).replace("${skin}","").replace("${timer_type}",t.timer.timer_type).replace("${time_limit}",60*t.timer.time_minute+parseInt(t.timer.time_second)).replace("${questionType}",s).replace("${question_url}","../resources/fraction.json?v="+a).replace("${hint_url}","../resources/hint.json?v="+a),o=r.sdp_package.replace("${skinPath}","../resources/fraction.json?v="+a).replace("${questionPath}","resources"),c=getInteractionHints(t);return n.main=i,n.page=p,n.sdp_package=o,n.extend_files.push({name:"fraction.json",content:JSON.stringify(t)}),n.extend_files.push({name:"hint.json",content:JSON.stringify(c)}),n}function commonParse(e,t,n){var r={main:"",page:"",sdp_package:"",extend_files:[]},a=JSON.parse(e),i=(new Date).valueOf(),s=COMMON_QUESTION_CONFIG[n],p=generateMainXMLContent(a.main,t.id,i),o=a.page.replace(/\$\{addonId\}/g,s.addonId).replace("${skin}","").replace("${question_id}",t.id).replace("${question_url}","../resources/item.json?v="+i).replace("${hint_url}","../resources/hint.json?v="+i),c=a.sdp_package.replace("${skinPath}",s.skinPath||""),l="";if(t.packages)for(var d="<add type='${type}' src='${src}' />",m=0;m<t.packages.length;m++){var u=t.packages[m];l+=d.replace("${type}",u.type).replace("${src}",u.src)}c.replace("${resourcePath}",l);var _=getInteractionHints(t);return r.main=p,r.page=o,r.sdp_package=c,r.extend_files.push({name:"item.json",content:JSON.stringify(t)}),r.extend_files.push({name:"hint.json",content:JSON.stringify(_)}),r}function mindjetParse(e,t,n){var r={main:"",page:"",sdp_package:"",extend_files:[]},a=JSON.parse(e),i=(new Date).valueOf(),s=generateMainXMLContent(a.main,n,i),p=a.page.replace("${questionId}",n).replace("${questionData}","../resources/mindjet.json?v="+i);return r.main=s,r.page=p,r.sdp_package=a.sdp_package,r.extend_files.push({name:"mindjet.json",content:JSON.stringify(t)}),r}function graphicsCuttingParse(e,t,n){return generalToolParse(e,t,n,"GraphicsCutting")}function generalToolParse(e,t,n,r){var a={main:"",page:"",sdp_package:"",extend_files:[]},i=JSON.parse(e),s=(new Date).valueOf(),p=generateMainXMLContent(i.main,n,s),o=i.page.replace("${question_id}",n).replace("${question_url}","../resources/"+r+".json?v="+s).replace(/\$\{addon_id\}/g,r);return a.main=p,a.page=o,a.sdp_package=i.sdp_package,a.extend_files.push({name:r+".json",content:JSON.stringify(t)}),a}function loadTemplate(e){var t=FileSys.readFileSync(PathSys.join(__dirname,"./tmpls/courseware-object/"+e+".tmpl.json"));return t?t.toString():null}var FileSys=require("fs"),PathSys=require("path"),DOMImplementation=require("xmldom2").DOMImplementation,XMLSerializer=require("xmldom2").XMLSerializer,itemXml=require("./itemXMLParser"),itemParser=new itemXml.itemXMLParser.Parser,QT_COMMON="common",QT_GENERAL_TOOL="general-tool",QT_TEXT_SELECT="text-select",QT_MAGIC_BOX="magic-box",QT_WORD_PUZZLE="word-puzzle",QT_FILL_BLANK="fill-blank",QT_GUESS_WORD="guess-word",QT_POINT_SEQUENCING="point-sequencing",QT_COMPARE="compare",QT_IMAGE_MARK="image-mark",QT_ARITHMETIC="arithmetic",QT_CLASSIFIED="classified",QT_ORDER="order",QT_TABLE="table",QT_MEMORYCARD="memory-card",QT_LINKUP="linkup",QT_FRACTION="fraction",QT_COMICDIALOGUE="comicdialogue",QT_SPELLPOEM="spellpoem",QT_MINDJET="mindjet",QT_GRAPHICS_CUTTING="graphicscutting",COMMON_QUESTION_CONFIG={probabilitycard:{addonId:"ProbabilityCard",skin:"",skinPath:""},catchball:{addonId:"CatchBall",skin:"",skinPath:""},balance:{addonId:"Balance",skin:"",skinPath:""},planting:{addonId:"Planting",skin:"",skinPath:""},clock:{addonId:"ClockThree",skin:"",skinPath:""},lego:{addonId:"Lego",skin:"",skinPath:""},openshapetool:{addonId:"OpenShapeTool",skin:"",skinPath:""},puzzle:{addonId:"Three2DPuzzle",skin:"",skinPath:""},mathaxis:{addonId:"MathAxis",skin:"",skinPath:""},spellpoem:{addonId:"SpellPoem",skin:"",skinPath:""},intervalproblem:{addonId:"IntervalProblem",skin:"",skinPath:""},counter:{addonId:"Counter",skin:"",skinPath:""},abacus:{addonId:"Abacus",skin:"",skinPath:""},makeword:{addonId:"MakeWord",skin:"",skinPath:""},sentence_evaluat:{addonId:"SentenceEvaluating",skin:"",skinPath:""},section_evaluating:{addonId:"SectionEvaluating",skin:"",skinPath:""},"highlight-mark":{addonId:"HighlightMark",skin:"",skinPath:""},speechevaluating:{addonId:"SpeechEvaluating",skin:"",skinPath:""}},generalToolsList=[QT_GRAPHICS_CUTTING],parser=function(e,t,n){var r,a;switch(isGeneralTool(e)?(r=e,a=loadTemplate(QT_GENERAL_TOOL)):(r=convertQuestionType(e),a=loadTemplate(r)),r){case QT_TEXT_SELECT:return textSelectParse(a,n);case QT_MAGIC_BOX:return magicBoxParse(a,n);case QT_WORD_PUZZLE:return wordPuzzleParse(a,n);case QT_FILL_BLANK:return fillBlankParse(a,n);case QT_GUESS_WORD:return guessWordParse(a,n);case QT_POINT_SEQUENCING:return pointSequencingParse(a,n);case QT_COMPARE:return compareParse(a,n);case QT_ARITHMETIC:return arithmeticParse(a,n);case QT_CLASSIFIED:return classifiedParse(a,n);case QT_IMAGE_MARK:return imageMarkParse(a,n);case QT_ORDER:return orderParse(a,n);case QT_TABLE:return tableParse(a,n);case QT_MEMORYCARD:return orderMemorycard(a,n);case QT_LINKUP:return linkupParse(a,n);case QT_FRACTION:return fractionParse(a,n);case QT_COMMON:return commonParse(a,n,e);case QT_COMICDIALOGUE:return comicdialogueParse(a,n);case QT_MINDJET:return mindjetParse(a,n,t);case QT_GRAPHICS_CUTTING:return graphicsCuttingParse(a,n,t);default:return null}};exports.parser=parser;