define("intervalproblem/directive/interval-item/interval-item",["angularAMD"],function(angularAMD){angularAMD.directive("intervalItem",[function(){return{restrict:"E",replace:!0,templateUrl:"interaction/intervalproblem/directive/interval-item/interval-item.html",scope:{itemData:"=itemData",itemsData:"=itemsData",index:"=index",errorModel:"=errorModel"},controller:["$scope","$rootScope","$timeout","$filter",function($scope,$rootScope,$timeout,$filter){$scope.itemData.min.preNum=$scope.itemData.min.num,$scope.itemData.max.preNum=$scope.itemData.max.num,$scope.switchBraces=function($event,data,type){switch(type){case 0:case 1:if(""===data.num)return;"0"===data.contain?data.contain="1":data.contain="0";break;case 2:"0"===data.addType?data.addType="1":data.addType="0"}},$scope.addInteval=function(){$scope.itemsData.push({min:{num:"",contain:"0"},max:{num:"",contain:"0"},addType:"0"})},$scope.change=function(data){data.num=$.trim(data.num),$scope.isNum(data.num)?(""!==data.num&&(data.num=1*data.num),data.preNum=data.num):"-"===data.num?data.preNum=data.num:($scope.errorModel.errorText=$filter("translate")("interval.validation.msg1"),data.num=data.preNum)},$scope.isNum=function(num){if(""===num)return!0;var r=new RegExp("^-?\\d+$");return!!r.test(num)&&!(-20>num||num>20)},$scope.blur=function(data){data.num=$.trim(data.num),$scope.isNum(data.num)||($scope.errorModel.errorText=$filter("translate")("interval.validation.msg1"),data.num="",data.preNum=""),""===data.num&&(data.contain="0")},$scope.deleteItem=function(){var next=$scope.itemsData[$scope.index+1];0===$scope.index&&next&&(next.addType=""),$scope.itemsData.splice($scope.index,1)}}]}}])});var AddonIntervalProblem_create=function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _appPresenter=__webpack_require__(1),_appPresenter2=_interopRequireDefault(_appPresenter);exports.default=function(){return _appPresenter2.default},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenterRun=__webpack_require__(2),_presenterRun2=_interopRequireDefault(_presenterRun),_presenterSetState=__webpack_require__(34),_presenterSetState2=_interopRequireDefault(_presenterSetState),_presenterGetState=__webpack_require__(35),_presenterGetState2=_interopRequireDefault(_presenterGetState),_presenterSetBasePath=__webpack_require__(36),_presenterSetBasePath2=_interopRequireDefault(_presenterSetBasePath),_presenterDestroy=__webpack_require__(37),_presenterDestroy2=_interopRequireDefault(_presenterDestroy),_presenterGetQuestionInfo=__webpack_require__(38),_presenterGetQuestionInfo2=_interopRequireDefault(_presenterGetQuestionInfo),_presenterSetPlayerController=__webpack_require__(39),_presenterSetPlayerController2=_interopRequireDefault(_presenterSetPlayerController),_presenterOnEventReceived=__webpack_require__(40),_presenterOnEventReceived2=_interopRequireDefault(_presenterOnEventReceived),_presenterPageShow=__webpack_require__(41),_presenterPageShow2=_interopRequireDefault(_presenterPageShow),_presenterRuntime=__webpack_require__(6),_presenterPreviewAnswerJs=__webpack_require__(42),_presenterPreviewAnswerJs2=_interopRequireDefault(_presenterPreviewAnswerJs),_presenterSendEventToCalc=__webpack_require__(18),_presenterSendEventToCalc2=_interopRequireDefault(_presenterSendEventToCalc),_presenterSendEventToState=__webpack_require__(43),_presenterSendEventToState2=_interopRequireDefault(_presenterSendEventToState),_presenterSetUrlParams=__webpack_require__(44),_presenterSetUrlParams2=_interopRequireDefault(_presenterSetUrlParams),_presenterSubmitControl=__webpack_require__(17),_presenterTimer=__webpack_require__(19);exports.default={run:_presenterRun2.default,destroy:_presenterDestroy2.default,setState:_presenterSetState2.default,getState:_presenterGetState2.default,setBasePath:_presenterSetBasePath2.default,getQuestionInfo:_presenterGetQuestionInfo2.default,setPlayerController:_presenterSetPlayerController2.default,onEventReceived:_presenterOnEventReceived2.default,initTeacherMobile:_presenterRuntime.initTeacherMobile,initStudentMobile:_presenterRuntime.initStudentMobile,initWeb:_presenterRuntime.initWeb,initTeacherPc:_presenterRuntime.initTeacherPc,pageShow:_presenterPageShow2.default,previewAnswer:_presenterPreviewAnswerJs2.default,sendEventToCalc:_presenterSendEventToCalc2.default,sendEventToState:_presenterSendEventToState2.default,setUrlParams:_presenterSetUrlParams2.default,getResult:_presenterSubmitControl.getResult,getAnswerContent:_presenterSubmitControl.getAnswerContent,getI18n:_presenterSubmitControl.getI18n,getWrongPopup:_presenterSubmitControl.getWrongPopup,registerTimer:_presenterTimer.registerTimer,syncTime:_presenterTimer.syncTime},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenterLogic=__webpack_require__(3),_presenterLogic2=_interopRequireDefault(_presenterLogic);exports.default=function(view,model){(0,_presenterLogic2.default)(view,model,!1)},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=(__webpack_require__(4),__webpack_require__(1)),_presenter2=_interopRequireDefault(_presenter),_moduleControl=__webpack_require__(15),_runtime=__webpack_require__(6),interval=(_interopRequireDefault(_runtime),void 0);exports.interval=interval,exports.default=function(view,model,isPreview){_presenter2.default.model=model,_presenter2.default.view=view;var $imgs=$(view).find("img");$imgs.each(function(){$(this).attr("src",_presenter2.default.path+$(this).attr("data-src"))}),(_presenter2.default.isTeacherPc||_presenter2.default.isPPTShell)&&$(view).find(".com_layout").addClass("layout_whiteboard"),(0,_moduleControl.moduleStart)()}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function initThree(){resizeThree();var container=$(_presenter2.default.view).find(".interval_show").get(0);exports.renderer=renderer=(0,_UtilsAutoDetectRenderer.autoDetectRenderer)({antialias:!0,alpha:!0}),renderer.setClearColor(16777215,0),renderer.setSize(_constants.REAL_ESTATE.width,_constants.REAL_ESTATE.height),container.appendChild(renderer.domElement)}function initScene(){exports.scene=scene=new THREE.Scene}function initCamera(){var RATIO=2;exports.camera=camera=new THREE.OrthographicCamera(_constants.REAL_ESTATE.width/-RATIO,_constants.REAL_ESTATE.width/RATIO,_constants.REAL_ESTATE.height/RATIO,_constants.REAL_ESTATE.height/-RATIO,-2e4,2e4),camera.position.x=0,camera.position.y=0,camera.position.z=500,camera.lookAt({x:0,y:0,z:0})}function initRaycaster(){exports.raycaster=raycaster=new THREE.Raycaster,raycaster.linePrecision=1,exports.intersectObjs=intersectObjs=new Array,exports.mouse=mouse=new THREE.Vector2}function initControllerTool(){var planeXY=new THREE.Mesh(new THREE.PlaneBufferGeometry(_constants.REAL_ESTATE.width,_constants.REAL_ESTATE.height,2,2),new THREE.MeshBasicMaterial({color:16711680,transparent:!0,opacity:0}));planeXY.name="boundary",scene.add(planeXY)}function initNumberAXIS(){var numberAxis=(new _ShapeNumberAxis2.default).creatNumberAxis();scene.add(numberAxis),(0,_UtilsAddCoordScale2.default)(scene)}function animate(){currenAnimate=requestAnimationFrame(animate),render()}function render(){renderer.render(scene,camera)}function threeStart(){initThree(),initCamera(),initScene(),initRaycaster(),animate(),initControllerTool(),initNumberAXIS()}function resizeThree(){var $show=$(_presenter2.default.view).find(".interval_show"),offset=$show[0].getBoundingClientRect();_constants.REAL_ESTATE.offsetLeft=offset.left,_constants.REAL_ESTATE.offsetTop=offset.top,_constants.REAL_ESTATE.width=$show.width(),_constants.REAL_ESTATE.height=$show.height(),(0,_constants.updataNumberAxisConstData)(_constants.REAL_ESTATE.width-50)}function destroyThree(){(0,_UtilsDestroyThreeObjectJs2.default)(camera),(0,_UtilsDestroyThreeObjectJs2.default)(scene),(0,_UtilsDestroyThreeObjectJs2.default)(renderer),$(renderer.domElement).remove(),$(renderer.domElement).splice(0),$(renderer.domElement)[0]=null,exports.renderer=renderer=null,exports.camera=camera=null,exports.mouse=mouse=null,exports.scene=scene=null,exports.raycaster=raycaster=null,exports.intersectObjs=intersectObjs=null,cancelAnimationFrame(currenAnimate)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.threeStart=threeStart,exports.resizeThree=resizeThree,exports.destroyThree=destroyThree;var renderer,scene,camera,raycaster,intersectObjs,mouse,currenAnimate,_constants=__webpack_require__(5),_presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_UtilsDestroyThreeObjectJs=__webpack_require__(7),_UtilsDestroyThreeObjectJs2=_interopRequireDefault(_UtilsDestroyThreeObjectJs),_ShapeNumberAxis=__webpack_require__(8),_ShapeNumberAxis2=_interopRequireDefault(_ShapeNumberAxis),_UtilsAddCoordScale=__webpack_require__(11),_UtilsAddCoordScale2=_interopRequireDefault(_UtilsAddCoordScale),_UtilsAutoDetectRenderer=__webpack_require__(14);exports.renderer=renderer,exports.scene=scene,exports.camera=camera,exports.raycaster=raycaster,exports.intersectObjs=intersectObjs,exports.mouse=mouse},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getDeleteMaterial(){if(!deleteMaterial){var loader=new THREE.TextureLoader;loader.setCrossOrigin("anonymous");var texture=loader.load(_presenter2.default.path+"resources/delete.png");deleteMaterial=new THREE.MeshBasicMaterial({map:texture,transparent:!0,overdraw:.5})}return deleteMaterial}function updataNumberAxisConstData(NumberAxisWidth){NumberAxisConstData.numberAxisWidth=NumberAxisWidth,NumberAxisConstData.scaleCount=NumberOfScale,NumberAxisConstData.scaleLineHalfLength=NumberAxisWidth/2-20,NumberAxisConstData.scaleMargin=2*(NumberAxisWidth/2-20)/NumberOfScale}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDeleteMaterial=getDeleteMaterial,exports.updataNumberAxisConstData=updataNumberAxisConstData;var _runtime=__webpack_require__(6),_presenter=(_interopRequireDefault(_runtime),__webpack_require__(1)),_presenter2=_interopRequireDefault(_presenter),REAL_ESTATE={width:1e3,height:200,offsetLeft:0,offsetTop:500};exports.REAL_ESTATE=REAL_ESTATE;var ACTION_TYPE={add:"add",changePoint:"change",changeInter:"changeInter",intervalRect:"intervalRect",deleteInterval:"deleteInterval"};exports.ACTION_TYPE=ACTION_TYPE;var deleteMaterial=void 0,NumberAxisWidth=900;exports.NumberAxisWidth=NumberAxisWidth;var NumberAxisHeight=4;exports.NumberAxisHeight=NumberAxisHeight;var NumberOfScale=43;exports.NumberOfScale=NumberOfScale;var NumberAxisConstData={numberAxisWidth:NumberAxisWidth,scaleCount:NumberOfScale,scaleLineHalfLength:NumberAxisWidth/2-20,scaleMargin:2*(NumberAxisWidth/2-20)/NumberOfScale,numberAxisHeight:NumberAxisHeight};exports.NumberAxisConstData=NumberAxisConstData;var CoordScaleWidth={small:2,big:3};exports.CoordScaleWidth=CoordScaleWidth;var CoordScaleHeight={small:6,big:20};exports.CoordScaleHeight=CoordScaleHeight;var IntervalObjNames={Line:"Line",Endpoint1:"Endpoint1",Endpoint2:"Endpoint2",SoildCircle:"SoildCircle",EmptyCircle:"EmptyCircle",LeftTriangle:"LeftTriangle",RightTriangle:"RightTriangle",CoordScaleName:"CoordScale",Arrow:"Arrow",AreaGroup:"AreaGroup",EndPointShow:"EndPointShow",IntervalRect:"IntervalRect",IntervalLine:"IntervalLine",DeleteBtn:"DeleteBtn",DotCircle:"DotCircle"};exports.IntervalObjNames=IntervalObjNames;var StatusIndex={SoildCircle:0,EmptyCircle:1,Triangle:2};exports.StatusIndex=StatusIndex;var SelectBox={Height:4*NumberAxisHeight,Width:1.8*NumberAxisHeight,IntervaleRectHeight:8*NumberAxisHeight};exports.SelectBox=SelectBox;var CircleRadius={soild:1.8*NumberAxisHeight,empty:1.2*NumberAxisHeight,triangleSideLength:2.5*NumberAxisHeight};exports.CircleRadius=CircleRadius;var Color={normal:13311775,delete:16508824,emptyCircle:16777215,numberAxis:5714438,numberText:"#573206"};exports.Color=Color;var DeleteBtnY=40;exports.DeleteBtnY=DeleteBtnY;var ZOriginIndex={endpoint:5,intervalRect:2,intervalGroup:1};exports.ZOriginIndex=ZOriginIndex},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function initTeacherMobile(){_presenter2.default.isTeacherMobile=!0}function initStudentMobile(){_presenter2.default.isStudentMobile=!0}function initProjectionMobile(){_presenter2.default.isProjectionMobile=!0}function initWeb(){_presenter2.default.isWeb=!0}function initTeacherPc(){_presenter2.default.isTeacherPc=!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initTeacherMobile=initTeacherMobile,exports.initStudentMobile=initStudentMobile,exports.initProjectionMobile=initProjectionMobile,exports.initWeb=initWeb,exports.initTeacherPc=initTeacherPc;var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default={initTeacherMobile:initTeacherMobile,initStudentMobile:initStudentMobile,initProjectionMobile:initProjectionMobile,initWeb:initWeb,initTeacherPc:initTeacherPc}},function(module,exports){"use strict";function destroyThreeObject(object){if(object){if(object.children&&object.children.length>0)for(var i=0;i<object.children.length;i++)destroyThreeObject(object.children[i]);object.geometry&&object.geometry.dispose(),object.material&&(object.material.dispose(),object.material.map&&object.material.map.dispose&&object.material.map.dispose()),object=null}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=destroyThreeObject,module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_UtilsUpdateVertices=__webpack_require__(9),_UtilsUpdateVertices2=_interopRequireDefault(_UtilsUpdateVertices),_UtilsRotateAngle=__webpack_require__(10),_constants=__webpack_require__(5),NumberAxis=function(){function NumberAxis(){var startPoint=arguments.length<=0||void 0===arguments[0]?new THREE.Vector3(-_constants.NumberAxisConstData.numberAxisWidth/2,0,0):arguments[0],endPoint=arguments.length<=1||void 0===arguments[1]?new THREE.Vector3(_constants.NumberAxisConstData.numberAxisWidth/2,0,0):arguments[1],lineHeight=arguments.length<=2||void 0===arguments[2]?_constants.NumberAxisHeight:arguments[2];_classCallCheck(this,NumberAxis),this.startPoint=startPoint,this.endPoint=endPoint,this.lineHeight=lineHeight}return _createClass(NumberAxis,[{key:"getLineMaterial",value:function(){return new THREE.MeshBasicMaterial({color:_constants.Color.numberAxis,transparent:!1,opacity:1})}},{key:"getGroupMaterial",value:function(){return new THREE.MeshBasicMaterial({color:3355443,transparent:!0,opacity:0})}},{key:"creatLine",value:function(){var shape=new THREE.Shape,halfHeight=this.lineHeight/2;shape.moveTo(this.startPoint.x,halfHeight),shape.lineTo(this.startPoint.x,-halfHeight),shape.lineTo(this.endPoint.x,-halfHeight),shape.lineTo(this.endPoint.x,halfHeight),shape.lineTo(this.startPoint.x,halfHeight);var geometry=new THREE.ShapeGeometry(shape),line=new THREE.Mesh(geometry,this.getLineMaterial());return line.name=_constants.IntervalObjNames.Line,line}},{key:"creatArrow",value:function(){var arrow=new THREE.Object3D,centerPotGeometry=new THREE.CircleGeometry(this.lineHeight/2,32),arrowCenterPot=new THREE.Mesh(centerPotGeometry,this.getLineMaterial()),center=new THREE.Vector3(0,0,0),lengthVector=(0,_UtilsRotateAngle.getLocationPoint)(center,this.startPoint,20),arrowPointA=(0,_UtilsRotateAngle.rotatePoint)(lengthVector,center,45),arrowPointB=(0,_UtilsRotateAngle.rotatePoint)(lengthVector,center,-45),sideA=new THREE.Shape;sideA.moveTo(0,-this.lineHeight),sideA.lineTo(arrowPointA.x,-this.lineHeight),sideA.lineTo(arrowPointA.x,this.lineHeight),sideA.lineTo(0,this.lineHeight),sideA.lineTo(0,-this.lineHeight);var sideAGeometry=new THREE.ShapeGeometry(sideA),arrowUp=new THREE.Mesh(sideAGeometry,this.getLineMaterial());(0,_UtilsUpdateVertices2.default)(arrowUp,center,arrowPointA,this.lineHeight);var sideB=new THREE.Shape;sideB.moveTo(0,-this.lineHeight),sideB.lineTo(arrowPointB.x,-this.lineHeight),sideB.lineTo(arrowPointB.x,this.lineHeight),sideB.lineTo(0,this.lineHeight),sideB.lineTo(0,-this.lineHeight);var sideBGeometry=new THREE.ShapeGeometry(sideB),arrowDown=new THREE.Mesh(sideBGeometry,this.getLineMaterial());return(0,_UtilsUpdateVertices2.default)(arrowDown,center,arrowPointB,this.lineHeight),arrow.add(arrowCenterPot),arrow.add(arrowUp),arrow.add(arrowDown),arrow.position.copy(this.endPoint),arrow.name=_constants.IntervalObjNames.Arrow,arrow}},{key:"creatClickAreaGroup",value:function(){var areaShape=new THREE.Shape;areaShape.moveTo(this.startPoint.x,2.5*this.lineHeight),areaShape.lineTo(this.startPoint.x,2.5*-this.lineHeight),areaShape.lineTo(this.endPoint.x,2.5*-this.lineHeight),areaShape.lineTo(this.endPoint.x,2.5*this.lineHeight),areaShape.lineTo(this.startPoint.x,2.5*this.lineHeight);var areaGeometry=new THREE.ShapeGeometry(areaShape),areaMesh=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),areaGroup=new THREE.Mesh(areaGeometry,areaMesh);return areaGroup.name=_constants.IntervalObjNames.AreaGroup,areaGroup}},{key:"creatNumberAxis",value:function(){var line=this.creatLine(),arrow=this.creatArrow();return line.add(arrow),line}}]),NumberAxis}();exports.default=NumberAxis,module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _rotateAngle=__webpack_require__(10);exports.default=function(shape,pointA,pointB,lineWidth){var length=lineWidth/2,vector1=(0,_rotateAngle.rotationAngleVector)(pointB,pointA,90,!0).vector.setLength(length),vector2=(0,_rotateAngle.rotationAngleVector)(pointB,pointA,90,!1).vector.setLength(length),vertices=[],orgVertices=shape.geometry.vertices;vertices.push((new THREE.Vector2).addVectors(pointA,vector2)),vertices.push((new THREE.Vector2).addVectors(pointB,vector2)),vertices.push((new THREE.Vector2).addVectors(pointB,vector1)),vertices.push((new THREE.Vector2).addVectors(pointA,vector1));for(var i=0;i<orgVertices.length;i++)orgVertices[i].x=vertices[i].x,orgVertices[i].y=vertices[i].y;shape.geometry.verticesNeedUpdate=!0,shape.geometry.computeBoundingSphere()},module.exports=exports.default},function(module,exports){"use strict";function rotatePoint(point,center,angle){var l=angle*Math.PI/180,cosv=Math.cos(l),sinv=Math.sin(l),newX=(point.x-center.x)*cosv-(point.y-center.y)*sinv+center.x,newY=(point.x-center.x)*sinv+(point.y-center.y)*cosv+center.y;return new THREE.Vector3(newX,newY,0)}function getLocationPoint(pointA,pointB,length){var vector=new THREE.Vector3(0,0,0);return vector.subVectors(pointB,pointA),vector=vector.setLength(length),vector.add(pointA),vector}function rotationAngleVector(movePoint,fixedPoint,angle,clockwise){var tempVector=new THREE.Vector2(movePoint.x-fixedPoint.x,movePoint.y-fixedPoint.y),valueX=void 0,valueY=void 0,radian=angle/180*Math.PI;clockwise?(valueX=tempVector.x*Math.cos(radian)+tempVector.y*Math.sin(radian)+fixedPoint.x,valueY=tempVector.y*Math.cos(radian)-tempVector.x*Math.sin(radian)+fixedPoint.y):(valueX=tempVector.x*Math.cos(radian)-tempVector.y*Math.sin(radian)+fixedPoint.x,valueY=tempVector.y*Math.cos(radian)+tempVector.x*Math.sin(radian)+fixedPoint.y);var afterRotationPoint=new THREE.Vector2(valueX,valueY),afterRotationVector=new THREE.Vector2(valueX-fixedPoint.x,valueY-fixedPoint.y);return{point:afterRotationPoint,vector:afterRotationVector}}function getAngle(first_p,center_p,second_p){var v_ao=(new THREE.Vector2).subVectors(first_p,center_p),v_bo=(new THREE.Vector2).subVectors(second_p,center_p);return getVectorAngle(v_ao,v_bo)}function getVectorAngle(vector1,vector2){var dx1=void 0,dx2=void 0,dy1=void 0,dy2=void 0,angle=void 0,abs=void 0;dx1=vector1.x,dy1=vector1.y,dx2=vector2.x,dy2=vector2.y;var c=Math.sqrt(dx1*dx1+dy1*dy1)*Math.sqrt(dx2*dx2+dy2*dy2);if(0==c)return-1;if(abs=(dx1*dx2+dy1*dy2)/c,abs<0&&Math.abs(abs)>1)return 180;if(Math.abs(abs)>1)return 0;angle=180*Math.acos((dx1*dx2+dy1*dy2)/c)/Math.PI;var isClockWise=vector1.x*vector2.y-vector1.y*vector2.x<0;return isClockWise?null:angle=-angle,{radian:angle*Math.PI/180,clockWise:isClockWise,angle:angle}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rotatePoint=rotatePoint,exports.getLocationPoint=getLocationPoint,exports.rotationAngleVector=rotationAngleVector,exports.getAngle=getAngle,exports.getVectorAngle=getVectorAngle},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _shapeCoordinateScale=__webpack_require__(12),_shapeCoordinateScale2=_interopRequireDefault(_shapeCoordinateScale),_constants=__webpack_require__(5),_UtilsAddText=__webpack_require__(13),_UtilsAddText2=_interopRequireDefault(_UtilsAddText),_threeMangerJs=__webpack_require__(4);exports.default=function(scene){for(var startPosition=0,coordWidth=void 0,coordHeight=void 0,i=0;i<=21;i++){coordWidth=i%5?2:3,coordHeight=i%5?_constants.CoordScaleHeight.small:_constants.CoordScaleHeight.big,21!=i&&i!=-21||(coordHeight=.5*_constants.NumberAxisHeight);var text=void 0,pozitivaShape=new _shapeCoordinateScale2.default(coordWidth,coordHeight).creatCoordinateScale();if(pozitivaShape.position.x=startPosition,0==i){var dot=pozitivaShape.getObjectByName(_constants.IntervalObjNames.DotCircle);dot.visible=!0}if(i%5==0&&(text=(0,_UtilsAddText2.default)(i.toString(),new THREE.Vector3(startPosition,-30,0),32,32,_constants.Color.numberText),scene.add(text)),pozitivaShape.position.y=i%5==0?0:.5*coordHeight,scene.add(pozitivaShape),i>0){var j=-i;j%5==0&&(text=(0,_UtilsAddText2.default)(j.toString(),new THREE.Vector3(-startPosition,-30,0),32,32,_constants.Color.numberText),scene.add(text));var negativaShape=new _shapeCoordinateScale2.default(coordWidth,coordHeight).creatCoordinateScale();negativaShape.position.x=-startPosition,negativaShape.position.y=i%5==0?0:.5*coordHeight,scene.add(negativaShape),_threeMangerJs.intersectObjs.push(negativaShape)}startPosition+=_constants.NumberAxisConstData.scaleMargin,i%21==0&&(pozitivaShape.position.y=0)}},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_constants=__webpack_require__(5),_threeMangerJs=__webpack_require__(4),coordinateScale=function(){function coordinateScale(){var lineWidth=arguments.length<=0||void 0===arguments[0]?6:arguments[0],lineHeight=arguments.length<=1||void 0===arguments[1]?20:arguments[1];_classCallCheck(this,coordinateScale),this.lineWidth=lineWidth,this.lineHeight=lineHeight}return _createClass(coordinateScale,[{key:"creatCoordGroup",value:function(){var groupHalfHeight=_constants.SelectBox.Height,groupWidth=_constants.SelectBox.Width,groupShape=new THREE.Shape;groupShape.moveTo(-groupWidth,groupHalfHeight),groupShape.lineTo(-groupWidth,-groupHalfHeight),groupShape.lineTo(groupWidth,-groupHalfHeight),groupShape.lineTo(groupWidth,groupHalfHeight),groupShape.lineTo(-groupWidth,groupHalfHeight);var groupGeometry=new THREE.ShapeGeometry(groupShape),groupMesh=new THREE.Mesh(groupGeometry,new THREE.MeshBasicMaterial({color:26214,transparent:!0,opacity:0}));return groupMesh.name=_constants.IntervalObjNames.CoordScaleName,groupMesh}},{key:"creatCoord",value:function(){var shape=new THREE.Shape,halfWidth=this.lineWidth/2,halfHeight=this.lineHeight/2;shape.moveTo(-halfWidth,halfHeight),shape.lineTo(-halfWidth,-halfHeight),shape.lineTo(halfWidth,-halfHeight),shape.lineTo(halfWidth,halfHeight),shape.lineTo(-halfWidth,halfHeight);var geometry=new THREE.ShapeGeometry(shape),coordScale=new THREE.Mesh(geometry,new THREE.MeshBasicMaterial({color:_constants.Color.numberAxis,transparent:!1,opacity:1}));return coordScale.name="coordScale",coordScale}},{key:"creatDot",value:function(){var radius=.8*_constants.SelectBox.Width,soildCircleGeometry=new THREE.CircleGeometry(radius,64),dotCircle=new THREE.Mesh(soildCircleGeometry,new THREE.MeshBasicMaterial({color:_constants.Color.numberAxis,overdraw:.5}));return dotCircle.visible=!1,dotCircle.name=_constants.IntervalObjNames.DotCircle,dotCircle}},{key:"creatCoordinateScale",value:function(){var group=this.creatCoordGroup(),coord=this.creatCoord(),dot=this.creatDot();return group.add(coord),group.add(dot),_threeMangerJs.intersectObjs.push(group),group}}]),coordinateScale}();exports.default=coordinateScale,module.exports=exports.default},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(text,position,width,height){var fontColor=arguments.length<=4||void 0===arguments[4]?"black":arguments[4],fontSize=arguments.length<=5||void 0===arguments[5]?"16px":arguments[5],dynamicTexture=new THREEx.DynamicTexture(width,height);dynamicTexture.context.font="bolder "+fontSize+" Arial";var geometry=new THREE.CubeGeometry(width,height,0),textField=new THREE.Mesh(geometry,new THREE.MeshBasicMaterial({map:dynamicTexture.texture,transparent:!0}));return textField.position.x=position.x,textField.position.y=position.y,textField._dynamicTexture=dynamicTexture,textField._dynamicTexture.drawText(text,void 0,height/2,fontColor),textField},module.exports=exports.default},function(module,exports){"use strict";function autoDetectRenderer(options,noWebGL){return!noWebGL&&isWebGLSupported()?new THREE.WebGLRenderer(options):new THREE.CanvasRenderer(options)}function isWebGLSupported(){var contextOptions={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions);return!(!gl||!gl.getContextAttributes().stencil)}catch(e){return!1}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isWebGLSupported=isWebGLSupported,exports.autoDetectRenderer=autoDetectRenderer},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function moduleStart(){(0,_threeManger.threeStart)(),_presenter2.default.isStudentMobile&&(_presenter2.default.sendEventToCalc("show"),_presenter2.default.sendEventToCalc("submit")),_presenter2.default.isStudentMobile&&(0,_event.registerNativeListener)("ExamCallback",_submitControl.examCallBack),(_presenter2.default.isWeb||_presenter2.default.isPPTShell||_presenter2.default.isTeacherPc)&&(0,_submitControl.showWebSubmit)()}function isApp(){return _presenter2.default.isTeacherMobile||_presenter2.default.isStudentMobile}function moduleClose(){(0,_event.unbindNativeListener)("ExamCallback"),(0,_event.unbindNativeListener)("ExamInfoCallback"),(0,_EventDocumentEventJs.removeEventListerner)(),(0,_threeManger.destroyThree)(),(0,_timer.destoryTimer)()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.moduleStart=moduleStart,exports.isApp=isApp,exports.moduleClose=moduleClose;var _runtime=__webpack_require__(6),_presenter=(_interopRequireDefault(_runtime),__webpack_require__(1)),_presenter2=_interopRequireDefault(_presenter),_threeManger=(__webpack_require__(5),__webpack_require__(4)),_event=__webpack_require__(16),_submitControl=__webpack_require__(17),_timer=__webpack_require__(19),_EventDocumentEventJs=__webpack_require__(23)},function(module,exports,__webpack_require__){"use strict";function unbindNativeListener(key){(0,_moduleControl.isApp)()&&Bridge&&Bridge.unRegisterListener&&(key?Bridge.unRegisterListener(key,callbacks[key]):($.each(callbacks,function(k,v){Bridge.unRegisterListener(k,callbacks[k])}),exports.callbacks=callbacks={}))}function registerNativeListener(key,_callback){(0,_moduleControl.isApp)()&&Bridge&&Bridge.registerListener&&(callbacks[key]=Bridge.registerListener(key,_callback))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.unbindNativeListener=unbindNativeListener,exports.registerNativeListener=registerNativeListener;var _moduleControl=__webpack_require__(15),callbacks={};exports.callbacks=callbacks},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getI18n(){return{answer_correct:"太棒啦, 您答对了!",answer_error:"这道题没有做对, 下次加油哦!",next_come_on:"答题结束，下次加油哦！",time_over:"时间到了，练习结束！",button_submit:"提交",options:"选项",people:"人"}}function getAnswerContent(answer){!answer||0==answer.length}function getWrongPopup(){}function getResult(){var isCorrect=(0,_UtilsMatchAnswerJs2.default)(),correct_response=_presenter2.default.model.question_url.content.answer,data={status:"complete",is_correct:isCorrect,correct_response:correct_response},res={answer:JSON.stringify(data),questionId:_presenter2.default.model.question_id};return res}function showWebSubmit(){new CommitBtn($(_presenter2.default.view).find("div.com_lay_toptool"),"time_id",function(){submitWebTeacher()})}function showAlert(type){var msg="";if("student"==type)msg="doing"==_presenter2.default.submitStatus||"do"==_presenter2.default.submitStatus?getI18n.next_come_on:getI18n.time_over;else if("teacher"==type){var res={};msg=res.is_right?getI18n.answer_correct:getI18n.answer_error}}function showPreViewPop(msg){var node=$(_presenter2.default.view).find(".pop_result");node.find(".text").html(msg),node.show(),setTimeout(function(){node.find(".text").html(""),node.hide()},2e3)}function recordSubmitAnswer(){var options=[],tmpObj=JSON.parse(JSON.stringify("{test:testResult}")),value={options:options,catesObj:tmpObj};_presenter2.default.submitAnser=value;
}function recoverSubmitAnswer(){_presenter2.default.submitAnser}function examCallBack(data){var type=data.type,value=!!data.value&&data.value;if(value&&"result"==type){var $resultTip=$(_presenter2.default.view).find(".resultTip").removeClass("correct error"),isCorrect=(0,_UtilsMatchAnswerJs2.default)();isCorrect?($resultTip.addClass("correct"),$resultTip.text("太棒啦, 您答对了!")):($resultTip.addClass("error"),$resultTip.text("很遗憾,回答错误!")),_presenter2.default.submitStatus="result"}}function callSubmiterdo(time){_presenter2.default.isStudentMobile?((0,_sendEventToCalc2.default)("finish"),showAlert("student"),_presenter2.default.submitStatus="finished",_presenter2.default.submitTime=time,(0,_timerJs.destoryTimer)()):submitWebTeacher()}function submitWebTeacher(){var isCorrect=(0,_UtilsMatchAnswerJs2.default)();showPreViewPop(isCorrect?"太棒啦, 您答对了!":"很遗憾,回答错误!")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getI18n=getI18n,exports.getAnswerContent=getAnswerContent,exports.getWrongPopup=getWrongPopup,exports.getResult=getResult,exports.showWebSubmit=showWebSubmit,exports.showAlert=showAlert,exports.showPreViewPop=showPreViewPop,exports.recordSubmitAnswer=recordSubmitAnswer,exports.recoverSubmitAnswer=recoverSubmitAnswer,exports.examCallBack=examCallBack,exports.callSubmiterdo=callSubmiterdo;var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_sendEventToCalc=(__webpack_require__(15),__webpack_require__(18)),_sendEventToCalc2=_interopRequireDefault(_sendEventToCalc),_timerJs=__webpack_require__(19),_UtilsMatchAnswerJs=__webpack_require__(22),_UtilsMatchAnswerJs2=_interopRequireDefault(_UtilsMatchAnswerJs)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(action){if(!_presenter2.default.isStudentMobile)return!1;console.log("sendEventToCalc:",action),action=action||"submit";var timerId=window.setInterval(function(){var answerSubmitter=player.getPlayerServices().getToolbarModule("AnswerSubmitter")||player.getPlayerServices().getModule("AnswerSubmitter");null!=answerSubmitter&&(window.clearInterval(timerId),_presenter2.default.eventBus.sendEvent("AnswerSubmitter",{source:_presenter2.default.model.ID,action:action}))})},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function initTimer(){if(_presenter2.default.isSyncTime=!1,_presenter2.default.submitTime=0,_presenter2.default.model.question_url){var modelTimer=_presenter2.default.model.question_url.timer,mark="sequence"==modelTimer.timer_type,time_limit=60*parseInt(modelTimer.time_minute)+parseInt(modelTimer.time_second);if(exports.AxisTimer=AxisTimer=new Timer($(_presenter2.default.view).find("div.com_u_timebox"),{sequence:mark,seconds:parseInt(time_limit)}),mark||AxisTimer.onStop(function(time){(0,_submitControl.callSubmiterdo)(time)}),_presenter2.default.isWeb||_presenter2.default.isPPTShell||_presenter2.default.isTeacherPc)startTimer();else if(_presenter2.default.isStudentMobile){var data={item:"exam",type:"query"};(0,_sendEventToDispatcher.sendEventToDispatcher)(data)}}}function startTimer(){AxisTimer.start()}function lastTimer(startTime){startTime=parseInt(startTime);var timestamp=(new Date).valueOf();AxisTimer.sync(timestamp-1e3*startTime)}function syncTime(){if(_presenter2.default.isWeb||_presenter2.default.isStudentMobile){var param={eventName:"ExamInfo",eventData:{item:"time"}};(0,_callNative2.default)("sendEvent",param)}}function registerTimer(){registerNativeListener("ExamCallback",examCallBack),registerNativeListener("ExamInfoCallback",timeListem)}function timeListem(data){var item=data.item||"",value=data.value||{};if(1==_presenter2.default.isSyncTime)return!1;if("time"==item){var elapsedTime=value.data?parseInt(value.data.elapsedTime):0;"finished"==_presenter2.default.submitStatus||"result"==_presenter2.default.submitStatus?(_presenter2.default.isSyncTime=!0,_presenter2.default.submitTime<=0&&lastTimer(elapsedTime),destoryTimer()):(startTimer(elapsedTime),_presenter2.default.isSyncTime=!0)}}function destoryTimer(){AxisTimer&&AxisTimer.onDestory()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initTimer=initTimer,exports.startTimer=startTimer,exports.lastTimer=lastTimer,exports.syncTime=syncTime,exports.registerTimer=registerTimer,exports.timeListem=timeListem,exports.destoryTimer=destoryTimer;var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_callNative=__webpack_require__(20),_callNative2=_interopRequireDefault(_callNative),_sendEventToDispatcher=(__webpack_require__(15),__webpack_require__(21)),_submitControl=__webpack_require__(17),AxisTimer=void 0;exports.AxisTimer=AxisTimer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _constants=__webpack_require__(5);exports.default=function(eventName,data){return!!(isApp&&Bridge&&Bridge.callNative)&&Bridge.callNative(_constants.callNativePath,eventName,data)},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function sendEventToDispatcher(data){if(!_presenter2.default.isStudentMobile)return!1;var timerId=window.setInterval(function(){var dispatcher=player.getPlayerServices().getToolbarModule("classroomStudentDispatcher")||player.getPlayerServices().getModule("classroomStudentDispatcher");null!=dispatcher&&(window.clearInterval(timerId),_presenter2.default.eventBus.sendEvent("TaskInfo",data))})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendEventToDispatcher=sendEventToDispatcher;var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isAnswerEqule(answerNum,answerContain,Endpoint){var endpointNumberMar=Endpoint.userData.numberMark;return""===answerNum&&Math.abs(endpointNumberMar)>20||""!==answerNum&&(1*answerNum===endpointNumberMar&&(1==answerContain&&0==Endpoint.userData.statusIndex||0==answerContain&&1==Endpoint.userData.statusIndex))}function getAllEndpoint1(){for(var tempEndpoint1Group=[],i=0;i<_threeMangerJs.intersectObjs.length;i++)_threeMangerJs.intersectObjs[i].name==_constantsJs.IntervalObjNames.Endpoint1&&tempEndpoint1Group.push(_threeMangerJs.intersectObjs[i]);return tempEndpoint1Group}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_threeMangerJs=__webpack_require__(4),_constantsJs=__webpack_require__(5);exports.default=function(){var answer=_presenter2.default.model.question_url.content.answer,endpoint1Group=getAllEndpoint1();if(answer.length!=endpoint1Group.length)return!1;if(0==answer.length&&0==endpoint1Group.length)return!0;for(var matchResult=!1,i=0;i<answer.length;i++){if(i>0){if(!matchResult)return!1;matchResult=!1}for(var minAnsNum=answer[i].min.num,minAnsContain=answer[i].min.contain,j=0;j<endpoint1Group.length;j++){var endpoint1=endpoint1Group[j],_status=isAnswerEqule(minAnsNum,minAnsContain,endpoint1);if(_status){var maxAnsNum=answer[i].max.num,maxAnsContain=answer[i].max.contain,endpoint2=void 0;if(endpoint2=endpoint1Group[j].userData.isSingle?endpoint1Group[j]:endpoint1Group[j].parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2),_status=isAnswerEqule(maxAnsNum,maxAnsContain,endpoint2),matchResult=_status,_status){var index=endpoint1Group.indexOf(endpoint1Group[j]);endpoint1Group.splice(index,1)}}}}return matchResult},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function setLastSelToDelObj(obj){lastSelToDelObj=obj}function documentInit(){_presenter2.default.isStudentMobile||_presenter2.default.isTeacherMobile?(_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("touchstart",onDocumentMouseDown,!1),_presenter2.default.view.addEventListener("touchend",onViewUp,!1)):(_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("mousedown",onDocumentMouseDown,!1),_presenter2.default.view.addEventListener("mouseup",onViewUp,!1))}function intersectObjects(pointer,objects){var pageY=pointer.clientY+$(_presenter2.default.view).find(".com_layout").scrollTop()+$("body").scrollTop(),pageX=pointer.clientX+$(_presenter2.default.view).find(".com_layout").scrollLeft()+$("body").scrollLeft(),pointerVector=new THREE.Vector2((pageX-_constantsJs.REAL_ESTATE.offsetLeft)/_constantsJs.REAL_ESTATE.width*2-1,2*-((pageY-_constantsJs.REAL_ESTATE.offsetTop)/_constantsJs.REAL_ESTATE.height)+1);_threeMangerJs.raycaster.setFromCamera(pointerVector,_threeMangerJs.camera);var intersections=_threeMangerJs.raycaster.intersectObjects(objects,!1);return intersections}function onDocumentMouseDown(event){event.stopPropagation(),event.preventDefault(),maxMarkPosition=.5*(_constantsJs.NumberAxisConstData.scaleCount-1)*_constantsJs.NumberAxisConstData.scaleMargin,boundary=_threeMangerJs.scene.getObjectByName("boundary");var pointer=event.changedTouches?event.changedTouches[0]:event;intersects=intersectObjects(pointer,_threeMangerJs.intersectObjs);var startPoint=intersectObjects(pointer,[boundary])[0];if(mouseData.startPoint=startPoint.point,!intersects.length)return void(0,_UtilsSeleteIntervalJs.cancelSelected)(lastSelToDelObj);switch(selectedObj=intersects[0].object,selectedObj.name){case _constantsJs.IntervalObjNames.CoordScaleName:(0,_UtilsSeleteIntervalJs.cancelSelected)(lastSelToDelObj),actionType=_constantsJs.ACTION_TYPE.add;var intervalGroup=(0,_shapeCreatIntervalGroupJs2.default)(),endPot=(0,_UtilsAddIntervalJs2.default)(new THREE.Vector3(startPoint.point.x,0,0),selectedObj.position.x,intervalGroup);if(!endPot)return;endPot.name=_constantsJs.IntervalObjNames.Endpoint1,selectedObj=endPot,_threeMangerJs.scene.add(intervalGroup);break;case _constantsJs.IntervalObjNames.Endpoint1:case _constantsJs.IntervalObjNames.Endpoint2:actionType=_constantsJs.ACTION_TYPE.changePoint,(0,_UtilsSetZPositionJs.addZPosition)(selectedObj);break;case _constantsJs.IntervalObjNames.IntervalRect:actionType=_constantsJs.ACTION_TYPE.intervalRect;break;case _constantsJs.IntervalObjNames.DeleteBtn:actionType=_constantsJs.ACTION_TYPE.deleteInterval}bindingMouseDownClickEvent()}function onDocumentMouseMove(event){event.stopPropagation(),event.preventDefault();var pointer=event.changedTouches?event.changedTouches[0]:event,movePointObj=intersectObjects(pointer,[boundary])[0];if(selectedObj.name!=_constantsJs.IntervalObjNames.IntervalRect&&selectedObj.name!=_constantsJs.IntervalObjNames.DeleteBtn&&Math.abs(movePointObj.point.x-mouseData.startPoint.x)>5){if(Math.abs(movePointObj.point.x)>=.5*_constantsJs.NumberAxisConstData.numberAxisWidth)return void onDocumentMouseUp(event);Math.abs(movePointObj.point.x)>=maxMarkPosition&&(movePointObj.point.x<0?movePointObj.point.x=-maxMarkPosition:movePointObj.point.x=maxMarkPosition),(0,_UtilsSeleteIntervalJs.cancelSelected)(lastSelToDelObj,selectedObj),selectedObj.userData.isSingle&&(selectedObj=(0,_UtilsPackMethodJs.addLineAndAnotherEndpoint)(selectedObj,movePointObj.point));var movingPoint=(0,_UtilsPackMethodJs.updateMovingpoint)(selectedObj,movePointObj.point);(0,_UtilsPackMethodJs.updateMovingInterval)(selectedObj,movingPoint),actionType=_constantsJs.ACTION_TYPE.changeInter}}function onDocumentMouseUp(event){switch(event.stopPropagation(),event.preventDefault(),(0,_UtilsSeleteIntervalJs.cancelSelected)(lastSelToDelObj,selectedObj),actionType){case _constantsJs.ACTION_TYPE.add:break;case _constantsJs.ACTION_TYPE.changePoint:if(Math.abs(selectedObj.userData.numberMark)<=20&&(0,_UtilsChangeEndpointStatusJs.changeEndpointStatus)(selectedObj),selectedObj.name==_constantsJs.IntervalObjNames.Endpoint1&&selectedObj.userData.isSingle&&(selectedObj.parent.userData.isDelete=!selectedObj.parent.userData.isDelete,(0,_UtilsSeleteIntervalJs.seleteInterval)(selectedObj)),selectedObj.userData.isSingle)break;(0,_UtilsPackMethodJs.movingIntervalCombinInterval)(selectedObj),(0,_UtilsSetZPositionJs.setOriginalPosition)(selectedObj);break;case _constantsJs.ACTION_TYPE.changeInter:(0,_UtilsPackMethodJs.undateIntervalWhenMouthUp)(selectedObj),(0,_UtilsPackMethodJs.movingIntervalCombinInterval)(selectedObj),(0,_UtilsPackMethodJs.twoEndpointCoincide)(selectedObj),(0,_UtilsSetZPositionJs.setOriginalPosition)(selectedObj);break;case _constantsJs.ACTION_TYPE.intervalRect:selectedObj.parent.userData.isDelete=!selectedObj.parent.userData.isDelete,(0,_UtilsSeleteIntervalJs.seleteInterval)(selectedObj);break;case _constantsJs.ACTION_TYPE.deleteInterval:(0,_UtilsPackMethodJs.removeInterval)(selectedObj)}actionType=null,bindingMouseUpClickEvent()}function removeEventListerner(){_presenter2.default.view.getElementsByTagName("canvas")[0]&&(_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("mousedown",onDocumentMouseDown,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchstart",onDocumentMouseDown,!1)),_presenter2.default.view.removeEventListener("touchend",onViewUp,!1),_presenter2.default.view.removeEventListener("touchup",onViewUp,!1)}function bindingMouseDownClickEvent(){_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("mousemove",onDocumentMouseMove,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("mouseup",onDocumentMouseUp,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("touchend",onDocumentMouseUp,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].addEventListener("touchmove",onDocumentMouseMove,!1)}function bindingMouseUpClickEvent(){_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("mousemove",onDocumentMouseMove,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("mouseup",onDocumentMouseUp,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchmove",onDocumentMouseMove,!1),_presenter2.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchend",onDocumentMouseUp,!1)}function onViewUp(){(0,_UtilsSeleteIntervalJs.cancelSelected)(lastSelToDelObj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLastSelToDelObj=setLastSelToDelObj,exports.default=documentInit,exports.removeEventListerner=removeEventListerner;var boundary,selectedObj,intersects,_threeMangerJs=__webpack_require__(4),_constantsJs=__webpack_require__(5),_presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_shapeIntervalEndpointJs=__webpack_require__(24),_UtilsChangeEndpointStatusJs=(_interopRequireDefault(_shapeIntervalEndpointJs),__webpack_require__(25)),_UtilsAddIntervalJs=__webpack_require__(26),_UtilsAddIntervalJs2=_interopRequireDefault(_UtilsAddIntervalJs),_shapeCreatIntervalLineJs=__webpack_require__(27),_UtilsSeleteIntervalJs=(_interopRequireDefault(_shapeCreatIntervalLineJs),__webpack_require__(28)),_shapeCreatIntervalGroupJs=__webpack_require__(31),_shapeCreatIntervalGroupJs2=_interopRequireDefault(_shapeCreatIntervalGroupJs),_UtilsMatchAnswerJs=__webpack_require__(22),_UtilsSetZPositionJs=(_interopRequireDefault(_UtilsMatchAnswerJs),__webpack_require__(30)),_UtilsPackMethodJs=__webpack_require__(32),mouseData={},actionType=void 0,lastSelToDelObj=void 0,maxMarkPosition=void 0},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _constants=__webpack_require__(5);exports.default=function(){var material=new THREE.MeshBasicMaterial({color:_constants.Color.normal,overdraw:.5}),radius=_constants.CircleRadius.soild,triangleSideLength=2*_constants.NumberAxisHeight,groupHalfHeight=1.2*_constants.SelectBox.Height,groupWidth=1.1*_constants.SelectBox.Width,groupShape=new THREE.Shape;groupShape.moveTo(-groupWidth,groupHalfHeight),groupShape.lineTo(-groupWidth,-groupHalfHeight),groupShape.lineTo(groupWidth,-groupHalfHeight),groupShape.lineTo(groupWidth,groupHalfHeight),groupShape.lineTo(-groupWidth,groupHalfHeight);var groupGeometry=new THREE.ShapeGeometry(groupShape),endpoint=new THREE.Mesh(groupGeometry,new THREE.MeshBasicMaterial({color:65280,transparent:!0,opacity:0,overdraw:.5})),soildCircleGeometry=new THREE.CircleGeometry(radius,64),soildCircle=new THREE.Mesh(soildCircleGeometry,material);soildCircle.name=_constants.IntervalObjNames.SoildCircle;var emptyCircleGeometry=new THREE.CircleGeometry(_constants.CircleRadius.empty,64),emptyCircle=new THREE.Mesh(emptyCircleGeometry,new THREE.MeshBasicMaterial({color:_constants.Color.emptyCircle,overdraw:.5}));emptyCircle.name=_constants.IntervalObjNames.EmptyCircle,emptyCircle.visible=!1;var lefthape=new THREE.Shape;length=triangleSideLength*Math.sqrt(3)/2,lefthape.moveTo(radius,triangleSideLength),lefthape.lineTo(-length,0),lefthape.lineTo(radius,-triangleSideLength),lefthape.lineTo(radius,triangleSideLength);var leftTriangelGeometry=new THREE.ShapeGeometry(lefthape),leftTriangleMesh=new THREE.Mesh(leftTriangelGeometry,material);leftTriangleMesh.name=_constants.IntervalObjNames.LeftTriangle,leftTriangleMesh.visible=!1;var rightShape=new THREE.Shape;rightShape.moveTo(-radius,triangleSideLength),rightShape.lineTo(length,0),rightShape.lineTo(-radius,-triangleSideLength),rightShape.lineTo(-radius,triangleSideLength);var rightTrianglegeometry=new THREE.ShapeGeometry(rightShape),rightTriangleMesh=new THREE.Mesh(rightTrianglegeometry,material);return rightTriangleMesh.name=_constants.IntervalObjNames.RightTriangle,rightTriangleMesh.visible=!1,endpoint.add(soildCircle),endpoint.add(emptyCircle),endpoint.add(leftTriangleMesh),endpoint.add(rightTriangleMesh),endpoint.position.z=_constants.ZOriginIndex.endpoint,endpoint.userData.statusIndex=0,endpoint.userData.isSingle=!0,endpoint.userData.isChangeStatus=!1,endpoint},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function changeEndpointStatus(endpoint){endpoint.userData.isSingle||(endpoint.userData.statusIndex=(endpoint.userData.statusIndex+1)%2,20!=endpoint.userData.statusIndex&&endpoint.userData.statusIndex!=-20||0==endpoint.userData.statusIndex,updateEndpointStatus(endpoint))}function updateEndpointStatus(endpoint){var index=endpoint.userData.statusIndex;switch(index=endpoint.userData.numberMark>=-20&&endpoint.userData.numberMark<=20?endpoint.userData.statusIndex:_constantsJs.StatusIndex.Triangle){case _constantsJs.StatusIndex.SoildCircle:showSoildCircle(endpoint);break;case _constantsJs.StatusIndex.EmptyCircle:showEmptyCircle(endpoint);break;case _constantsJs.StatusIndex.Triangle:showTriangle(endpoint)}}function showSoildCircle(endpoint){endpoint.getObjectByName(_constantsJs.IntervalObjNames.SoildCircle).visible=!0,endpoint.getObjectByName(_constantsJs.IntervalObjNames.EmptyCircle).visible=!1,endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle).visible=!1,endpoint.getObjectByName(_constantsJs.IntervalObjNames.RightTriangle).visible=!1}function showEmptyCircle(endpoint){endpoint.getObjectByName(_constantsJs.IntervalObjNames.SoildCircle).visible=!0,endpoint.getObjectByName(_constantsJs.IntervalObjNames.EmptyCircle).visible=!0,endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle).visible=!1,endpoint.getObjectByName(_constantsJs.IntervalObjNames.RightTriangle).visible=!1}function showTriangle(endpoint){endpoint.getObjectByName(_constantsJs.IntervalObjNames.SoildCircle).visible=!1,endpoint.getObjectByName(_constantsJs.IntervalObjNames.EmptyCircle).visible=!1,endpoint.userData.numberMark>20?(endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle).visible=!1,endpoint.getObjectByName(_constantsJs.IntervalObjNames.RightTriangle).visible=!0):(endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle).visible=!0,endpoint.getObjectByName(_constantsJs.IntervalObjNames.RightTriangle).visible=!1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.changeEndpointStatus=changeEndpointStatus,exports.updateEndpointStatus=updateEndpointStatus,exports.showSoildCircle=showSoildCircle,exports.showEmptyCircle=showEmptyCircle,exports.showTriangle=showTriangle;var _constantsJs=__webpack_require__(5)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _constants=__webpack_require__(5),_threeMangerJs=__webpack_require__(4),_shapeIntervalEndpointJs=__webpack_require__(24),_shapeIntervalEndpointJs2=_interopRequireDefault(_shapeIntervalEndpointJs);exports.default=function(startPoint,positionX,intervalGroup){var currentPot=Math.round(startPoint.x/_constants.NumberAxisConstData.scaleMargin);if(!(Math.abs(currentPot)>20)){var endPot=new _shapeIntervalEndpointJs2.default;return endPot.position.x=positionX,endPot.userData.numberMark=currentPot,endPot.position.z+=1,_threeMangerJs.intersectObjs.push(endPot),intervalGroup.add(endPot),endPot}},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _constantsJs=__webpack_require__(5),_shapeIntervalEndpointJs=__webpack_require__(24),_threeMangerJs=(_interopRequireDefault(_shapeIntervalEndpointJs),__webpack_require__(4));exports.default=function(fixPoint,movingPoint,intervalGroup){var leftPot=void 0,rightPot=void 0,lineHight=_constantsJs.NumberAxisHeight+2;movingPoint.x>=fixPoint.x?(leftPot=fixPoint,rightPot=movingPoint):(leftPot=movingPoint,rightPot=fixPoint);var rectLeftCenterX=leftPot.x+_constantsJs.CircleRadius.soild,rectRightCenterX=rightPot.x-_constantsJs.CircleRadius.soild,groupHalfHeight=1.2*_constantsJs.SelectBox.Height,groupShape=new THREE.Shape;groupShape.moveTo(rectLeftCenterX,groupHalfHeight),groupShape.lineTo(rectLeftCenterX,-groupHalfHeight),groupShape.lineTo(rectRightCenterX,-groupHalfHeight),groupShape.lineTo(rectRightCenterX,groupHalfHeight),groupShape.lineTo(rectLeftCenterX,groupHalfHeight);var groupGeometry=new THREE.ShapeGeometry(groupShape),rectGroup=new THREE.Mesh(groupGeometry,new THREE.MeshBasicMaterial({color:255,transparent:!0,opacity:0}));rectGroup.name=_constantsJs.IntervalObjNames.IntervalRect;var halfHeight=.5*lineHight,intervalShape=new THREE.Shape;intervalShape.moveTo(rectLeftCenterX,halfHeight),intervalShape.lineTo(rectLeftCenterX,-halfHeight),intervalShape.lineTo(rectRightCenterX,-halfHeight),intervalShape.lineTo(rectRightCenterX,halfHeight),intervalShape.lineTo(rectLeftCenterX,halfHeight);var intervalGeometry=new THREE.ShapeGeometry(intervalShape),intervalRect=new THREE.Mesh(intervalGeometry,new THREE.MeshBasicMaterial({color:_constantsJs.Color.normal}));intervalRect.name=_constantsJs.IntervalObjNames.IntervalLine,rectGroup.position.z=_constantsJs.ZOriginIndex.intervalRect,rectGroup.add(intervalRect),_threeMangerJs.intersectObjs.push(rectGroup),intervalGroup.add(rectGroup)},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function seleteInterval(obj){obj&&(changeIntervalColor(obj),obj.parent.userData.isDelete?((0,_EventDocumentEventJs.setLastSelToDelObj)(obj),(0,_setZPositionJs.addZPosition)(obj)):((0,_EventDocumentEventJs.setLastSelToDelObj)(),(0,_setZPositionJs.setOriginalPosition)(obj)),changeDeleteBtn(obj))}function changeDeleteBtn(obj){var btn=obj.parent.getObjectByName(_constantsJs.IntervalObjNames.DeleteBtn);btn?btn.visible=!btn.visible:btn=(0,_shapeCreatDeleteBtnJs2.default)(obj.parent),btn.position.y=_constantsJs.DeleteBtnY;var x1=0,x2=0,x=0,endPoint1=obj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),endPoint2=obj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);endPoint1&&(x1=endPoint1.position.x),endPoint2&&(x2=endPoint2.position.x),endPoint1&&endPoint2?x=(x1+x2)/2:endPoint1?x=x1:endPoint2&&(x=x2),btn.position.x=x-2}function changeIntervalColor(obj){obj.parent.userData.isDelete?changeToColor(obj,_constantsJs.Color.delete):changeToColor(obj,_constantsJs.Color.normal)}function changeToColor(obj,color){var interval=obj.parent;if(interval){var intervalRect=interval.getObjectByName(_constantsJs.IntervalObjNames.IntervalLine);intervalRect&&intervalRect.material.color.setHex(color);var point1=interval.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),point2=interval.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);point1&&changeEndpointColor(point1),point2&&changeEndpointColor(point2)}}function changeEndpointColor(endpoint){var visibleShape=void 0;visibleShape=0==endpoint.userData.statusIndex?endpoint.getObjectByName(_constantsJs.IntervalObjNames.SoildCircle):1==endpoint.userData.statusIndex?endpoint.getObjectByName(_constantsJs.IntervalObjNames.SoildCircle):endpoint.numberMark<20?endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle):endpoint.getObjectByName(_constantsJs.IntervalObjNames.LeftTriangle),endpoint.parent.userData.isDelete?visibleShape.material.color.setHex(_constantsJs.Color.delete):visibleShape.material.color.setHex(_constantsJs.Color.normal)}function cancelSelected(lastSelectedObj,curSelectedObj){if(lastSelectedObj){if(curSelectedObj&&lastSelectedObj==curSelectedObj)return;lastSelectedObj.parent.userData.isDelete=!1,seleteInterval(lastSelectedObj)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.seleteInterval=seleteInterval,exports.cancelSelected=cancelSelected;var _constantsJs=__webpack_require__(5),_shapeCreatDeleteBtnJs=__webpack_require__(29),_shapeCreatDeleteBtnJs2=_interopRequireDefault(_shapeCreatDeleteBtnJs),_EventDocumentEventJs=__webpack_require__(23),_setZPositionJs=__webpack_require__(30)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _constantsJs=__webpack_require__(5),_threeMangerJs=__webpack_require__(4);exports.default=function(interval){var deleteBtn=new THREE.Mesh(new THREE.PlaneBufferGeometry(100,60),(0,_constantsJs.getDeleteMaterial)());return deleteBtn.name=_constantsJs.IntervalObjNames.DeleteBtn,deleteBtn.visible=!0,_threeMangerJs.intersectObjs.push(deleteBtn),interval.add(deleteBtn),deleteBtn},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function addZPosition(selectedObj){var shape=selectedObj.parent;shape&&(selectedObj.name!=_constantsJs.IntervalObjNames.Endpoint1&&selectedObj.name!=_constantsJs.IntervalObjNames.Endpoint2||(selectedObj.position.z+=2),shape.position.z+=1)}function setOriginalPosition(selectedObj){var shape=selectedObj.parent;if(shape){if(selectedObj.name==_constantsJs.IntervalObjNames.Endpoint1||selectedObj.name==_constantsJs.IntervalObjNames.Endpoint2){var endpoint1=shape.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),endpoint2=shape.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);endpoint1.position.z=_constantsJs.ZOriginIndex.endpoint,endpoint2&&(endpoint2.position.z=_constantsJs.ZOriginIndex.endpoint)}shape.position.z=_constantsJs.ZOriginIndex.intervalGroup}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.addZPosition=addZPosition,exports.setOriginalPosition=setOriginalPosition;var _constantsJs=__webpack_require__(5)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _shapeCreatDeleteBtnJs=__webpack_require__(29),_constants=(_interopRequireDefault(_shapeCreatDeleteBtnJs),__webpack_require__(5));exports.default=function(){var intervalGroup=new THREE.Object3D;return intervalGroup.position.z=_constants.ZOriginIndex.intervalGroup,intervalGroup.userData.isDelete=!1,intervalGroup},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function addLineAndAnotherEndpoint(selectedObj,movePoint){selectedObj.userData.isSingle=!1,(0,_shapeCreatIntervalLineJs2.default)(selectedObj.position,movePoint,selectedObj.parent);var otherEndPot=new _UtilsAddIntervalJs2.default(new THREE.Vector3(selectedObj.position.x,0,0),movePoint.x,selectedObj.parent);return otherEndPot.name=_constantsJs.IntervalObjNames.Endpoint2,otherEndPot.userData.isSingle=!1,otherEndPot.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1).position.x>otherEndPot.position.x&&(otherEndPot.name=_constantsJs.IntervalObjNames.Endpoint1,otherEndPot.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1).name=_constantsJs.IntervalObjNames.Endpoint2),otherEndPot}function updateInterval(selectedObj){var point1=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1).position,point2=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2).position,smallPot=void 0,bigPot=void 0;if(point1.x<point2.x)smallPot=new THREE.Vector2(point1.x+.4*_constantsJs.CircleRadius.soild,0),bigPot=new THREE.Vector2(point2.x-.4*_constantsJs.CircleRadius.soild,0);else{smallPot=new THREE.Vector2(point2.x+.4*_constantsJs.CircleRadius.soild,0),bigPot=new THREE.Vector2(point1.x-.4*_constantsJs.CircleRadius.soild,0);var endpoint1=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),endpoint2=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);endpoint1.name=_constantsJs.IntervalObjNames.Endpoint2,endpoint2.name=_constantsJs.IntervalObjNames.Endpoint1}(0,_UtilsChangeEndpointStatusJs.updateEndpointStatus)(selectedObj),updateIntervalRect(selectedObj,smallPot,bigPot)}function updateIntervalRect(selectedObj,point1,point2){var rectObj=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.IntervalRect),intervalLine=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.IntervalLine);(0,_UtilsUpdateVerticesJs2.default)(rectObj,point1,point2,2.4*_constantsJs.SelectBox.Height),(0,_UtilsUpdateVerticesJs2.default)(intervalLine,point1,point2,.6*_constantsJs.CircleRadius.soild)}function updateMovingInterval(selectedObj,movePoint){selectedObj.position.x=movePoint.x,selectedObj.userData.isChangeStatus=!1,selectedObj.userData.numberMark=Math.round(selectedObj.position.x/_constantsJs.NumberAxisConstData.scaleMargin),updateInterval(selectedObj)}function undateIntervalWhenMouthUp(selectedObj){selectedObj.position.x=selectedObj.userData.numberMark*_constantsJs.NumberAxisConstData.scaleMargin,updateInterval(selectedObj)}function allIntervals(){for(var intervalGroup=[],i=0;i<_threeMangerJs.intersectObjs.length;i++)_threeMangerJs.intersectObjs[i].name!=_constantsJs.IntervalObjNames.Endpoint1&&_threeMangerJs.intersectObjs[i].name!=_constantsJs.IntervalObjNames.Endpoint2||intervalGroup.push(_threeMangerJs.intersectObjs[i]);return intervalGroup}function movingIntervalCombinInterval(selectedObj){var smallEndpoint=void 0,bigEndpoint=void 0;selectedObj.name==_constantsJs.IntervalObjNames.Endpoint1?(smallEndpoint=selectedObj,bigEndpoint=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2)):(smallEndpoint=selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),bigEndpoint=selectedObj),smallEndpoint.userData.numberMark==bigEndpoint.userData.numberMark&&(smallEndpoint.userData.statusIndex=0,bigEndpoint.userData.statusIndex=0,(0,_UtilsChangeEndpointStatusJs.updateEndpointStatus)(smallEndpoint),
(0,_UtilsChangeEndpointStatusJs.updateEndpointStatus)(bigEndpoint));var intervalPoints=allIntervals();removeObj(smallEndpoint,intervalPoints),removeObj(bigEndpoint,intervalPoints);for(var inEndpoints=[],i=0;i<intervalPoints.length;i++){var endPointNumMark=intervalPoints[i].userData.numberMark;smallEndpoint.userData.numberMark<=endPointNumMark&&endPointNumMark<=bigEndpoint.userData.numberMark&&inEndpoints.push(intervalPoints[i])}selectedObj.name==_constantsJs.IntervalObjNames.Endpoint1?moveSmallEndpointCombinInterval(smallEndpoint,bigEndpoint,inEndpoints):moveBigEndpointCombinInterval(smallEndpoint,bigEndpoint,inEndpoints)}function moveBigEndpointCombinInterval(rangeEndpoint1,rangeEndpoint2,endpointsGroup){if(rangeEndpoint1.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle||rangeEndpoint2.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle)for(var _i=0;_i<endpointsGroup.length;_i++)endpointsGroup[_i].userData.numberMark==rangeEndpoint2.userData.numberMark&&endpointsGroup[_i].userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle&&rangeEndpoint2.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle?removeObj(endpointsGroup[_i],endpointsGroup):endpointsGroup[_i].userData.numberMark==rangeEndpoint1.userData.numberMark&&endpointsGroup[_i].name==_constantsJs.IntervalObjNames.Endpoint2&&removeObj(endpointsGroup[_i],endpointsGroup);if(0!=endpointsGroup.length){var maxPointGroup=[];if(maxPointGroup=inMaxEndpoints(endpointsGroup),0!=maxPointGroup.length){var tempEndpoint=maxPointGroup[0];maxPointGroup.push(rangeEndpoint2);for(var i=1;i<maxPointGroup.length;i++)maxPointGroup[i].userData.numberMark==tempEndpoint.userData.numberMark&&maxPointGroup[i].userData.statusIndex==_constantsJs.StatusIndex.SoildCircle?tempEndpoint=maxPointGroup[i]:maxPointGroup[i].userData.numberMark>tempEndpoint.userData.numberMark&&(tempEndpoint=maxPointGroup[i]);var maxEndpoint=tempEndpoint.clone();maxEndpoint.userData.isSingle=!1;var endpoint1=rangeEndpoint1.clone();removeCombinObj(maxPointGroup),(0,_UtilsDrawIntervalJs2.default)(endpoint1,maxEndpoint),undateIntervalWhenMouthUp(maxEndpoint)}}}function moveSmallEndpointCombinInterval(rangeEndpoint1,rangeEndpoint2,endpointsGroup){if(rangeEndpoint1.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle||rangeEndpoint2.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle)for(var _i2=0;_i2<endpointsGroup.length;_i2++)endpointsGroup[_i2].userData.numberMark==rangeEndpoint1.userData.numberMark&&endpointsGroup[_i2].userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle&&rangeEndpoint1.userData.statusIndex==_constantsJs.StatusIndex.EmptyCircle?removeObj(endpointsGroup[_i2],endpointsGroup):endpointsGroup[_i2].userData.numberMark==rangeEndpoint2.userData.numberMark&&endpointsGroup[_i2].name==_constantsJs.IntervalObjNames.Endpoint1&&removeObj(endpointsGroup[_i2],endpointsGroup);if(0!=endpointsGroup.length){var minPointGroup=[];if(minPointGroup=inMinEndpoints(endpointsGroup),0!=minPointGroup.length){var tempEndpoint=minPointGroup[0];minPointGroup.push(rangeEndpoint1);for(var i=0;i<minPointGroup.length;i++)minPointGroup[i].userData.numberMark==tempEndpoint.userData.numberMark&&minPointGroup[i].userData.statusIndex==_constantsJs.StatusIndex.SoildCircle?tempEndpoint=minPointGroup[i]:minPointGroup[i].userData.numberMark<tempEndpoint.userData.numberMark&&(tempEndpoint=minPointGroup[i]);if(tempEndpoint){var minEndpoint=tempEndpoint.clone();minEndpoint.userData.isSingle=!1;var endpoint2=rangeEndpoint2.clone();removeCombinObj(minPointGroup),(0,_UtilsDrawIntervalJs2.default)(minEndpoint,endpoint2),undateIntervalWhenMouthUp(minEndpoint)}}}}function inMaxEndpoints(endpointsGroup){for(var maxPointGroup=[],i=0;i<endpointsGroup.length;i++)if(endpointsGroup[i].name==_constantsJs.IntervalObjNames.Endpoint1)if(endpointsGroup[i].userData.isSingle)maxPointGroup.push(endpointsGroup[i]);else{var endpoint2=endpointsGroup[i].parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);maxPointGroup.push(endpoint2)}return maxPointGroup}function inMinEndpoints(endpointsGroup){for(var minPointGroup=[],i=0;i<endpointsGroup.length;i++)if(endpointsGroup[i].name==_constantsJs.IntervalObjNames.Endpoint1&&endpointsGroup[i].userData.isSingle)minPointGroup.push(endpointsGroup[i]);else if(endpointsGroup[i].name==_constantsJs.IntervalObjNames.Endpoint2){var endpoint1=endpointsGroup[i].parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1);minPointGroup.push(endpoint1)}return minPointGroup}function removeCombinObj(endpointGroup){for(var i=0;i<endpointGroup.length;i++)removeFromIntersectObjs(endpointGroup[i]),_threeMangerJs.scene.remove(endpointGroup[i].parent),(0,_UtilsDestroyThreeObjectJs2.default)(endpointGroup[i].parent)}function removeInterval(obj){removeFromIntersectObjs(obj),_threeMangerJs.scene.remove(obj.parent),(0,_UtilsDestroyThreeObjectJs2.default)(obj.parent)}function removeFromIntersectObjs(obj){if(obj.userData.isSingle)removeObj(obj);else{var intervalGroup=obj.parent,endpoint1=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),intervalRect=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.IntervalRect),endpoint2=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2),deleteBtn=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.DeleteBtn);removeObj(endpoint1),removeObj(intervalRect),removeObj(endpoint2),deleteBtn&&removeObj(deleteBtn)}}function removeObj(Obj,objsArray){objsArray||(objsArray=_threeMangerJs.intersectObjs);var index=$.inArray(Obj,objsArray);index!=-1&&objsArray.splice(index,1)}function twoEndpointCoincide(endpoint){var intervalGroup=endpoint.parent,endpoint1=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),intervalRect=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.IntervalRect);if(intervalRect){var endpoint2=intervalGroup.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2);endpoint1.userData.numberMark==endpoint2.userData.numberMark&&(intervalGroup.remove(endpoint2),intervalGroup.remove(intervalRect),removeObj(endpoint2),removeObj(intervalRect),(0,_UtilsDestroyThreeObjectJs2.default)(endpoint2),(0,_UtilsDestroyThreeObjectJs2.default)(intervalRect),endpoint1.userData.isSingle=!0,endpoint1.userData.statusIndex=0,(0,_UtilsChangeEndpointStatusJs.updateEndpointStatus)(endpoint1))}}function updateMovingpoint(selectedObj,movingPoint){var otherEndpoint=void 0;if(otherEndpoint=selectedObj.name==_constantsJs.IntervalObjNames.Endpoint1?selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint2):selectedObj.parent.getObjectByName(_constantsJs.IntervalObjNames.Endpoint1),Math.abs(otherEndpoint.userData.numberMark)>20){var instance=.5*(_constantsJs.NumberAxisConstData.scaleCount-3)*_constantsJs.NumberAxisConstData.scaleMargin;otherEndpoint.position.x>0&&movingPoint.x>instance?(selectedObj.position.x=instance,movingPoint.x=selectedObj.position.x):otherEndpoint.position.x<0&&movingPoint.x<-instance&&(selectedObj.position.x=-instance,movingPoint.x=selectedObj.position.x)}return movingPoint}Object.defineProperty(exports,"__esModule",{value:!0}),exports.addLineAndAnotherEndpoint=addLineAndAnotherEndpoint,exports.updateInterval=updateInterval,exports.updateMovingInterval=updateMovingInterval,exports.undateIntervalWhenMouthUp=undateIntervalWhenMouthUp,exports.allIntervals=allIntervals,exports.movingIntervalCombinInterval=movingIntervalCombinInterval,exports.removeInterval=removeInterval,exports.twoEndpointCoincide=twoEndpointCoincide,exports.updateMovingpoint=updateMovingpoint;var _shapeCreatIntervalLineJs=__webpack_require__(27),_shapeCreatIntervalLineJs2=_interopRequireDefault(_shapeCreatIntervalLineJs),_UtilsAddIntervalJs=__webpack_require__(26),_UtilsAddIntervalJs2=_interopRequireDefault(_UtilsAddIntervalJs),_UtilsUpdateVerticesJs=__webpack_require__(9),_UtilsUpdateVerticesJs2=_interopRequireDefault(_UtilsUpdateVerticesJs),_constantsJs=__webpack_require__(5),_UtilsChangeEndpointStatusJs=__webpack_require__(25),_threeMangerJs=__webpack_require__(4),_UtilsDrawIntervalJs=__webpack_require__(33),_UtilsDrawIntervalJs2=_interopRequireDefault(_UtilsDrawIntervalJs),_UtilsDestroyThreeObjectJs=__webpack_require__(7),_UtilsDestroyThreeObjectJs2=_interopRequireDefault(_UtilsDestroyThreeObjectJs)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _shapeIntervalEndpointJs=__webpack_require__(24),_shapeCreatIntervalLineJs=(_interopRequireDefault(_shapeIntervalEndpointJs),__webpack_require__(27)),_shapeCreatIntervalLineJs2=_interopRequireDefault(_shapeCreatIntervalLineJs),_constantsJs=__webpack_require__(5),_threeMangerJs=__webpack_require__(4),_shapeCreatIntervalGroupJs=__webpack_require__(31),_shapeCreatIntervalGroupJs2=_interopRequireDefault(_shapeCreatIntervalGroupJs);exports.default=function(endpoint1,endpoint2){var intervalGroup=(0,_shapeCreatIntervalGroupJs2.default)();intervalGroup.add(endpoint1),(0,_shapeCreatIntervalLineJs2.default)(endpoint1.position,endpoint2.position,intervalGroup),intervalGroup.add(endpoint2),_threeMangerJs.intersectObjs.push(endpoint1),_threeMangerJs.intersectObjs.push(endpoint2),endpoint1.position.x<=endpoint2.position.x?(endpoint1.name=_constantsJs.IntervalObjNames.Endpoint1,endpoint2.name=_constantsJs.IntervalObjNames.Endpoint2):(endpoint1.name=_constantsJs.IntervalObjNames.Endpoint2,endpoint2.name=_constantsJs.IntervalObjNames.Endpoint1),_threeMangerJs.scene.add(intervalGroup)},module.exports=exports.default},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(state){var currentState;state&&(currentState=JSON.parse(state))},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(){var time=(new Date).valueOf(),state={module_id:_presenter2.default.model.ID,submitStatus:_presenter2.default.submitStatus,time:time,submitTime:_presenter2.default.submitTime};return JSON.stringify(state)},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(path){_presenter2.default.path=path},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _moduleControlJs=__webpack_require__(15);exports.default=function(){(0,_moduleControlJs.moduleClose)()},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(){var question_id="",question_url="";if(void 0!==_presenter2.default.model)try{question_id=_presenter2.default.model.question_id,question_url=JSON.stringify(_presenter2.default.model.question_url)}catch(e){}return{id:question_id,dispatchOnly:!0,type_code:"nd_intervalproblem",type_name:"区间题",url:question_url}},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(controller){_presenter2.default.controller=controller,_presenter2.default.eventBus=controller.getEventBus(),_presenter2.default.eventBus.addEventListener("SyncCallback",_presenter2.default),_presenter2.default.eventBus.addEventListener("PageLoaded",_presenter2.default),_presenter2.default.eventBus.addEventListener("AnswerSubmitterEvent",_presenter2.default),_presenter2.default.eventBus.addEventListener("ExamCallback",_presenter2.default),_presenter2.default.eventBus.addEventListener("Exam",_presenter2.default),_presenter2.default.eventBus.addEventListener("TaskInfoCallback",_presenter2.default)},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_submitControl=__webpack_require__(17),_timer=__webpack_require__(19);exports.default=function(eventName,eventData){switch(eventName){case"SyncCallback":SyncCallback(eventData);break;case"PageLoaded":break;case"AnswerSubmitterEvent":if("finished"==eventData.event&&eventData.source==_presenter2.default.model.ID){var stopTime=_timer.AxisTimer.stop();"finished"!=_presenter2.default.submitStatus&&"result"!=_presenter2.default.submitStatus&&(0,_submitControl.showAlert)("student"),_presenter2.default.submitTime=stopTime,"result"!=_presenter2.default.submitStatus&&(_presenter2.default.submitStatus="finished")}"undo"==eventData.event&&eventData.source==_presenter2.default.model.ID&&"finished"!=_presenter2.default.submitStatus&&"result"!=_presenter2.default.submitStatus&&(_presenter2.default.submitStatus="undo"),"do"==eventData.event&&eventData.source==_presenter2.default.model.ID&&"finished"!=_presenter2.default.submitStatus&&"result"!=_presenter2.default.submitStatus&&(_presenter2.default.submitStatus="do"),"success"==eventData.event&&eventData.source==_presenter2.default.model.ID&&(0,_submitControl.recordSubmitAnswer)();break;case"ExamCallback":"result"==eventData.type&&"classroomStudentDispatcher"==eventData.source&&eventData.value&&eventData.value.isRecover&&(_presenter2.default.isStudentMobile&&(0,_submitControl.examCallBack)(eventData),_presenter2.default.submitStatus="result");break;case"TaskInfoCallback":if("exam"==eventData.item&&"query"==eventData.type){var startTimestamp=eventData.value.startTimestamp;startTimestamp=0==startTimestamp?(new Date).getTime():startTimestamp,(0,_timer.startTimer)(startTimestamp)}}};var SyncCallback=function(eventData){var type=eventData.type,value=eventData.value,$button=$(_presenter2.default.view).find(".js-stop-sync-button");switch(type){case"request":_presenter2.default.syncId=value.syncId,value.result?$button.show():window.ClassroomUtils.showTipMessageBox("同步题目失败");break;case"cancel":value.result?$button.hide():window.ClassroomUtils.showMessageBox([{html:"关闭"},{html:"重试",target:"h5",callback:{eventName:"IntervalProblem",eventData:{source:_presenter2.default.model.ID,item:"retry"}}}],"结束任务失败！")}};module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function showInterval(view,model){var intervals=model.question_url.content.intervals,html="";intervals.length>2&&(html+="<em>(</em>");var index=0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=intervals[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var interval=_step.value;interval.addType&&(html+="0"===interval.addType?"&cup;":"&cap;"),html+="0"===interval.min.contain?"(":"[",html+=""===interval.min.num?"-&infin;":interval.min.num,html+=",",html+=""===interval.max.num?"+&infin;":interval.max.num,html+="0"==interval.max.contain?")":"]",intervals.length>2&&1==index&&(html+="<em>)</em>"),index++}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}$(view).find(".text").html(html);var title=model.question_url.title;$(view).find(".interval_title").find("span").html(title)}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter),_EventDocumentEvent=__webpack_require__(23),_EventDocumentEvent2=_interopRequireDefault(_EventDocumentEvent),_timer=__webpack_require__(19);exports.default=function(view,model){showInterval(view,model),(0,_EventDocumentEvent2.default)(),(_presenter2.default.isStudentMobile||_presenter2.default.isWeb||_presenter2.default.isPPTShell||_presenter2.default.isTeacherPc)&&(0,_timer.initTimer)()},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function drawPoint(num,contain){var endPot=new _shapeIntervalEndpointJs2.default;return endPot.position.x=num*_constantsJs.NumberAxisConstData.scaleMargin,endPot.position.z=1,Math.abs(num)<=20?"1"===contain?(0,_UtilsChangeEndpointStatusJs.showSoildCircle)(endPot):(0,_UtilsChangeEndpointStatusJs.showEmptyCircle)(endPot):(endPot.userData.numberMark=num,(0,_UtilsChangeEndpointStatusJs.showTriangle)(endPot)),_threeMangerJs.scene.add(endPot),endPot}Object.defineProperty(exports,"__esModule",{value:!0});var _shapeIntervalEndpointJs=__webpack_require__(24),_shapeIntervalEndpointJs2=_interopRequireDefault(_shapeIntervalEndpointJs),_threeMangerJs=__webpack_require__(4),_constantsJs=__webpack_require__(5),_UtilsChangeEndpointStatusJs=__webpack_require__(25),_shapeCreatIntervalLineJs=__webpack_require__(27),_shapeCreatIntervalLineJs2=_interopRequireDefault(_shapeCreatIntervalLineJs);exports.default=function(answer){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=answer[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var interval=_step.value;if(interval.min.num===interval.max.num&&""!==interval.min.num){var endPot=new _shapeIntervalEndpointJs2.default;endPot.position.x=interval.min.num*_constantsJs.NumberAxisConstData.scaleMargin,_threeMangerJs.scene.add(endPot)}else{var minNum=interval.min.num;""===minNum&&(minNum=-21);var minPot=drawPoint(minNum,interval.min.contain),maxNum=interval.max.num;""===maxNum&&(maxNum=21);var maxPot=drawPoint(maxNum,interval.max.contain);(0,_shapeCreatIntervalLineJs2.default)(minPot.position,maxPot.position,_threeMangerJs.scene)}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(action){if(!_presenter2.default.isStudentMobile)return!1;action=action||"undo";var timerId=window.setInterval(function(){var answerSubmitter=player.getPlayerServices().getToolbarModule("AnswerSubmitter")||player.getPlayerServices().getModule("AnswerSubmitter");null!=answerSubmitter&&(window.clearInterval(timerId),_presenter2.default.eventBus.sendEvent("AnswerSubmitterRecoverState",{source:_presenter2.default.model.ID,action:action}))})},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isAnySystem(systemMap){switch(systemMap){case"homework":_presenter2.default.isHomeWork=!0;break;case"pptshell":_presenter2.default.isPPTShell=!0;break;default:_presenter2.default.isHomeWork=!1}}Object.defineProperty(exports,"__esModule",{value:!0});var _presenter=__webpack_require__(1),_presenter2=_interopRequireDefault(_presenter);exports.default=function(urlParams){urlParams.sys&&isAnySystem(urlParams.sys)},module.exports=exports.default}]);define("intervalproblem/directive/presenter",function(){}),define("intervalproblem/directive/intervalproblem.directive",["components/site-directive/assets-select/assets-select","components/site-directive/error-tip/error-tip","components/site-directive/edit-box/new-edit-box","components/site-directive/foot-tool/time-box/new-time-box","components/site-directive/foot-tool/foot-tool","intervalproblem/directive/interval-item/interval-item","intervalproblem/directive/presenter"],function(){}),define(["app","intervalproblem/directive/intervalproblem.directive","threejs","threejs_projector","threejs_canvasrender","threex_dynamictexture"],function(app){"use strict";app.controller("intervalproblem_ctrl",["$scope","skin_service","$stateParams","CustomEditorService","$rootScope","$filter","$timeout",function($scope,skin_service,$stateParams,CustomEditorService,$rootScope,$filter,$timeout){function getResultInterval(items){var interval;if(1==items.length)return items[0].isBlank?[]:items;for(var i=0;i<items.length;i++){var item=items[i];""===item.min.num&&(item.min.num=-21),""===item.max.num&&(item.max.num=21),item.min.num=1*item.min.num,item.max.num=1*item.max.num}for(var i=1;i<items.length;i++){if(items[i]&&0==items[i].addType)if(interval)if(interval.length>0){for(var temp,temps=[],j=0;j<interval.length;j++)!temp||temp.length>1?(temp&&temp.length>1&&temps.pop(),temp=getUnion(interval[j],items[i]),temps=temps.concat(temp)):(temp=getUnion(temp[0],interval[j]),temps=temp);interval=temps}else interval=getUnion(null,items[i]);else interval=getUnion(items[i-1],items[i]);if(items[i]&&1==items[i].addType)if(interval){if(interval.length>0){for(var temps=[],j=0;j<interval.length;j++)temps=temps.concat(getIntersection(interval[j],items[i]));interval=temps}}else interval=getIntersection(items[i-1],items[i])}for(var i=0;i<items.length;i++){var item=items[i];item.min.num==-21&&(item.min.num=""),21==item.max.num&&(item.max.num="")}for(var i=0;i<interval.length;i++){var item=interval[i];item.min.num==-21&&(item.min.num=""),21==item.max.num&&(item.max.num="")}return interval}function getIntersection(inter,inter2){if(!inter)return[];if(inter.isBlank||inter2.isBlank)return[];if(inter2.min.num>inter.max.num||inter2.min.num==inter.max.num&&("0"==inter2.min.contain||"0"==inter.max.contain)||inter.min.num>inter2.max.num||inter.min.num==inter2.max.num&&("0"==inter.min.contain||"0"==inter2.max.contain))return[];var min={},max={};return min=inter.min.num>inter2.min.num||inter.min.num==inter2.min.num&&"0"==inter.min.contain?inter.min:inter2.min,max=inter.max.num<inter2.max.num||inter.max.num==inter2.max.num&&"0"==inter.max.contain?inter.max:inter2.max,[{min:min,max:max}]}function getUnion(inter,inter2){if(!inter)return inter2.isBlank?[]:[inter2];if(inter.isBlank&&inter2.isBlank)return[];if(inter.isBlank&&!inter2.isBlank)return[inter2];if(!inter.isBlank&&inter2.isBlank)return[inter];if(inter2.min.num>inter.max.num||inter2.min.num==inter.max.num&&"0"==inter2.min.contain&&"0"==inter.max.contain||inter.min.num>inter2.max.num||inter.min.num==inter2.max.num&&"0"==inter.min.contain&&"0"==inter2.max.contain)return[inter,inter2];var min={},max={};return min=inter.min.num<inter2.min.num||inter.min.num==inter2.min.num&&"1"==inter.min.contain?inter.min:inter2.min,max=inter.max.num>inter2.max.num||inter.max.num==inter2.max.num&&"1"==inter.max.contain?inter.max:inter2.max,[{min:min,max:max}]}$rootScope.moduleScope=$scope,$scope.errorModel={},$scope.presenter,$scope.model={id:"",module_code:"nd_intervalproblem",title:"",skin:{code:"wood",css_url:"",name:$filter("translate")("app.skin.wood"),package_url:""},timer:{timer_type:"sequence",time_minute:"0",time_second:"0"},properties:[{name:"question_id",display_name:"题目ID",type:"string",value:"",is_localized:!1},{name:"question_url",display_name:"题目内容",type:"jsonFile",value:"",is_localized:!1}],content:{displayHtml:"",intervals:[{min:{num:"",contain:"0"},max:{num:"",contain:"0"}}],answer:""}},$scope.defaultTitleSetting={isCleared:!1,title:$filter("translate")("interval.default.title")},$scope.model.title=$scope.defaultTitleSetting.title,$scope.previewAnswer=function(){$scope.validPostData()&&($scope.presenter?($scope.presenter.destroy(),$scope.presenter.run(document.body,$scope.model)):($scope.presenter=new AddonIntervalProblem_create,$scope.presenter.run(document.body,$scope.model)),$scope.presenter.previewAnswer($scope.model.content.answer))};var loadingData=function(id){$scope.isloadingData=!0,CustomEditorService.getQuestionInfoById(id).then(function(rtnData){rtnData?(""!=rtnData.skin.code?$scope.model=$scope.decodeData(rtnData,!0):$scope.model.id=rtnData.id,skin_service.set_skin_by_code($scope.model.skin.code,"v1"),$scope.errorModel.errorText="",$scope.isloadingData=!1,$stateParams.isPreview&&$timeout($scope.previewAnswer,300)):$scope.errorModel.errorText=$filter("translate")("app.unvalidno")},function(error){$scope.errorModel.errorText=$filter("translate")("app.question.get.error")})};$stateParams.id?loadingData($stateParams.id):skin_service.set_skin_by_code($scope.model.skin.code,"v1"),$scope.$on("changgedSkin",function(){$rootScope.scaleHtml()}),$scope.validPostData=function(){for(var items=$scope.model.content.intervals,i=0;i<items.length;i++){var item=items[i];if(item.isBlank=!1,""!==item.min.num&&""!==item.max.num){if(item.min.num-0>item.max.num-0)return $scope.errorModel.errorText=$filter("translate")("interval.validation.msg2"),!1;item.min.num-0!==item.max.num-0||"0"!=item.min.contain&&"0"!=item.max.contain||(item.isBlank=!0)}}var answer=getResultInterval(items);return $scope.model.content.answer=answer,!0},$scope.encodeData=function(model){return""==model.title&&(model.title=$filter("translate")("interval.default.title")),model},$scope.decodeData=function(model,isInitLoad){return model},$scope.btnOnkeyPress=function(event){event.preventDefault(),event.stopPropagation()}}])});