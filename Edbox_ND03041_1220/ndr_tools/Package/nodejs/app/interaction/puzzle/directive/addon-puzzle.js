var AddonThree2DPuzzle_create=function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){e.exports=a(1)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){return i.default},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3),r=n(i),o=a(33),c=n(o),s=a(34),l=n(s),u=a(35),d=n(u),f=a(36),h=n(f),p=a(37),m=a(38),v=n(m),y=a(39),E=n(y),g=a(40),T=n(g),M=a(30),b=n(M),_=n(p),O=a(7);t.default={run:r.default,destroy:h.default,setState:c.default,getState:l.default,setBasePath:d.default,getLengthArray:p.getLengthArray,initViewPre:p.initViewPre,initViewPrepareLessons:_.default,getQuestionInfo:v.default,setPlayerController:E.default,onEventReceived:T.default,initTeacherMobile:O.initTeacherMobile,initStudentMobile:O.initStudentMobile,pageShow:b.default},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t){(0,i.default)(e,t,!1)},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),r=a(2),o=n(r),c=a(12),s=n(c),l=(a(6),a(7)),u=(n(l),a(30));n(u);t.default=function(e,t,a){o.default.model=t,o.default.view=e,$(e).find("img").each(function(){$(this).attr("src",o.default.path+$(this).attr("data-src"))}),(0,i.threeStart)(),(0,s.default)()},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){p();var e=$(D.default.view).find(".jigsaw_bd").get(0);O.REAL_ESTATE.width=$(e).width(),O.REAL_ESTATE.height=$(e).height(),O.REAL_ESTATE.offsetLeft=$(e).offset().left,O.REAL_ESTATE.offsetTop=$(e).offset().top,O.CONSTRAINT.xmin=-O.REAL_ESTATE.width/2+2,O.CONSTRAINT.xmax=O.REAL_ESTATE.width/2-2,O.CONSTRAINT.ymin=-O.REAL_ESTATE.height/2+2,O.CONSTRAINT.ymax=O.REAL_ESTATE.height/2-2,t.renderer=v=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),v.setClearColor(16777215,0),v.setSize(O.REAL_ESTATE.width,O.REAL_ESTATE.height),e.appendChild(v.domElement)}function r(){t.scene=y=new THREE.Scene}function o(){t.matchstick=b=new I.default}function c(){t.camera=E=new THREE.OrthographicCamera(O.REAL_ESTATE.width/-2,O.REAL_ESTATE.width/2,O.REAL_ESTATE.height/2,O.REAL_ESTATE.height/-2,-2e4,2e4),E.position.x=0,E.position.y=0,E.position.z=500,E.lookAt({x:0,y:0,z:0})}function s(){t.raycaster=g=new THREE.Raycaster,g.linePrecision=1,t.intersectObjs=T=new Array,t.mouse=M=new THREE.Vector2}function l(){var e=new THREE.Mesh(new THREE.PlaneBufferGeometry(O.REAL_ESTATE.width,O.REAL_ESTATE.height,2,2),new THREE.MeshBasicMaterial({color:16711680,transparent:!0,opacity:0}));e.name="boundary",y.add(e)}function u(){_=requestAnimationFrame(u),d()}function d(){v.render(y,E)}function f(){i(),c(),r(),s(),u(),l(),o();var e=new THREE.DirectionalLight;e.position.set(2,5,3),y.add(e)}function h(e,t){var a=b.createShape(e,t);y.add(a)}function p(e,t){var a=$(D.default.view).find(".jigsaw_bd").offset();O.REAL_ESTATE.offsetLeft=a.left,O.REAL_ESTATE.offsetTop=a.top}function m(){(0,x.default)(E),(0,x.default)(y),(0,x.default)(v),$(v.domElement).remove(),$(v.domElement).splice(0),$(v.domElement)[0]=null,t.renderer=v=null,t.camera=E=null,t.mouse=M=null,t.scene=y=null,t.raycaster=g=null,t.intersectObjs=T=null,cancelAnimationFrame(_)}Object.defineProperty(t,"__esModule",{value:!0}),t.threeStart=f,t.addThreeShape=h,t.resizeThree=p,t.destroyThree=m;var v,y,E,g,T,M,b,_,O=a(6),R=a(2),D=n(R),w=a(8),I=n(w),A=a(19),x=n(A);t.renderer=v,t.scene=y,t.camera=E,t.raycaster=g,t.intersectObjs=T,t.mouse=M,t.matchstick=b},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){if(!g){var e=new THREE.TextureLoader;e.setCrossOrigin("anonymous");var t=e.load(l.default.path+"resources/rotation.png");g=new THREE.MeshBasicMaterial({map:t,transparent:!0})}return g}function r(){if(!T){var e=new THREE.TextureLoader;e.setCrossOrigin("anonymous");var t=e.load(l.default.path+"resources/move.png");T=new THREE.MeshBasicMaterial({map:t,transparent:!0})}return T}Object.defineProperty(t,"__esModule",{value:!0}),t.getRotationMaterial=i,t.getMoveMaterial=r;var o=a(7),c=n(o),s=a(2),l=n(s),u={width:776,height:487,offsetLeft:199.328125,offsetTop:57.53125};t.REAL_ESTATE=u;t.TOOLBAR_HEIGHT=48;var d={xmin:-u.width/2+2,xmax:u.width/2-2,ymin:-u.height/2+2,ymax:u.height/2-2};t.CONSTRAINT=d;t.ROTATE_HANDLER_RADIUS=10;var f={move:"move",rotate:"rotate",connect:"connect",split:"split",close:"close",stretching:"stretching",transform:"transform"};t.ACTION_TYPE=f;t.callNativePath="com.nd.pad.icr.ui.IcrJsBridge";var h={TEACHER:"teacher",STUDENT:"student"};t.initType=h;t.addonName="Puzzle";var p=window.icCreatePlayer&&c.default===window.icCreatePlayer.RUNTIME.TEACHER_MOBILE;t.isTeacherMobile=p;var m=window.icCreatePlayer&&c.default===window.icCreatePlayer.RUNTIME.STUDENT_MOBILE;t.isStudentMobile=m;var v=window.icCreatePlayer&&c.default===window.icCreatePlayer.RUNTIME.PROJECTION_MOBILE;t.isProjectionMobile=v;var y=window.icCreatePlayer&&c.default===window.icCreatePlayer.RUNTIME.WEB;t.isWeb=y;var E=window.icCreatePlayer&&c.default===window.icCreatePlayer.RUNTIME.TEACHER_PC;t.isTeacherPc=E;var g=void 0,T=void 0},function(e,t,a){"use strict";function n(){l.default.isTeacherMobile=!0}function i(){l.default.isStudentMobile=!0}function r(){l.default.isProjectionMobile=!0}function o(){l.default.isWeb=!0}function c(){l.default.isTeacherPc=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.initTeacherMobile=n,t.initStudentMobile=i,t.initProjectionMobile=r,t.initWeb=o,t.initTeacherPc=c;var s=a(2),l=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={initTeacherMobile:n,initStudentMobile:i,initProjectionMobile:r,initWeb:o,initTeacherPc:c}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(9),o=function(e){return e&&e.__esModule?e:{default:e}}(r),c=a(6),s=a(5),l=a(12),u=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?100:arguments[0],a=arguments.length<=1||void 0===arguments[1]?10:arguments[1],i=arguments.length<=2||void 0===arguments[2]?c.ROTATE_HANDLER_RADIUS:arguments[2];n(this,e),this.width=t,this.height=a,this.radius=i,this.y=0,this.stickFaceMaterial=new THREE.MeshBasicMaterial({color:15260875,transparent:!1,opacity:1}),this.stickFaceMaterial2=new THREE.MeshBasicMaterial({color:15128256,transparent:!1,opacity:1}),this.stickFaceMaterial3=new THREE.MeshBasicMaterial({color:14599846,transparent:!1,opacity:1}),this.stickFaceMaterial4=new THREE.MeshBasicMaterial({color:14203279,transparent:!1,opacity:1}),this.matchFaceMaterial=new THREE.MeshBasicMaterial({color:4098984,transparent:!1,opacity:1}),this.sMatchFaceMaterial=new THREE.MeshBasicMaterial({color:7262711,transparent:!1,opacity:1}),this.oMatchFaceMaterial=new THREE.MeshBasicMaterial({color:16438107,transparent:!1,opacity:1}),this.hMatchFaceMaterial=new THREE.MeshBasicMaterial({transparent:!0,opacity:0})}return i(e,[{key:"getStickFaceMaterial",value:function(){return this.stickFaceMaterial}},{key:"getStickFaceMaterial2",value:function(){return this.stickFaceMaterial2}},{key:"getStickFaceMaterial3",value:function(){return this.stickFaceMaterial3}},{key:"getStickFaceMaterial4",value:function(){return this.stickFaceMaterial4}},{key:"getMatchFaceMaterial",value:function(){return this.matchFaceMaterial}},{key:"getSMatchFaceMaterial",value:function(){return this.sMatchFaceMaterial}},{key:"getOMatchFaceMaterial",value:function(){return this.oMatchFaceMaterial}},{key:"getHMatchFaceMaterial",value:function(){return this.hMatchFaceMaterial}},{key:"getStickShape",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.width:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.height:arguments[1],a=new THREE.Shape,n=e/2,i=t/2;return a.moveTo(-n,-i),a.lineTo(n,-i),a.lineTo(n,i),a.lineTo(-n,i),a.moveTo(-n,-i),{stick:a,halfWidth:n}}},{key:"getMatchShape",value:function(){for(var e=new THREE.Shape,t=0;t<64;t++){var a=this.radius,n=t/64*Math.PI*2;0==t?e.moveTo(a*Math.sin(n),a*Math.cos(n)):e.lineTo(a*Math.sin(n),a*Math.cos(n))}return e}},{key:"getMatchBound",value:function(){for(var e=new THREE.Shape,t=0;t<64;t++){var a=this.radius+3,n=t/64*Math.PI*2;0==t?e.moveTo(a*Math.sin(n),a*Math.cos(n)):e.lineTo(a*Math.sin(n),a*Math.cos(n))}return e}},{key:"createShape",value:function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=arguments.length<=1||void 0===arguments[1]?new THREE.Vector2(0,0):arguments[1];this.width=20*e;var a=new THREE.Object3D,n=this.getStickShape(this.width,this.height/8).stick,i=this.getStickShape(this.width,this.height/4).stick,r=this.getStickShape(this.width,this.height/2).stick,c=this.getStickShape().stick,u=this.getMatchShape(),d=this.getMatchBound(),f=new THREE.ShapeGeometry(n,{}),h=new THREE.ShapeGeometry(i,{}),p=new THREE.ShapeGeometry(r,{}),m=new THREE.ShapeGeometry(c,{}),v=new THREE.ShapeGeometry(u,{}),y=new THREE.ShapeGeometry(d,{}),E=new THREE.Mesh(f,this.getStickFaceMaterial()),g=new THREE.Mesh(h,this.getStickFaceMaterial2()),T=new THREE.Mesh(p,this.getStickFaceMaterial3()),M=new THREE.Mesh(m,this.getStickFaceMaterial4()),b=new THREE.Mesh(v,this.getMatchFaceMaterial()),_=new THREE.Mesh(v,this.getMatchFaceMaterial()),O=new THREE.Line(y,this.getOMatchFaceMaterial()),R=new THREE.Line(y,this.getOMatchFaceMaterial());return b.position.x=-this.width/2,_.position.x=this.width/2,O.visible=!1,R.visible=!1,E.name="stick3",E.userData.height=this.height/6,E.position.z=.09,g.name="stick2",g.userData.height=this.height/4,g.position.z=.08,T.name="stick1",T.userData.height=this.height/2,T.position.z=.07,M.name="stick",M.userData.height=this.height,b.name="match1",_.name="match2",O.name="line1",R.name="line2",b.position.z=.1,_.position.z=.1,b.userData.linkState=!1,b.userData.connectId=_.id,_.userData.linkState=!1,_.userData.connectId=b.id,a.userData.width=this.width,a.userData.height=this.height,a.userData.radius=this.radius,a.name="unit",a.add(E),a.add(g),a.add(T),a.add(M),a.add(b),a.add(_),b.add(O),_.add(R),(0,l.setSelectedShape)(M),(0,l.setActivedObj)(null),s.intersectObjs.push(M),s.intersectObjs.push(b),s.intersectObjs.push(_),(0,o.default)(a,t),a}}]),e}();t.default=u,e.exports=t.default},function(e,t,a){"use strict";function n(e,t){if("unit"===e.name){var a=e.getObjectByName("match1"),i=e.getObjectByName("match2");a.userData.position=(new THREE.Vector2).addVectors(a.position,t),i.userData.position=(new THREE.Vector2).addVectors(i.position,t),(0,r.default)(e)}else if("collection"===e.name){var o=!0,c=!1,s=void 0;try{for(var l,u=e.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;n(d,t)}}catch(e){c=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(c)throw s}}}else if("moveImage"===e.name||"rotationImage"===e.name){var f=(new THREE.Vector2).addVectors(e.position,t);e.position.x=f.x,e.position.y=f.y}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=a(10),r=function(e){return e&&e.__esModule?e:{default:e}}(i);e.exports=t.default},function(e,t,a){"use strict";function n(e,t,a){if(!(e.name.indexOf("stick")<0)){var n=e.userData.height/2,r=(0,i.rotationAngleVector)(a,t,90,!0).vector.setLength(n),o=(0,i.rotationAngleVector)(a,t,90,!1).vector.setLength(n),c=[];c.push((new THREE.Vector2).addVectors(t,o)),c.push((new THREE.Vector2).addVectors(a,o)),c.push((new THREE.Vector2).addVectors(a,r)),c.push((new THREE.Vector2).addVectors(t,r));for(var s=e.geometry.vertices,l=0;l<s.length;l++)s[l].x=c[l].x,s[l].y=c[l].y;e.geometry.verticesNeedUpdate=!0,e.geometry.computeBoundingSphere()}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(11);t.default=function(e){if("unit"===e.name){var t=e.getObjectByName("match1"),a=e.getObjectByName("match2"),i=t.userData.position||t.position,r=a.userData.position||a.position;t.position.x=i.x,t.position.y=i.y,a.position.x=r.x,a.position.y=r.y;var o=!0,c=!1,s=void 0;try{for(var l,u=e.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){n(l.value,i,r)}}catch(e){c=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(c)throw s}}}},e.exports=t.default},function(e,t,a){"use strict";function n(e,t,a){return i((new THREE.Vector2).subVectors(e,t),(new THREE.Vector2).subVectors(a,t))}function i(e,t){var a=void 0,n=void 0,i=void 0,r=void 0,o=void 0,c=void 0;a=e.x,i=e.y,n=t.x,r=t.y;var s=Math.sqrt(a*a+i*i)*Math.sqrt(n*n+r*r);if(0==s)return-1;if((c=(a*n+i*r)/s)<0&&Math.abs(c)>1)return 180;if(Math.abs(c)>1)return 0;o=180*Math.acos((a*n+i*r)/s)/Math.PI;var l=e.x*t.y-e.y*t.x<0;return{angle:o*Math.PI/180,clockWise:l,angleValue:o}}function r(e,t,a){var n=Math.pow(e,2)+Math.pow(t,2)-Math.pow(a,2),i=n/(2*e*t);return 180*Math.acos(i)/Math.PI}function o(e,t){var a=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2);return Math.sqrt(a)}function c(e,t,a,i){var r=combiningPoint(e,t,a,i);if(null==r)return null;var o=r.sameDirPoint;return{leftRotation:n(e,t,o),rightRotation:n(i,a,o)}}function s(e,t,a,i){var c=o(a,t),s=o(e,t),l=o(i,a);if(c+s<=l||Math.abs(c-s)>=l)return null;var u=r(c,s,l),d=n(a,t,e),f=p(a,t,u,d.clockWise),h=f.vector.setLength(s),m=(new THREE.Vector2).addVectors(t,h),v=p(a,t,u,!d.clockWise),y=v.vector.setLength(s);return{sameDirPoint:m,differentDirPoint:(new THREE.Vector2).addVectors(t,y),clockwise:d.clockWise}}function l(e,t,a,n){var i=s(e,t,a,n);return null==i?null:i.sameDirPoint}function u(e,t,a,i,r){var o=s(e,t,a,i);if(null==o)return null;var c=n(a,t,r);return o.clockwise==c.clockWise?o.differentDirPoint:o.sameDirPoint}function d(e,t,a,i,c,s){var l=o(i,t);if(l+c<=s||Math.abs(l-c)>=s)return null;var u=n(i,t,e),d=r(l,c,s),f=p(i,t,d,u.clockWise),h=f.vector.setLength(c);return(new THREE.Vector2).addVectors(t,h)}function f(e,t,a,i,r,o,c,s,l){var u=n(r,t,i),f=(new THREE.Vector2).subVectors(r,t),h=(new THREE.Vector2).subVectors(i,t);u.angleValue>90&&(u.angleValue=180-u.angleValue,h=(new THREE.Vector2).subVectors(t,i));var p=f.length()*Math.cos(u.angleValue*Math.PI/180),m=(new THREE.Vector2).addVectors(t,h.setLength(p)),v=d(e,t,i,m,o,l),y=d(a,t,i,m,c,s);return null==v||null==y?null:{combinLeftPoint:v,combinRightPoint:y,diagonalPoint:m}}function h(e,t,a,i,c,s,l,u,d){var f=n(c,a,s),h=p(e,a,f.angleValue,f.clockWise),m=h.vector.setLength(u),v=(new THREE.Vector2).addVectors(a,m),y=o(v,i);if(l+d<=y||Math.abs(l-d)>=y)return null;var E=r(y,l,d),g=n(i,v,a),T=p(i,v,E,!g.clockWise),M=T.vector.setLength(l);return{leftPoint:v,rightPoint:(new THREE.Vector2).addVectors(v,M)}}function p(e,t,a,n){var i=new THREE.Vector2(e.x-t.x,e.y-t.y),r=void 0,o=void 0,c=a/180*Math.PI;return n?(r=i.x*Math.cos(c)+i.y*Math.sin(c)+t.x,o=i.y*Math.cos(c)-i.x*Math.sin(c)+t.y):(r=i.x*Math.cos(c)-i.y*Math.sin(c)+t.x,o=i.y*Math.cos(c)+i.x*Math.sin(c)+t.y),{point:new THREE.Vector2(r,o),vector:new THREE.Vector2(r-t.x,o-t.y)}}function m(e,t){var a=void 0,n=void 0,i=void 0,r=void 0;a=n=i=r=e[0];var o=(new THREE.Vector2(0,0),[]),c=[],s=!0,l=!1,u=void 0;try{for(var d,f=e[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;o.push(h.x),c.push(h.y)}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}a=Math.min.apply(Math,o),n=Math.max.apply(Math,o),i=Math.min.apply(Math,c),r=Math.max.apply(Math,c);var p=a+t.x-E.ROTATE_HANDLER_RADIUS,m=n+t.x+E.ROTATE_HANDLER_RADIUS,v=i+t.y-E.ROTATE_HANDLER_RADIUS,y=r+t.y+E.ROTATE_HANDLER_RADIUS;p<E.CONSTRAINT.xmin&&(a>E.CONSTRAINT.xmin+E.ROTATE_HANDLER_RADIUS?t.x=E.CONSTRAINT.xmin+E.ROTATE_HANDLER_RADIUS-a:t.x=t.x>0?t.x:0),m>E.CONSTRAINT.xmax&&(E.ROTATE_HANDLER_RADIUS+n<E.CONSTRAINT.xmax?t.x=E.CONSTRAINT.xmax-E.ROTATE_HANDLER_RADIUS-n:t.x=t.x<0?t.x:0),v<E.CONSTRAINT.ymin&&(i>E.CONSTRAINT.ymin+E.ROTATE_HANDLER_RADIUS?t.y=E.CONSTRAINT.ymin+E.ROTATE_HANDLER_RADIUS-i:t.y=t.y>0?t.y:0),y>E.CONSTRAINT.ymax&&(E.ROTATE_HANDLER_RADIUS+r<E.CONSTRAINT.ymax?t.y=E.CONSTRAINT.ymax-E.ROTATE_HANDLER_RADIUS-r:t.y=t.y<0?t.y:0),a<=E.CONSTRAINT.xmin+E.ROTATE_HANDLER_RADIUS&&n>=E.CONSTRAINT.xmax-E.ROTATE_HANDLER_RADIUS&&(t.x=0),i<E.CONSTRAINT.ymin+E.ROTATE_HANDLER_RADIUS&&r>E.CONSTRAINT.ymax-E.ROTATE_HANDLER_RADIUS&&(t.y=0)}function v(e,t,a){var n=a.angle,i=(new THREE.Vector2).subVectors(e,t),r=void 0,o=void 0;a.clockWise?(r=i.x*Math.cos(n)+i.y*Math.sin(n)+t.x,o=i.y*Math.cos(n)-i.x*Math.sin(n)+t.y):(r=i.x*Math.cos(n)-i.y*Math.sin(n)+t.x,o=i.y*Math.cos(n)+i.x*Math.sin(n)+t.y);new THREE.Vector2(r,o);return!(r<E.CONSTRAINT.xmin+E.ROTATE_HANDLER_RADIUS/2||r>E.CONSTRAINT.xmax-E.ROTATE_HANDLER_RADIUS/2||o<E.CONSTRAINT.ymin+E.ROTATE_HANDLER_RADIUS/2||o>E.CONSTRAINT.ymax-E.ROTATE_HANDLER_RADIUS/2)}function y(e,t,a){for(var n=0;n<e.length;n++){if(!v(e[n],t,a))return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.getAngle=n,t.getVectorAngle=i,t.getTriangleAngle=r,t.twoPointDistance=o,t.rotationObj=c,t.combiningPoints=s,t.triangleCombinedPoint=l,t.quadrilateralCombinedPoint=u,t.closedGraphCombiningPoint=d,t.quadrilateralDiagonalMove=f,t.quadrilateralOppositeMove=h,t.rotationAngleVector=p,t.movingBoundaryDetermination=m,t.rotationBoundaryJudgment=v,t.graphicalRotationBoundaryJudgment=y;var E=a(6)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){ee=e}function r(e){(0,K.default)(e,ne),t.selectedShape=ne=e}function o(){O.default.view.getElementsByTagName("canvas")[0].addEventListener("mousedown",s,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("touchstart",s,!1),O.default.view.addEventListener("mouseup",d,!1),O.default.view.addEventListener("touchend",d,!1)}function c(e,t){var a=e.clientY+$(O.default.view).find(".com_layout").scrollTop()+$("body").scrollTop(),n=e.clientX+$(O.default.view).find(".com_layout").scrollLeft()+$("body").scrollLeft(),i=new THREE.Vector2((n-E.REAL_ESTATE.offsetLeft)/E.REAL_ESTATE.width*2-1,-(a-E.REAL_ESTATE.offsetTop)/E.REAL_ESTATE.height*2+1);return y.raycaster.setFromCamera(i,y.camera),y.raycaster.intersectObjects(t,!0)}function s(e){var t=void 0;if(m=y.scene.getObjectByName("boundary"),e.touches){if(1!==e.touches.length)return;e.preventDefault(),t=e.changedTouches[0]}else e.preventDefault(),t=e;var a=c(t,y.intersectObjs),n=c(t,[m])[0];if(ae.startPoint=n.point,a.length>0){r(a[0].object);var i=a[0].object;switch(y.intersectObjs.current=i.parent,i.name){case"moveImage":Z=E.ACTION_TYPE.move;break;case"rotationImage":Z=E.ACTION_TYPE.rotate,ae.centerPoint=(0,b.default)(y.intersectObjs.current);break;case"stick":"collection"==y.intersectObjs.current.parent.name?(y.intersectObjs.current.parent.userData.close?4==y.intersectObjs.current.parent.userData.stick&&(Z=E.ACTION_TYPE.stretching,v=i.parent):Z=E.ACTION_TYPE.move,y.intersectObjs.current=y.intersectObjs.current.parent):Z=E.ACTION_TYPE.move;break;case"match1":case"match2":"collection"==y.intersectObjs.current.parent.name&&y.intersectObjs.current.parent.userData.close?4==y.intersectObjs.current.parent.userData.stick&&(Z=E.ACTION_TYPE.transform,y.intersectObjs.current=y.intersectObjs.current.parent,h=i):i.userData.linkState||(h=i,p=y.intersectObjs.current.getObjectById(i.userData.connectId),ae.centerPoint=p.position,Z=E.ACTION_TYPE.rotate,null!==ee?ee!=h&&ee.parent!=y.intersectObjs.current?te=!0:(ee=h,te=!1):ee=h)}(0,S.default)(y.intersectObjs.current)}else Z=E.ACTION_TYPE.split,ee=null,y.intersectObjs.current=null,h=null,p=null,r(null);O.default.view.getElementsByTagName("canvas")[0].addEventListener("mousemove",l,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("mouseup",u,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("touchend",u,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("touchcancel",u,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("touchmove",l,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("mouseout",u,!1),O.default.view.getElementsByTagName("canvas")[0].addEventListener("touchleave",u,!1)}function l(e){var t=e.changedTouches?e.changedTouches[0]:e,a=c(t,[m])[0];if(a)if(ae.movePoint=a.point,"split"!=Z){if(Math.abs(ae.movePoint.x-ae.startPoint.x)>5||Math.abs(ae.movePoint.y-ae.startPoint.y)>5){if(ee=null,te=!1,"move"==Z){ee=null,te=!1;var n=+ae.movePoint.x-ae.startPoint.x,i=+ae.movePoint.y-ae.startPoint.y,r=new THREE.Vector2(n,i);(0,A.default)(y.intersectObjs.current,r),(0,k.default)(y.intersectObjs.current,r),ae.startPoint=ae.movePoint}if("rotate"==Z||"rotateDone"==Z){var o=(0,g.getAngle)(ae.startPoint,ae.centerPoint,ae.movePoint),s=(0,w.default)(y.intersectObjs.current,ae.centerPoint,o);s&&(0,H.default)(y.intersectObjs.current,ae.centerPoint,o),ae.startPoint=ae.movePoint,Z="rotateDone"}"transform"==Z&&(0,G.default)(h,ae.movePoint),Z==E.ACTION_TYPE.stretching&&((0,X.default)(v,ae.startPoint,ae.movePoint),ae.startPoint=ae.movePoint)}}else{var l=c(t,y.intersectObjs);if(l.length>0){var u=l[0].object;y.intersectObjs.current=u.parent,u.userData.linkState&&((0,B.default)(u,y.intersectObjs.current.parent.getObjectById(u.userData.linkId)),Z="")}}}function u(e){te&&ee&&("collection"==ee.parent.parent.name&&ee.parent.parent==h.parent.parent?(Z=E.ACTION_TYPE.close,(0,Y.default)(h,ee),(0,j.addMergeIcon)(ee.parent.parent),r(h)):(Z=E.ACTION_TYPE.connect,(0,C.default)(h,ee),r(h)),ee=null,te=!1),"rotateDone"==Z&&(p&&p.userData.linkState&&(0,F.default)(p),h&&!h.userData.linkState&&r(p.parent.getObjectByName("stick"))),Z="",y.intersectObjs.current=null,h=null,p=null,ae={},O.default.view.getElementsByTagName("canvas")[0].removeEventListener("mousemove",l,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("mouseup",u,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("mouseout",u,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchmove",l,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchend",u,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchcancel",u,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchleave",u,!1)}function d(e){var t=void 0;m=y.scene.getObjectByName("boundary"),t=e.changedTouches?e.changedTouches[0]:e;var a=c(t,[m])[0];a&&O.default._stickLength&&(0,y.addThreeShape)(O.default._stickLength,a.point),O.default._stickLength=null,a||"btn_del"==e.target.className||r(null)}function f(){O.default.view.getElementsByTagName("canvas")[0]&&(O.default.view.getElementsByTagName("canvas")[0].removeEventListener("mousedown",s,!1),O.default.view.getElementsByTagName("canvas")[0].removeEventListener("touchstart",s,!1),O.default.view.removeEventListener("mouseup",d,!1),O.default.view.removeEventListener("touchend",d,!1))}Object.defineProperty(t,"__esModule",{value:!0}),t.setActivedObj=i,t.setSelectedShape=r,t.default=o,t.removeEventListerner=f;var h,p,m,v,y=a(5),E=a(6),g=a(11),T=a(13),M=(n(T),a(14)),b=n(M),_=a(2),O=n(_),R=a(7),D=(n(R),a(15)),w=n(D),I=a(16),A=n(I),x=a(17),S=n(x),j=a(18),N=a(9),k=n(N),P=a(20),B=n(P),L=a(21),H=n(L),V=a(22),C=n(V),W=a(24),F=n(W),U=a(25),z=(n(U),a(26)),Y=n(z),q=a(27),G=n(q),J=a(28),X=n(J),Q=a(29),K=n(Q),Z="",ee=null,te=!1,ae={},ne=void 0;t.selectedShape=ne},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(11);t.default=function(e,t){if(e){var a=e.parent.getObjectById(e.userData.connectId),i=e.parent.parent.getObjectById(a.userData.linkId),r=e.parent.parent.getObjectById(i.userData.connectId),o=e.parent.parent.getObjectById(e.userData.linkId),c=o.parent.getObjectById(o.userData.connectId),s=c.parent.parent.getObjectById(c.userData.linkId),l=s.parent.getObjectById(s.userData.connectId),u=(0,n.quadrilateralDiagonalMove)(i.userData.center,r.userData.center,e.userData.center,t);if(u&&(a.userData.center.x+=u.distance.x,a.userData.center.y+=u.distance.y,c.userData.center.x+=u.distance.x,c.userData.center.y+=u.distance.y,e.userData.center.x>r.userData.center.x)){var d=(0,n.rotationObj)(i.userData.center,r.userData.center,u.movingPoint,a.userData.center),f=(0,n.rotationObj)(s.userData.center,l.userData.center,u.movingPoint,c.userData.center);if(!d||!f)return;var h=d.leftRotation,p=d.rightRotation,m=f.leftRotation,v=f.rightRotation;updateVertices({object:e.parent,distanceX:u.distance.x,distanceY:u.distance.y,action:"move"}),updateVertices({object:c.parent,distanceX:u.distance.x,distanceY:u.distance.y,action:"move"}),updateVertices({object:r.parent,centerPoint:r.userData.center,angle:h.angle,clockwise:h.clockWise,action:"rotate"}),updateVertices({object:l.parent,centerPoint:l.userData.center,angle:m.angle,clockwise:m.clockWise,action:"rotate"}),updateVertices({object:e.parent,centerPoint:e.userData.center,angle:p.angle,clockwise:p.clockWise,action:"rotate"}),updateVertices({object:o.parent,centerPoint:o.userData.center,angle:v.angle,clockwise:v.clockWise,action:"rotate"})}}},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.userData.close){var t=[],a=[],n=!0,i=!1,r=void 0;try{for(var o,c=e.children[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;if("unit"==s.name){var l=s.getObjectByName("match1"),u=s.getObjectByName("match2");t.push(l.position.y),t.push(u.position.y),a.push(l.position.x),a.push(u.position.x)}}}catch(e){i=!0,r=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw r}}var d=Math.max.apply(Math,t),f=Math.max.apply(Math,a),h=Math.min.apply(Math,a),p=Math.min.apply(Math,t);return new THREE.Vector2((f+h)/2,(d+p)/2)}},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(11);t.default=function(e,t,a){var i=[];if("unit"==e.name)i.push(e.getObjectByName("match1").position,e.getObjectByName("match2").position);else for(var r=e.children,o=0;o<r.length;o++)"unit"==r[o].name&&i.push(r[o].getObjectByName("match1").position,r[o].getObjectByName("match2").position);return(0,n.graphicalRotationBoundaryJudgment)(i,t,a)},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(11);t.default=function(e,t){var a=[];if("unit"==e.name)a.push(e.getObjectByName("match1").position,e.getObjectByName("match2").position);else if("collection"==e.name)for(var i=e.children,r=0;r<i.length;r++)"unit"!=i[r].name?a.push(i[r].position):a.push(i[r].getObjectByName("match1").position,i[r].getObjectByName("match2").position);(0,n.movingBoundaryDetermination)(a,t)},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0;t.default=function(e){++a,e.position.z=a},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e.userData.close){var t=null,a=null,n=[],i=[],r=!0,o=!1,s=void 0;try{for(var l,d=e.children[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){var h=l.value;if("unit"==h.name){var p=h.getObjectByName("match1");t||(t=p),p.position.y>t.position.y&&(t=p);var m=h.getObjectByName("match2");m.position.y>t.position.y&&(t=m),n.push(p.position.y),n.push(m.position.y),i.push(p.position.x),i.push(m.position.x)}}}catch(e){o=!0,s=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw s}}a=t.parent.id;var v=t.position,y=e.getObjectById(t.userData.connectId).position,E=e.getObjectById(e.getObjectById(t.userData.linkId).userData.connectId),g=E.position,T=(0,c.getAngle)(y,v,g).clockWise,M=(0,c.rotationAngleVector)(y,v,90,!T).vector,b=new THREE.Vector2((y.x+v.x)/2,(y.y+v.y)/2),_=(new THREE.Vector2).addVectors(b,M.setLength(20)),O=new THREE.Mesh(new THREE.PlaneBufferGeometry(24,24),(0,f.getMoveMaterial)());O.position.x=_.x,O.position.y=_.y,O.name="moveImage",O.userData.matchId=t.id,u.intersectObjs.push(O),e.add(O);var R=Math.max.apply(Math,n),D=Math.max.apply(Math,i),w=Math.min.apply(Math,i),I=Math.min.apply(Math,n),A=new THREE.Vector2((D+w)/2,(R+I)/2),x=(new THREE.Vector2).subVectors(g,A),S=(new THREE.Vector2).addVectors(g,x.setLength(24)),j=new THREE.Mesh(new THREE.PlaneBufferGeometry(24,24),(0,f.getRotationMaterial)());j.name="rotationImage",j.position.x=S.x,j.position.y=S.y,j.userData.matchId=E.id,j.userData.unitId=a,u.intersectObjs.push(j),e.add(j)}}function r(e){var t=e.getObjectByName("moveImage"),a=u.intersectObjs.indexOf(t);u.intersectObjs.splice(a,1),e.remove(t),(0,l.default)(t);var n=e.getObjectByName("rotationImage"),i=u.intersectObjs.indexOf(n);u.intersectObjs.splice(i,1),e.remove(n),(0,l.default)(n)}function o(e){var t=e.getObjectByName("rotationImage"),a=e.getObjectByName("moveImage"),n=e.getObjectById(t.userData.matchId).position,i=[],r=[],o=!0,s=!1,l=void 0;try{for(var u,d=e.children[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var f=u.value;if("unit"==f.name){var h=f.getObjectByName("match1"),p=f.getObjectByName("match2");i.push(h.position.y),i.push(p.position.y),r.push(h.position.x),r.push(p.position.x)}}}catch(e){s=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}var m=Math.max.apply(Math,i),v=Math.max.apply(Math,r),y=Math.min.apply(Math,r),E=Math.min.apply(Math,i),g=new THREE.Vector2((v+y)/2,(m+E)/2),T=(new THREE.Vector2).subVectors(n,g),M=(new THREE.Vector2).addVectors(n,T.setLength(20));t.position.x=M.x,t.position.y=M.y;var b=e.getObjectById(a.userData.matchId),_=b.position,O=e.getObjectById(b.userData.connectId).position,R=e.getObjectById(e.getObjectById(b.userData.linkId).userData.connectId).position,D=(0,c.getAngle)(O,_,R).clockWise,w=(0,c.rotationAngleVector)(O,_,90,!D).vector,I=new THREE.Vector2((O.x+_.x)/2,(O.y+_.y)/2),A=(new THREE.Vector2).addVectors(I,w.setLength(24));a.position.x=A.x,a.position.y=A.y}Object.defineProperty(t,"__esModule",{value:!0}),t.addMergeIcon=i,t.removeMergeIcon=r,t.updateMergeIcon=o;var c=a(11),s=a(19),l=n(s),u=a(5),d=a(2),f=(n(d),a(6))},function(e,t){"use strict";function a(e){if(e){if(e.children&&e.children.length>0)for(var t=0;t<e.children.length;t++)a(e.children[t]);e.geometry&&e.geometry.dispose(),e.material&&(e.material.dispose(),e.material.map&&e.material.map.dispose&&e.material.map.dispose()),e=null}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a,e.exports=t.default},function(e,t,a){"use strict";function n(e,t,a,i,r){(new THREE.Vector2).subVectors(e.position,a.position).length()>2*l.ROTATE_HANDLER_RADIUS+2||(r.angleValue=3,(0,c.default)(e.parent,t.position,r),r.clockWise=!r.clockWise,(0,c.default)(a.parent,i.position,r),r.clockWise=!r.clockWise,n(e,t,a,i,r))}Object.defineProperty(t,"__esModule",{value:!0});var i=a(11),r=a(18),o=a(21),c=function(e){return e&&e.__esModule?e:{default:e}}(o),s=a(5),l=a(6);t.default=function(e,t){var a=e.parent.getObjectById(e.userData.connectId),o=t.parent.getObjectById(t.userData.connectId),c=(0,i.getAngle)(o.position,e.position,a.position),l=e.parent.parent;if(n(t,o,e,a,c),l.userData.close)l.userData.close=!1,(0,r.removeMergeIcon)(l);else if(a.userData.linkState&&o.userData.linkState){var u=l.getObjectById(o.userData.linkId).parent,d=new THREE.Object3D;d.name="collection",d.userData.stick=2,d.add(t.parent),d.add(u),l.userData.stick--,l.userData.stick--,s.scene.add(d)}else a.userData.linkState||o.userData.linkState?(a.userData.linkState?(s.scene.add(t.parent),l.remove(t.parent)):(s.scene.add(e.parent),l.remove(e.parent)),l.userData.stick--):(s.scene.add(e.parent),s.scene.add(t.parent),s.scene.remove(l));e.userData.linkState=!e.userData.linkState,e.userData.linkId=null,t.userData.linkState=!t.userData.linkState,t.userData.linkId=null},
e.exports=t.default},function(e,t,a){"use strict";function n(e,t,a){if("unit"===e.name){var i=e.getObjectByName("match1"),c=e.getObjectByName("match2");i.userData.position=(0,o.rotationAngleVector)(i.position,t,a.angleValue,a.clockWise).point,c.userData.position=(0,o.rotationAngleVector)(c.position,t,a.angleValue,a.clockWise).point,(0,r.default)(e)}else if("collection"===e.name){var s=!0,l=!1,u=void 0;try{for(var d,f=e.children[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;n(h,t,a)}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}}else if("moveImage"===e.name||"rotationImage"===e.name){var p=(0,o.rotationAngleVector)(e.position,t,a.angleValue,a.clockWise).point;e.position.x=p.x,e.position.y=p.y}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=a(10),r=function(e){return e&&e.__esModule?e:{default:e}}(i),o=a(11);e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(9),r=n(i),o=a(11),c=a(21),s=n(c),l=a(5),u=a(23),d=n(u);t.default=function(e,t){var a="collection"==e.parent.parent.name?e.parent.parent:null,n="collection"==t.parent.parent.name?t.parent.parent:null,i=a?a.userData.stick:1;if((i+=n?n.userData.stick:1)>4)return void(0,d.default)("maxStickNumError");var c=a||n||new THREE.Object3D,u=(new THREE.Vector2).subVectors(e.position,t.position),f=e.parent.getObjectById(e.userData.connectId),h=f.position,p=t.parent.getObjectById(t.userData.connectId),m=p.position,v=(0,o.getAngle)(h,e.position,m);(0,r.default)(n||t.parent,u);var y=(0,o.getAngle)(h,e.position,m);y.angleValue<5&&(0,s.default)(n||t.parent,e.position,{angleValue:10,clockWise:v.clockWise});var E=90-y.angleValue;if(Math.abs(E)<5&&0!=E){var g=E>0?y.clockWise:!y.clockWise;(0,s.default)(n||t.parent,e.position,{angleValue:Math.abs(E),clockWise:g})}if(f.userData.linkState){var T=c.getObjectById(f.userData.linkId),M=c.getObjectById(T.userData.connectId);y=(0,o.getVectorAngle)((new THREE.Vector2).subVectors(p.position,t.position),(new THREE.Vector2).subVectors(M.position,T.position)),y.angleValue<5&&(0,s.default)(n||t.parent,t.position,y),180-y.angleValue<5&&(y.angleValue=180-y.angleValue,y.clockWise=!y.clockWise,(0,s.default)(n||t.parent,t.position,y))}if(e.userData.linkState=!e.userData.linkState,e.userData.linkId=t.id,t.userData.linkState=!t.userData.linkState,t.userData.linkId=e.id,c===a)if(n){for(;n.children.length>0;)c.add(n.children[0]);c.userData.stick+=n.userData.stick,l.scene.remove(n)}else c.add(t.parent),c.userData.stick++;else c===n?(e.parent.position.z=0,c.add(e.parent),c.userData.stick++):(c.name="collection",c.userData.stick=2,e.parent.position.z=0,t.parent.position.z=0,c.add(e.parent),c.add(t.parent),l.scene.add(c))},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n),r={lengthError:"两边之和小于第三边，无法组成图形",targetError:"同一线段的两点无法再连接",maxStickNumError:"最多只能连接四根小棒",fourLengthError:"两边之和小于两固定端点的距离无法连接"};t.default=function(e){if(e){var t=$(i.default.view).find(".three2DPuzzle-tips");t.html(r[e]),t.show(150).delay(2e3).hide(200)}},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(11),i=a(21),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e){var t=e.parent.parent,a=t.getObjectById(e.userData.linkId),i=t.getObjectById(a.userData.connectId),o=t.getObjectById(e.userData.connectId),c=(0,n.getAngle)(i.position,e.position,o.position),s=90-c.angleValue;if(Math.abs(s)<5&&0!=s){var l=s>0?c.clockWise:!c.clockWise;return void(0,r.default)(e.parent,e.position,{angleValue:Math.abs(s),clockWise:l})}if(i.userData.linkState){var u=t.getObjectById(i.userData.linkId),d=t.getObjectById(u.userData.connectId);if(c=(0,n.getVectorAngle)((new THREE.Vector2).subVectors(o.position,e.position),(new THREE.Vector2).subVectors(d.position,u.position)),c.angleValue<5)return void(0,r.default)(e.parent,e.position,c);180-c.angleValue<5&&(c.angleValue=180-c.angleValue,c.clockWise=!c.clockWise,(0,r.default)(e.parent,e.position,c))}},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(6);t.default=function(e){var t=void 0,a=void 0,i=void 0,r=void 0,o=[],c=[],s=!0,l=!1,u=void 0;try{for(var d,f=e[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;o.push(h.x),c.push(h.y)}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}return t=Math.min.apply(Math,o),a=Math.max.apply(Math,o),i=Math.min.apply(Math,c),r=Math.max.apply(Math,c),t<n.CONSTRAINT.xmin+n.ROTATE_HANDLER_RADIUS||(a>n.CONSTRAINT.xmax-n.ROTATE_HANDLER_RADIUS||(i<n.CONSTRAINT.ymin+n.ROTATE_HANDLER_RADIUS||r>n.CONSTRAINT.ymax-n.ROTATE_HANDLER_RADIUS))},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(11),r=a(21),o=(n(r),a(10)),c=n(o),s=a(23),l=n(s);t.default=function(e,t){var a=e.parent.parent;if(a.userData.stick<3)return void(0,l.default)("targetError");var n=e.parent.getObjectById(e.userData.connectId),r=t.parent.getObjectById(t.userData.connectId);if(3===a.userData.stick){var o=(0,i.triangleCombinedPoint)(e.position,n.position,r.position,t.position);if(!o)return void(0,l.default)("lengthError");e.userData.position=o,t.userData.position=o,(0,c.default)(e.parent),(0,c.default)(t.parent)}else{var s=a.getObjectById(n.userData.linkId),u=a.getObjectById(s.userData.connectId),o=(0,i.quadrilateralCombinedPoint)(e.position,n.position,r.position,t.position,u.position);if(!o)return void(0,l.default)("fourLengthError");e.userData.position=o,t.userData.position=o,(0,c.default)(e.parent),(0,c.default)(t.parent)}e.userData.linkState=!e.userData.linkState,e.userData.linkId=t.id,t.userData.linkState=!t.userData.linkState,t.userData.linkId=e.id,a.userData.close=!0},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(11),r=a(18),o=a(25),c=n(o),s=a(10),l=n(s);t.default=function(e,t){var a=e.parent.parent,n=a.getObjectById(e.userData.connectId),o=a.getObjectById(n.userData.linkId),s=a.getObjectById(o.userData.connectId),u=a.getObjectById(s.userData.linkId),d=a.getObjectById(u.userData.connectId),f=a.getObjectById(d.userData.linkId),h=a.getObjectById(f.userData.connectId),p=(0,i.quadrilateralDiagonalMove)(n.position,s.position,d.position,h.position,t,o.parent.userData.width,u.parent.userData.width,f.parent.userData.width,e.parent.userData.width);if(p){var m=[p.combinLeftPoint,p.diagonalPoint,p.combinRightPoint];if(!(0,c.default)(m)){n.userData.position=p.combinLeftPoint,o.userData.position=p.combinLeftPoint,d.userData.position=p.combinRightPoint,f.userData.position=p.combinRightPoint,h.userData.position=p.diagonalPoint,e.userData.position=p.diagonalPoint;var v=!0,y=!1,E=void 0;try{for(var g,T=a.children[Symbol.iterator]();!(v=(g=T.next()).done);v=!0){var M=g.value;(0,l.default)(M)}}catch(e){y=!0,E=e}finally{try{!v&&T.return&&T.return()}finally{if(y)throw E}}(0,r.updateMergeIcon)(a)}}},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(11),r=a(18),o=a(25),c=n(o),s=a(10),l=n(s);t.default=function(e,t,a){var n=e.parent,o=e.getObjectByName("match1"),s=e.getObjectByName("match2"),u=n.getObjectById(o.userData.linkId),d=n.getObjectById(u.userData.connectId),f=n.getObjectById(d.userData.linkId),h=n.getObjectById(f.userData.connectId),p=n.getObjectById(h.userData.linkId),m=n.getObjectById(p.userData.connectId),v=(0,i.quadrilateralOppositeMove)(o.position,s.position,f.position,h.position,t,a,o.parent.userData.width,u.parent.userData.width,p.parent.userData.width);if(v){var y=[v.leftPoint,v.rightPoint];if(!(0,c.default)(y)){o.userData.position=v.leftPoint,u.userData.position=v.leftPoint,s.userData.position=v.rightPoint,m.userData.position=v.rightPoint;var E=!0,g=!1,T=void 0;try{for(var M,b=n.children[Symbol.iterator]();!(E=(M=b.next()).done);E=!0){var _=M.value;(0,l.default)(_)}}catch(e){g=!0,T=e}finally{try{!E&&b.return&&b.return()}finally{if(g)throw T}}(0,r.updateMergeIcon)(n)}}},e.exports=t.default},function(e,t,a){"use strict";function n(e){var t=!0,a=!1,i=void 0;try{for(var o,c=e.children[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){n(o.value)}}catch(e){a=!0,i=e}finally{try{!t&&c.return&&c.return()}finally{if(a)throw i}}"match1"!=e.name&&"match2"!=e.name||(e.material=r.matchstick.getSMatchFaceMaterial())}function i(e){var t=!0,a=!1,n=void 0;try{for(var o,c=e.children[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){i(o.value)}}catch(e){a=!0,n=e}finally{try{!t&&c.return&&c.return()}finally{if(a)throw n}}"match1"!=e.name&&"match2"!=e.name||(e.material=r.matchstick.getMatchFaceMaterial(),e.children[0].visible=!1),"unit"==e.name&&(e.position.z=0)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5);t.default=function(e,t){if(t){var a=t.parent.parent&&"collection"==t.parent.parent.name?t.parent.parent:t.parent;i(a),a.position.z=0}if(e){var o=e.parent.parent&&"collection"==e.parent.parent.name?e.parent.parent:e.parent;n(o),o.position.z=1}e&&e.name.indexOf("match")>=0&&(e.userData.linkState||(e.material=r.matchstick.getOMatchFaceMaterial(),e.children[0].visible=!0))},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(31),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t){(0,i.default)(t,e)},e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){T.find(".btn_del").bind("click",function(){(0,E.default)()})}function r(e){for(var t=0;t<e.length;t++){var a=e[t],n=document.createElement("a");n.className="match match_"+t;var i=document.createElement("span"),r=document.createElement("span"),c=document.createElement("span"),s=void 0;c.className="line",a>=2&&a<=7?s="match_pic match_s":a>=8&&a<=13?s="match_pic match_m":a>=14&&a<=20&&(s="match_pic match_l"),i.className=s,r.innerHTML=a+"cm",r.className="match_wit",n.appendChild(i),n.appendChild(r);var l=T.find(".threebox")[0];l.appendChild(n),l.appendChild(c),o()}}function o(){T.find(".match").bind("mousedown",c),T.find(".match").bind("touchstart",c),T.find(".match").bind("mousedown",s),T.find(".match").bind("touchstart",s)}function c(e){if(!($(this)[0].className.indexOf("match_input")>=0)){T.find(".selMatch").removeClass("selMatch"),$(this).addClass("selMatch")}}function s(e){var t=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e;if(!$(this).hasClass("match_input")){var a=$(this).offset(),n=T.find(".jigsaw_content").offset();b=parseInt(a.left-n.left,10),_=parseInt(a.top-n.top,10),R=t.clientY,O=t.clientX,D=$(this),T[0].addEventListener("mousemove",l,!1),T[0].addEventListener("touchmove",l,!1),T[0].addEventListener("mouseup",u,!1),T[0].addEventListener("touchend",u,!1),e.preventDefault()}}function l(e){var t=e.changedTouches?e.changedTouches[0]:e,a=b+(t.clientX-O),n=_+(t.clientY-R);if(M.css({top:n+"px",left:a+"px"}),D&&"none"==M.css("display")){M.show();var i=D.find(".match_wit").html();i&&""!=i||(i=T.find("#selector_dummy").val());var r=parseInt(i);v.default._stickLength=r}e.preventDefault()}function u(e){M.hide(),T[0].removeEventListener("mousemove",l,!1),T[0].removeEventListener("touchmove",l,!1),T[0].removeEventListener("mouseup",u,!1),T[0].removeEventListener("touchend",u,!1),D=null,event.preventDefault()}function d(e){var t=T.find(".js-stop-sync-button");t.style="display:block",t.bind("click",function(t){v.default.eventBus.sendEvent("Sync",{source:e.ID,type:"cancel",value:{syncId:v.default.syncId}})})}function f(){$(v.default.view).bind("resize",g.resizeThree)}function h(){T&&(T.find(".match").unbind("mousedown",c),T.find(".match").unbind("touchstart",c),T.find(".match").unbind("mousedown",s),T.find(".match").unbind("touchstart",s),T=null,M=null)}function p(){var e=T.find(".numbox").height(),t={};t.select={preset:"select"},T.find("#selector").val("").scroller("destroy").scroller($.extend(t.select,{theme:"android-ics light",mode:"scroller",height:e,display:"inline",lang:""})),T.find("#selector_dummy").val(3),T.find(".android-ics.light .dw-ul").css("margin-top",-2*e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unbindAll=h;var m=a(2),v=n(m),y=(a(6),a(32)),E=n(y),g=a(5),T=null,M=void 0;t.default=function(e,t){if(T=$(t),p(),T.find("#selector_dummy").val(3),M=T.find("#dragMatch"),o(),i(),f(),e.question_url){var a=e.question_url.content.lengthArray;T.find(".matchCount").val(a.length),r(a),v.default.isTeacherMobile?d(e):v.default.isStudentMobile&&(T.find(".twobox").remove(),T.find(".js-stop-sync-button").remove(),T.find(".jigsaw_fd").css("bottom",0))}};var b,_,O=0,R=0,D=void 0},function(e,t,a){"use strict";function n(e){var t=!0,a=!1,r=void 0;try{for(var o,c=e.children[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){n(o.value)}}catch(e){a=!0,r=e}finally{try{!t&&c.return&&c.return()}finally{if(a)throw r}}var s=i.intersectObjs.indexOf(e);s>-1&&i.intersectObjs.splice(s,1)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),r=a(19),o=function(e){return e&&e.__esModule?e:{default:e}}(r),c=a(12);t.default=function(){if(c.selectedShape){var e="collection"==c.selectedShape.parent.parent.name?c.selectedShape.parent.parent:c.selectedShape.parent;i.scene.remove(e),n(e),(0,o.default)(e),(0,c.setSelectedShape)(null),(0,c.setActivedObj)(null)}},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e&&JSON.parse(e)},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){return JSON.stringify({module_id:i.default.model.ID})},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){i.default.path=e},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(12),i=a(31),r=a(5);t.default=function(){(0,n.removeEventListerner)(),(0,r.destroyThree)(),(0,i.unbindAll)()},e.exports=t.default},function(e,t){"use strict";function a(e){for(var t=0;t<e.length;t++){var a=e[t],n=document.createElement("a");n.className="match match_"+t;var i=document.createElement("span"),r=document.createElement("span"),c=document.createElement("span"),s=void 0;c.className="line",a>=2&&a<=7?s="match_pic match_s":a>=8&&a<=13?s="match_pic match_m":a>=14&&a<=20&&(s="match_pic match_l"),i.className=s,r.innerHTML=a+"cm",r.className="match_wit",n.appendChild(i),n.appendChild(r);var l=document.getElementsByClassName("threebox")[0];l.appendChild(n),l.appendChild(c),o()}}function n(e){$(".match_add").bind("click",function(){var t=$(".matchCount").val();if(t<5){for(var a=parseInt($("#selector_dummy").val()),n=0;n<t;n++)if(a+"cm"==$(".match_"+n).children("span")[1].innerHTML)return void e.$apply(function(e){e.errorModel.errorText="不能重复添加相同规格的小棒!"});var i=document.createElement("a");i.className="match match_"+t;var r=document.createElement("span"),c=document.createElement("span"),s=document.createElement("span"),l=void 0;s.className="line",a>=2&&a<=7?l="match_pic match_s":a>=8&&a<=13?l="match_pic match_m":a>=14&&a<=20&&(l="match_pic match_l"),r.className=l,c.innerHTML=a+"cm",c.className="match_wit",i.appendChild(r),i.appendChild(c);var u=document.getElementsByClassName("threebox")[0];u.appendChild(i),u.appendChild(s),$(".matchCount").val(++t)}else e.$apply(function(e){e.errorModel.errorText="最多只能添加5个小棒!"});o()})}function i(){$(".btn_del").bind("click",function(){var e=$(".matchCount").val();if(0!=e){var t=$(".selectedMatch").val();if(""!=t&&void 0!=t){var a=document.getElementsByClassName("threebox")[0],n=document.getElementsByClassName("match_"+t)[0],i=document.getElementsByClassName("line")[t];a.removeChild(n),a.removeChild(i);for(var r=t;r<e-1;r++){document.getElementsByClassName("match_"+(parseInt(r)+1))[0].className="match match_"+r,o()}$(".selectedMatch").val(""),$(".matchCount").val(parseInt(e)-1)}}})}function r(){for(var e=new Array,t=$(".matchCount").val(),a=0;a<t;a++){var n=$(".match_"+a),i=n.children(".match_wit");3==i.text().length?e.push(i.text().substr(0,1)):4==i.text().length&&e.push(i.text().substr(0,2))}return e}function o(){$(document).unbind("mouseup"),$(".matchbox").unbind("mousedown"),$(".match").mousedown(function(e){if(!($(this)[0].className.indexOf("match_input")>=0)){$(".selMatch").removeClass("selMatch"),$(this).addClass("selMatch");var t=$(this).position();s=parseInt(t.left,10),l=parseInt(t.top,10),d=e.pageY,u=e.pageX;var a=this.className.substr(12,1);$(".selectedMatch").val(parseInt(a))}}),$(document).mouseup(function(e){return $(".match").unbind("mousemove"),$(".dragMatch").remove(),!0})}function c(e){if(void 0!==e)a(e),$(".matchCount").val(e.length);else if(e)return}Object.defineProperty(t,"__esModule",{value:!0}),t.getLengthArray=r,t.initViewPre=c,t.default=function(e){var t={};t.select={preset:"select"},$("#selector").val("").scroller("destroy").scroller($.extend(t.select,{theme:"android-ics light",mode:"scroller",height:64,display:"inline",lang:""})),$("#selector_dummy").val(3),$(".android-ics.light .dw-ul").css("margin-top",-128),n(e),i(),o()};var s,l,u=0,d=0},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){var e="",t="";if(void 0!==i.default.model)try{e=i.default.model.question_id,t=JSON.stringify(i.default.model.question_url)}catch(e){}return{id:e,dispatchOnly:!0,type_code:"nd_puzzle",type_name:"拼图工具",url:t}},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){i.default.controller=e,i.default.eventBus=e.getEventBus(),i.default.eventBus.addEventListener("SyncCallback",i.default),i.default.eventBus.addEventListener("PageLoaded",i.default)},e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t){switch(e){case"SyncCallback":r(t)}};var r=function(e){var t=e.type,a=e.value,n=$(i.default.view).find(".js-stop-sync-button");switch(t){case"request":i.default.syncId=a.syncId,a.result?n.show():window.ClassroomUtils.showTipMessageBox("同步题目失败");break;case"cancel":a.result?n.hide():window.ClassroomUtils.showMessageBox([{html:"关闭"},{html:"重试",target:"h5",callback:{eventName:"Three2DPuzzle",eventData:{source:i.default.model.ID,item:"retry"}}}],"结束任务失败！")}};e.exports=t.default}]);