define(["angularAMD"],function(e){e.directive("footToolTime",["$filter","$timeout",function(e,t){return{restrict:"E",templateUrl:"interaction/components/site-directive/foot-tool/foot-tool-time.html",scope:{timer:"=timer"},replace:!0,link:function(e,n){function i(e){if("countdown"==e.timer_type)if(e.time_minute||(e.time_second?e.time_minute=0:(e.time_minute=1,e.time_second=0)),e.time_second){if(e.time_second>=60){var t=Math.floor(e.time_second/60);e.time_minute+=t,e.time_second=e.time_second%60}}else e.time_second=0;else e.timer_type,e.time_minute=0,e.time_second=0}function o(t){return m[t]=0,function(n){if(n){var i=parseInt(n);i.toString().length==n.toString().length&&n.toString().length<=2&&i>=0&&i<60?m[t]=n:e.model[t]=m[t]}else m[t]=""}}var m={};e.model=angular.extend({timer_type:"sequence",time_minute:0,time_second:10},e.timer),e.opts={model:angular.extend({},e.model)},e.timeClick=function(){!1===$("#timesetId").hasClass("on")&&(e.opts.model=angular.extend({},e.model))},e.$watch("model.time_minute",o("time_minute")),e.$watch("model.time_second",o("time_second")),e.$watch("timer",function(){i(e.timer),e.model=angular.extend({timer_type:"sequence",time_minute:0,time_second:10},e.timer)}),e.close_popup=function(){angular.element("#timesetId").has(".toolpop").removeClass("on"),angular.element(".exam_wood").off("click")},e.changgeType=function(t){if(e.model.timer_type=t,"countdown"==t){if(angular.element(window.event.target).hasClass("time_second"))return!1;(!e.model.time_minute||0==e.model.time_minute&&0==e.model.time_second)&&(e.model.time_minute=1,e.model.time_second=0)}else"sequence"==e.model.timer_type&&(e.model.time_minute=0,e.model.time_second=0)},e.cancel=function(){e.model=e.opts.model},angular.element("#timesetId").on("resetTime",function(){e.cancel()}),e.ok=function(){i(e.model),angular.extend(e.timer,e.model),e.close_popup(),e.timer.timer_type=e.model.timer_type},t(function(){var e=n.find(".toolpop"),t=e.width();e.css({"margin-left":-t/2+"px"})},500)}}}])});