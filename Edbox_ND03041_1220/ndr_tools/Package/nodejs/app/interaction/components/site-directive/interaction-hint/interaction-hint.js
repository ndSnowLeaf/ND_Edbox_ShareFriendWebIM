define(["angularAMD","css!components/site-directive/interaction-hint/assets/css/style","components/site-directive/contenteditable/contenteditable"],function(t){t.directive("interactionHint",["ngDialog","$timeout",function(t,n){return{restrict:"E",templateUrl:"interaction/components/site-directive/interaction-hint/interaction-hint.html",scope:!0,controller:["$scope","$filter",function(t,e){t.MAX_HINT_AMOUNT=9,t.MAX_TEXT_LENGTH=100,t.Label1=e("translate")("app.hint.lable1"),t.Label2=e("translate")("app.hint.lable2"),t.model.interaction_hints&&t.model.interaction_hints.length>0&&$.each(t.model.interaction_hints,function(){this.content&&(this.rows=Math.max(2,this.content.replace(/[^\n]/g,"").replace(/\n/g,"$").length+1))});var i=function(){var n=!0;return t.model.interaction_hints&&$.each(t.model.interaction_hints,function(i,a){if(a.index=i+1,!a.content)return t.errorModel.errorText=e("translate")("app.hint.not.empty"),o(i),n=!1,!1}),n},o=function(t){var e=angular.element(".com_m_pop_hits .text_input_area:eq("+t+") textarea");e.hasClass("highlight_tip")?(e.removeClass("highlight_tip"),n(function(){e.addClass("highlight_tip").focus()},100)):e.addClass("highlight_tip").focus()},a=function(e,i){t.model.interaction_hints.push({index:e+1,content:"",rows:2}),!!i&&n(function(){angular.element(".com_m_pop_hits .text_input_area:last textarea").focus()},200)};t.onTextChange=function(n,e){n&&n.content&&(n.rows=Math.max(2,n.content.replace(/[^\n]/g,"").replace(/\n/g,"$").length+1)),n.content&&n.content.length>=t.MAX_TEXT_LENGTH&&o(e)},t.onKeydown=function(n,e){n.content&&n.content.length>=t.MAX_TEXT_LENGTH&&o(e)},t.openEditor=function(){t.model.interaction_hints&&0!==t.model.interaction_hints.length?t.interaction_hints_temp=angular.copy(t.model.interaction_hints):(t.interaction_hints_temp=[],t.model.interaction_hints=[],a(0)),t.isEditing=!0},t.addHint=function(){var n=0;t.model.interaction_hints&&(n=t.model.interaction_hints.length),a(n,!0)},t.remove=function(n){t.model.interaction_hints.splice(n,1)},t.errorModel={},t.save=function(){i()&&(t.isEditing=!1)},t.cancel=function(){t.model.interaction_hints=t.interaction_hints_temp,t.isEditing=!1}}]}}])});