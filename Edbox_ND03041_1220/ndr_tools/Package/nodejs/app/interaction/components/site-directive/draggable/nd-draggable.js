define(["angularAMD"],function(t){"use strict";function o(t){t=t||{};var o=angular.element(this),e=o.data("my.draggable"),n=angular.extend({},o.data(),"object"==typeof t&&t);e||(e=new i(o,n),o.data("my.draggable",e))}var i,e=function(t,o){return function(){return t.apply(o,arguments)}};i=function(){function t(o,i){this.click=e(this.click,this),this.moved=e(this.moved,this),this.ended=e(this.ended,this),this.began=e(this.began,this),this.coordinate=e(this.coordinate,this),this.off=e(this.off,this),this.on=e(this.on,this),this.toggle=e(this.toggle,this),this.bind=e(this.bind,this),this.$container=o,this.options=angular.extend({},t.DEFAULTS,i),this.toggle()}return t.DEFAULTS={"z-index":999,opacity:"0.8",version:"0.01"},t.prototype.bind=function(t){return null==t&&(t="on"),$(document)[t]("mousemove touchmove",this.moved),$(document)[t]("mouseup touchend touchcancel",this.ended)},t.prototype.toggle=function(t){return null==t&&(t="on"),this.$container[t]("mousedown touchstart",this.began),this.$container[t]("click",this.click)},t.prototype.on=function(){return this.toggle("on")},t.prototype.off=function(){return this.toggle("off")},t.prototype.coordinate=function(t){switch(t.type){case"touchstart":case"touchmove":case"touchend":case"touchcancel":return t.originalEvent.touches[0];default:return t}},t.prototype.began=function(t){var o;if((null==(o=this.options)||"function"!=typeof o.beganStart||!1!==o.beganStart(t))&&!this.$target&&"true"!==this.$container.attr("move-disabled")&&!0!==this.$container.attr("move-disabled")){t.stopPropagation(),this.bind("on"),this.$target=this.$container;var i={x:this.$target[0].offsetLeft,y:this.$target[0].offsetTop};return this.$target.css({position:"absolute","z-index":"99",left:i.x,top:i.y}),this.origin={oPageX:this.coordinate(t).pageX,oPageY:this.coordinate(t).pageY,x:this.coordinate(t).pageX-i.x,y:this.coordinate(t).pageY-i.y},null!=(o=this.options)&&"function"==typeof o.began?o.began(t,i):void 0}},t.prototype.moved=function(t){var o;if(null!=this.$target){var i={x:this.coordinate(t).pageX-this.origin.x,y:this.coordinate(t).pageY-this.origin.y};if(this.options.onlymove&&("x"===this.options.onlymove?i.y=this.$target[0].offsetTop:"y"===this.options.onlymove&&(i.x=this.$target[0].offsetLeft)),this.options.moveRange){var e=this.options.moveRange.x.max-this.$target.width(),n=this.options.moveRange.y.max-this.$target.height();i.x<this.options.moveRange.x.min?i.x=this.options.moveRange.x.min:i.x>e&&(i.x=e),i.y<this.options.moveRange.y.min?i.y=this.options.moveRange.y.min:i.y>n&&(i.y=n)}var s={x:i.x,y:i.y,addX:this.coordinate(t).pageX-this.origin.oPageX,addY:this.coordinate(t).pageY-this.origin.oPageY,target:this.$target};if(!this.options.canMove||!1!==this.options.canMove(s))return this.options.positionByExternal||this.$target.css({left:i.x,top:i.y}),this.dragged=this.$target,null!=(o=this.options)&&"function"==typeof o.moved?o.moved(t,s):void 0}},t.prototype.ended=function(t){var o;if(null!=this.$target){t.stopPropagation();var i={x:this.$target[0].offsetLeft,y:this.$target[0].offsetTop};return console.log("end---------"+i),this.bind("off"),this.$target.removeClass("dragging"),delete this.$target,null!=(o=this.options)&&"function"==typeof o.ended?o.ended(t,i):void 0}},t.prototype.click=function(t){if(this.dragged)return t.stopPropagation(),delete this.dragged},t}(),t.directive("ndDraggable",[function(){return{restrict:"A",scope:{options:"=options"},link:function(t,i){o.apply(i,[t.options])}}}])});