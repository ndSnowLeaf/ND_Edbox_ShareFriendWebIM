!function(e){"use strict";function t(t){return t=t||{},this.each(function(){var s=e(this),i=s.data("my.audioplayer"),n=e.extend({},s.data(),"object"==typeof t&&t);i||(i=new o(s,n),s.data("my.audioplayer",i))})}function s(t){return t=t||{},this.each(function(){var s=e(this),i=s.data("my.videoplayer"),n=e.extend({},s.data(),"object"==typeof t&&t);i||(i=new r(s,n),s.data("my.videoplayer",i))})}var i,n=function(e,t){return function(){return e.apply(t,arguments)}};i=function(){var t=function(){};t.prototype.$=function(e){return this.$container.find(e)},t.prototype.bindEventListener=function(){var t=this.media,s=this;this.supportHTML5&&this.options.supporFullscreen?e.MediaPlager.browser.webkit?e(document).bind("webkitfullscreenchange",function(){s.$container.toggleClass("full_video"),s.fullscreenEvent()}):e.MediaPlager.browser.mozilla?e(document).bind("mozfullscreenchange",function(){s.$container.toggleClass("full_video"),s.fullscreenEvent()}):e.MediaPlager.browser.smie&&e(document).bind("msfullscreenchange",function(){s.$container.toggleClass("full_video"),s.fullscreenEvent()}):e(document).bind("flash.loaded",function(){s.eventsToBind()}),t.addEventListener("playing",function(){s.$('[data-oper="play"]').addClass("btn_pause"),s.options.onPlay&&s.options.onPlay()},!0),t.addEventListener("pause",function(){s.$('[data-oper="play"]').removeClass("btn_pause"),s.options.onPause&&s.options.onPause()},!0),t.addEventListener("ended",function(){this.currentTime=0,this.pause(),s.options.onEnd&&s.options.onEnd.call(),s.playing=!1},!1),t.addEventListener("timeupdate",function(){s.updateVideoData(),s.updateCurrentTime(),s.options.onTimeupdate&&s.options.onTimeupdate()},!1)},t.prototype.playPause=function(){var t=this.media;this.supportHTML5?t.paused?(this.options.firstPlay&&(this.$('[data-oper="endTime"]').text(e.MediaPlager.formatTime(this.media.duration)),this.options.firstPlay=!1),t.play()):t.pause():t.paused()?t._play():t._pause()},t.prototype.pause=function(){var e=this.media;this.supportHTML5?e.paused||e.pause():e.paused()||e._pause()};t.prototype.play=function(){var t=this.media;this.supportHTML5?(this.options.firstPlay&&(this.$('[data-oper="endTime"]').text(e.MediaPlager.formatTime(this.media.duration)),this.options.firstPlay=!1),t.paused&&t.play()):t.paused()&&t._play()},t.prototype.progress=function(){var t=this.$('[data-oper="progress"]'),s=this.media;if(t.length>0){var i=this;e(document).on("mousemove  touchmove",function(e){e.preventDefault(),i.seekTo(e.pageX,t,s)}),e(document).on("mouseup touchend touchcancel",t,function(t){t.preventDefault(),e(document).off("mousemove"),e(document).off("mouseup")})}},t.prototype.progressMouseup=function(){var e=this.$('[data-oper="progress"]'),t=this.media,s=this;e.on("mouseup",function(i){s.seekTo(i.pageX,e,t)})},t.prototype.seekTo=function(t,s,i){var n=s.find('[data-oper="bar"]'),o=Math.max(0,Math.min(1,(t-e.MediaPlager.findPosX(s))/s.width())),r=o*(this.supportHTML5?i.duration:i.duration());this.supportHTML5?i.currentTime=r:i.seekTo(r);var a=Math.round(o*s.width());n.width(a)},t.prototype.updateCurrentTime=function(){var t=this.media,s=this.supportHTML5?t.currentTime:t.currentTime();this.$('[data-oper="curentTime"]').html(e.MediaPlager.formatTime(s))},t.prototype.updateVideoData=function(){var e=this.media,t=this.$('[data-oper="progress"] [data-oper="bar"]'),s=100*(this.supportHTML5?e.currentTime:e.currentTime())/(this.supportHTML5?e.duration:e.duration());t.width(s+"%")},t.findPosX=function(e){e=e.get(0);for(var t=e.offsetLeft;e=e.offsetParent;)t+=e.offsetLeft;return t},t.formatTime=function(e){var t=Math.floor(e/60),s=Math.round(e-60*t);return 60==s&&(s=0,t+=1),s<10&&(s="0"+s),t+":"+s},t.uaBrowser=function(e){var t=e.toLowerCase(),s=/(webkit)[ \/]([\w.]+)/,i=/(opera)(?:.*version)?[ \/]([\w.]+)/,n=/(msie) ([\w.]+)/,o=/(mozilla)(?:.*? rv:([\w.]+))?/,r=s.exec(t)||i.exec(t)||n.exec(t)||t.indexOf("compatible")<0&&o.exec(t)||[];return{browser:r[1]||"",version:r[2]||"0"}},t.browser={};var s=t.uaBrowser(navigator.userAgent);return s.browser&&(t.browser[s.browser]=!0,t.browser.version=s.version),t}(),e.MediaPlager=i;var o;o=function(){var t=function(s,i){return this.$container=s,this.options=e.extend({},t.DEFAULTS,i),this.init=n(this.init,this),this.start=n(this.start,this),this.createAudio=n(this.createAudio,this),this.playPause=n(this.playPause,this),this.play=n(this.play,this),this.pause=n(this.pause,this),this.progress=n(this.progress,this),this.progressMouseup=n(this.progressMouseup,this),this.bindControls=n(this.bindControls,this),this.bindEventListener=n(this.bindEventListener,this),this.$=n(this.$,this),this.init(),this};return t.DEFAULTS={onEnd:!1,onPause:!1,onPlay:!1,onSeek:!1,onStart:!1,supporFullscreen:!1,firstPlay:!0},t.prototype=new e.MediaPlager,t.prototype.init=function(){if(document.createElement("audio").canPlayType)return this.supportHTML5=!0,this.start();this.supportHTML5=!1},t.prototype.start=function(){this.playing=!1,this.$media=this.$("audio"),this.media=this.$media.get(0);var t=this;setTimeout(function(){t.$('[data-oper="endTime"]').text(e.MediaPlager.formatTime(t.media.duration))},500),this.bindControls(),this.bindEventListener()},t.prototype.bindControls=function(){this.$container.on("click.play.jq.media",'[data-oper="play"]',this.playPause),this.$container.on("mousedown.progress.jq.media",'[data-oper="progress"]',this.progress),this.$container.on("mouseup.progress.jq.media",'[data-oper="progress"]',this.progressMouseup)},t}(),e.fn.audioplayer=t;var r;r=function(){var t=function(s,i){return this.$container=s,this.options=e.extend({},t.DEFAULTS,i),this.init=n(this.init,this),this.start=n(this.start,this),this.createVideo=n(this.createVideo,this),this.playPause=n(this.playPause,this),this.play=n(this.play,this),this.pause=n(this.pause,this),this.progress=n(this.progress,this),this.progressMouseup=n(this.progressMouseup,this),this.bindControls=n(this.bindControls,this),this.bindEventListener=n(this.bindEventListener,this),this.$=n(this.$,this),this.toFullscreen=n(this.toFullscreen,this),this.fullscreenEvent=n(this.fullscreenEvent,this),this.init(),this};return t.DEFAULTS={controls:["play","progress","time","volume","fullscreen","alternative"],onEnd:!1,onPause:!1,onPlay:!1,onSeek:!1,onStart:!1,onVideoChange:!1,supporFullscreen:!0,firstPlay:!0},t.prototype=new e.MediaPlager,t.prototype.init=function(){if(document.createElement("video").canPlayType)return this.supportHTML5=!0,this.start();this.supportHTML5=!1;var e=!1;try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(t){void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}e&&this.startFallback()},t.prototype.start=function(){this.playing=!1,this.fullscreen=!1,this.$media=this.$("video"),this.media=this.$media[0];var t=this;this.media.onloadedmetadata=function(){t.$('[data-oper="endTime"]').text(e.MediaPlager.formatTime(t.media.duration))},this.bindControls(),this.bindEventListener()},t.prototype.bindControls=function(){this.$container.on("click.play.jq.media",'[data-oper="play"]',this.playPause),this.$container.on("click.fullscreen.jq.media",'[data-oper="fullscreen"]',this.toFullscreen),this.$container.on("mousedown.progress.jq.media",'[data-oper="progress"]',this.progress),this.$container.on("mouseup.progress.jq.media",'[data-oper="progress"]',this.progressMouseup)},t.prototype.toFullscreen=function(){var t=this;if(this.supportHTML5){var s=this.$container.get(0);this.fullscreen?document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msCancelFullScreen&&document.msCancelFullScreen():s.webkitRequestFullScreen?s.webkitRequestFullScreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullScreen()}else{this.video;this.fullscreen?(this.$container.removeClass("fullscreen"),e(this.getClass("fullscreen")).removeClass("hover"),this.fullscreen=!1):(this.$container.addClass("fullscreen"),e(this.getClass("fullscreen")).removeClass("hover"),this.fullscreen=!0),setTimeout(function(){t.setupProgressBar()},100)}},t.prototype.fullscreenEvent=function(){this.fullscreen?this.fullscreen=!1:this.fullscreen=!0},t}(),e.fn.videoplayer=s}(jQuery);