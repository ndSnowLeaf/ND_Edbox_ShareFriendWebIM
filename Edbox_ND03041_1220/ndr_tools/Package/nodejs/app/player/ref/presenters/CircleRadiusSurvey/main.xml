<?xml version='1.0' encoding='UTF-8'?>
<addon id="templateid"><properties/><dependencies><jsDependency/></dependencies><css><![CDATA[.addon_CircleRadiusSurvey .hide_dom{display:none!important}.addon_CircleRadiusSurvey .circle_radius{position:relative;width:100%;height:100%;background:#bfd3e2;color:#333;text-align:center;overflow:hidden}.addon_CircleRadiusSurvey .circle_radius .cirras_main{position:absolute;left:50%;top:50%;width:70.41667em;height:40.95833em;margin-left:-35.20833em;margin-top:-19.25em;border-radius:.41667em;text-align:center}.addon_CircleRadiusSurvey .circle_radius .cirras_stage{width:100%;height:100%}.addon_CircleRadiusSurvey .circle_radius .cirras_stage:after{content:'';display:inline-block;width:0;height:100%;vertical-align:middle}.addon_CircleRadiusSurvey .circle_radius .cirras_circle{position:relative;display:inline-block;width:28.625em;height:28.625em;margin-top:.125em;background:#fff;border:4px solid #6c8395;border-radius:50%;vertical-align:middle}.addon_CircleRadiusSurvey .circle_radius .cirras_center{z-index:100;position:absolute;left:13.58333em;top:13.58333em;width:.91667em;height:.91667em;background:#ff2a2a;border:.125em solid #8d1111;border-radius:50%}.addon_CircleRadiusSurvey .circle_radius .cirras_raline{position:absolute;left:50%;top:50%;width:50.5%;height:4px;background:#6c8395;transform-origin:left center}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.red{z-index:1}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.red:after{position:absolute;left:0;top:-1px;content:"";width:99.5%;background:#cb1f1f;height:.33333em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_01{transform:translate(0,-50%) rotate(0)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_01 .cirras_info{right:-8.25em;top:-4em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_01 .cirras_foline{width:6.58333em;height:2.95833em;border-width:.20833em 0 0 .20833em;transform-origin:left bottom;transform:skew(-30deg,0deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_01 .cirras_fonum{left:8.125em;bottom:1.16667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_02{transform:translate(0,-50%) rotate(-20deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_02 .cirras_info{transform:rotate(20deg);right:-8.66667em;top:-2.16667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_02 .cirras_focus{transform:rotate(20deg);bottom:0}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_02 .cirras_foline{width:2.33333em;height:2.91667em;border-width:.25em 0 0 .20833em;transform-origin:left bottom;transform:skew(0deg,-28deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_02 .cirras_fonum{left:1.83333em;bottom:2.29167em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_03{transform:translate(0,-50%) rotate(-50deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_03 .cirras_info{transform:rotate(50deg);right:-8.95833em;top:-1.16667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_03 .cirras_focus{transform:rotate(50deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_03 .cirras_foline{width:.875em;height:2.66667em;left:-.875em;border-width:0 0 .375em .20833em;transform-origin:right bottom;transform:skew(0deg,62deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_03 .cirras_fonum{left:-2.625em;bottom:4.08333em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_04{transform:translate(0,-50%) rotate(-90deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_04 .cirras_info{transform:rotate(90deg);right:-7.33333em;top:-2.75em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_04 .cirras_focus{transform:rotate(90deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_04 .cirras_foline{width:4.16667em;height:1.16667em;left:-4.16667em;border-width:.20833em .20833em 0 0;transform-origin:right bottom;transform:skew(22deg,0deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_04 .cirras_fonum{left:-8.33333em;bottom:-.20833em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_05{transform:translate(0,-50%) rotate(-140deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_05 .cirras_info{transform:rotate(140deg);right:-9em;top:-3.16667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_05 .cirras_focus{transform:rotate(140deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_05 .cirras_foline{width:3.16667em;height:1.41667em;left:-3.16667em;bottom:-1.41667em;border-width:.20833em 0 0 .29167em;transform-origin:right top;transform:skew(-50deg,0deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_05 .cirras_fonum{left:-7.5em;bottom:-5.04167em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_06{transform:translate(0,-50%) rotate(-200deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_06 .cirras_info{transform:rotate(200deg);right:-8em;top:-1em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_06 .cirras_focus{transform:rotate(200deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_06 .cirras_foline{width:1.5em;height:2em;left:-1.5em;bottom:-2em;border-width:0 .20833em .25em 0;transform-origin:right top;transform:skew(0deg,-46deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_06 .cirras_fonum{left:-3.25em;bottom:-7.08333em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_07{transform:translate(0,-50%) rotate(-270deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_07 .cirras_info{transform:rotate(270deg);right:-5.16667em;top:-1.66667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_07 .cirras_focus{bottom:.04167em;transform:rotate(270deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_07 .cirras_foline{width:3.66667em;height:2.16667em;bottom:-2.16667em;border-width:.20833em .20833em 0 0;transform-origin:left top;transform:skew(20deg,12deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_07 .cirras_fonum{left:4.33333em;bottom:-4.16667em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_08{transform:translate(0,-50%) rotate(-350deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_08 .cirras_info{transform:rotate(350deg);right:-8.25em;top:-3em}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_08 .cirras_focus{bottom:-.04167em;transform:rotate(350deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_08 .cirras_foline{width:8.33333em;height:1.08333em;border-width:.20833em 0 0 .25em;transform-origin:left bottom;transform:skew(-45deg,0deg)}.addon_CircleRadiusSurvey .circle_radius .cirras_raline.line_08 .cirras_fonum{left:9.25em;bottom:-.66667em}.addon_CircleRadiusSurvey .circle_radius .cirras_info{position:absolute;transform-origin:center center}.addon_CircleRadiusSurvey .circle_radius .cirras_info .text1{font-size:6.04167em;font-family:"Times New Roman";font-style:italic}.addon_CircleRadiusSurvey .circle_radius .cirras_info .text2{font-size:3.54167em}.addon_CircleRadiusSurvey .circle_radius .cirras_info .text3{font-size:3.95833em;font-family:"Times New Roman"}.addon_CircleRadiusSurvey .circle_radius .cirras_focus{position:absolute;bottom:.10417em;left:14em;transform-origin:left bottom}.addon_CircleRadiusSurvey .circle_radius .cirras_foline{position:relative;display:inline-block;border:.20833em solid #fff}.addon_CircleRadiusSurvey .circle_radius .cirras_fonum{position:absolute;display:inline-block;width:4.16667em;height:4.16667em;line-height:4.16667em;background:url(resources/images/bg_num.png) no-repeat center center;background-size:100% 100%;text-align:center}.addon_CircleRadiusSurvey .circle_radius .cirras_fonum .text{font-size:3.95833em;font-family:"Times New Roman";color:#cb1f1f}.addon_CircleRadiusSurvey .circle_radius .cirras_ruler{z-index:10;position:absolute;left:12.58333em;top:14.08333em;width:21.625em;height:5.25em;background:url(resources/images/ruler.png) no-repeat center center;background-size:100% auto;transform-origin:1.5em top;transform:rotate(0)}.addon_CircleRadiusSurvey .circle_radius .cirras_whitepoint{z-index:100;position:absolute;left:15.25em;top:-.5em;width:.91667em;height:.91667em;background:#fff;border:.16667em solid #ff2a2a;border-radius:50%}.addon_CircleRadiusSurvey .circle_radius .cirras_rotate{display:inline-block;position:absolute;left:18.08333em;top:1.45833em;width:2.79167em;height:2.79167em;border-radius:50%;background:url(resources/images/icon_rotate.png) no-repeat center center;background-size:100% 100%}.addon_CircleRadiusSurvey .circle_radius .cirras_rotate.ui_btn_active,.addon_CircleRadiusSurvey .circle_radius .cirras_rotate.ui_btn_on{background:url(resources/images/icon_rotate_act.png) no-repeat center center;background-size:100% 100%}.addon_CircleRadiusSurvey .circle_radius .cirras_rotate:before{content:'';z-index:1;display:block;position:absolute;left:-.875em;top:-1.25em;right:-.875em;bottom:-1.125em}.addon_CircleRadiusSurvey .circle_radius .cirras_text_center{position:absolute;left:50%;top:50%;margin-left:-2.66667em;margin-top:.25em}.addon_CircleRadiusSurvey .circle_radius .cirras_text_center .text{font-family:"Times New Roman";font-size:3.54167em;font-style:italic}.addon_CircleRadiusSurvey .circle_radius .cirras_reset{position:absolute;right:3.33333em;bottom:3.33333em}.addon_CircleRadiusSurvey .circle_radius .btn_reset{display:inline-block;padding:0 1.08333em;min-width:8.08333em;height:3.08333em;line-height:3em;border:1px solid #397274;background:linear-gradient(to top,#e9e9e9 0,#fff 100%);text-align:center;border-radius:.41667em;color:#384650}.addon_CircleRadiusSurvey .circle_radius .btn_reset .text{font-size:1.5em}.addon_CircleRadiusSurvey .circle_radius .btn_reset.ui_btn_active,.addon_CircleRadiusSurvey .circle_radius .btn_reset:active{background:linear-gradient(to top,#76b8ba 0,#89c5c7 100%);color:#fff}.addon_CircleRadiusSurvey .circle_radius .btn_reset.click_disabled{background:linear-gradient(to top,#c1c8cc 0,#c8d1d7 100%);color:#97a0a6;border-color:#93989a}]]></css><view><![CDATA[<div class="circle_radius"><div class="cirras_main"><div class="cirras_stage"><div class="cirras_circle"><span class="cirras_center"></span><div class="cirras_text_center"><span class="text">O</span></div><div class="cirras_raline line_01"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_08"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_07"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_06"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_05"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_04"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_03"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_raline line_02"><div class="cirras_info hide_dom"><span class="text1">r</span> <span class="text2">=</span> <span class="text3">2</span></div><div class="cirras_focus hide_dom"><span class="cirras_foline"></span> <span class="cirras_fonum"><span class="text">2</span></span></div></div><div class="cirras_ruler"><span class="cirras_whitepoint hide_dom"></span><span class="cirras_rotate"></span></div></div><div class="cirras_reset"><a href="#" class="btn_reset click_disabled"><span class="text btn_text">重置</span></a></div></div></div></div>]]></view><presenter><![CDATA['use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var AddonCircleRadiusSurvey_create =
/******/function (modules) {
	// webpackBootstrap
	/******/ // The module cache
	/******/var installedModules = {};

	/******/ // The require function
	/******/function __webpack_require__(moduleId) {

		/******/ // Check if module is in cache
		/******/if (installedModules[moduleId])
			/******/return installedModules[moduleId].exports;

		/******/ // Create a new module (and put it into the cache)
		/******/var module = installedModules[moduleId] = {
			/******/exports: {},
			/******/id: moduleId,
			/******/loaded: false
			/******/ };

		/******/ // Execute the module function
		/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

		/******/ // Flag the module as loaded
		/******/module.loaded = true;

		/******/ // Return the exports of the module
		/******/return module.exports;
		/******/
	}

	/******/ // expose the modules object (__webpack_modules__)
	/******/__webpack_require__.m = modules;

	/******/ // expose the module cache
	/******/__webpack_require__.c = installedModules;

	/******/ // __webpack_public_path__
	/******/__webpack_require__.p = "";

	/******/ // Load entry module and return exports
	/******/return __webpack_require__(0);
	/******/
}(
/************************************************************************/
/******/[
/* 0 */
/***/function (module, exports, __webpack_require__) {

	module.exports = __webpack_require__(1);

	/***/
},
/* 1 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _appPresenter = __webpack_require__(2);

	var _appPresenter2 = _interopRequireDefault(_appPresenter);

	exports['default'] = function () {
		return _appPresenter2['default'];
	};

	module.exports = exports['default'];

	/***/
},
/* 2 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenterRun = __webpack_require__(3);

	var _presenterRun2 = _interopRequireDefault(_presenterRun);

	var _presenterSetBasePath = __webpack_require__(8);

	var _presenterSetBasePath2 = _interopRequireDefault(_presenterSetBasePath);

	var _presenterDestroy = __webpack_require__(9);

	var _presenterDestroy2 = _interopRequireDefault(_presenterDestroy);

	var _presenterGetQuestionInfo = __webpack_require__(10);

	var _presenterGetQuestionInfo2 = _interopRequireDefault(_presenterGetQuestionInfo);

	var _presenterGetExtendData = __webpack_require__(11);

	var _presenterGetExtendData2 = _interopRequireDefault(_presenterGetExtendData);

	var _presenterInitStudentMobile = __webpack_require__(12);

	var _presenterInitStudentMobile2 = _interopRequireDefault(_presenterInitStudentMobile);

	// import setLocationProperties from './presenter/setLocationProperties'

	var _presenterSetUrlParams = __webpack_require__(13);

	var _presenterSetUrlParams2 = _interopRequireDefault(_presenterSetUrlParams);

	var _presenterSetLocationProperties = __webpack_require__(15);

	var _presenterSetLocationProperties2 = _interopRequireDefault(_presenterSetLocationProperties);

	exports['default'] = {
		run: _presenterRun2['default'],
		destroy: _presenterDestroy2['default'],
		setBasePath: _presenterSetBasePath2['default'],
		getQuestionInfo: _presenterGetQuestionInfo2['default'],
		getExtendData: _presenterGetExtendData2['default'],
		initStudentMobile: _presenterInitStudentMobile2['default'],
		setUrlParams: _presenterSetUrlParams2['default']
		// setLocationProperties
	};
	module.exports = exports['default'];

	/***/
},
/* 3 */
/***/function (module, exports, __webpack_require__) {

	/**
  * 运行环境下, 初始化Module的方法
  * @param view 运行视图(DOM对象)
  * @param model Module的模型, Key-Value结构
  * @remark 该方法为Module生命周期方法,仅在Module初始化时执行一次
  */
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _initPage = __webpack_require__(4);

	var _initPage2 = _interopRequireDefault(_initPage);

	var _radiusData = __webpack_require__(5);

	var _radiusData2 = _interopRequireDefault(_radiusData);

	var _radiusControl = __webpack_require__(6);

	var _radiusControl2 = _interopRequireDefault(_radiusControl);

	var _initI18N = __webpack_require__(7);

	var _initI18N2 = _interopRequireDefault(_initI18N);

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function (view, model) {
		return window.I18nManager.getInstance().loadLanguage('CircleRadiusSurvey', _presenter2['default'].langType).done(function (i18n) {
			_radiusData2['default'].i18n = i18n.lang;
			_presenter2['default'].$view = $(view);
			(0, _initI18N2['default'])(view);

			if (model.__ExtendModel && !$.isEmptyObject(model.__ExtendModel) && model.__ExtendModel.gTran) {
				(0, _initPage2['default'])(model.__ExtendModel.gTran);
				_radiusData2['default'].controlData = model.__ExtendModel.gTran;
			} else {
				(0, _initPage2['default'])(_radiusData2['default'].initData);
				// data.controlData = Object.assign({}, data.initData);
				_radiusData2['default'].controlData = _radiusData2['default'].cloneObj(_radiusData2['default'].initData);
			}
			(0, _radiusControl2['default'])();
		});
	};

	module.exports = exports['default'];

	/***/
},
/* 4 */
/***/function (module, exports, __webpack_require__) {

	"use strict";

	Object.defineProperty(exports, "__esModule", {
		value: true
	});
	exports["default"] = initPage;

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { "default": obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	function initPage(data) {
		var lineAngle = data.lineAngle;
		var ismeasured = data.ismeasured;
		var rulerAngle = data.rulerAngle;
		var lineItem = _presenter2["default"].$view.find(".cirras_raline");
		var ruler = _presenter2["default"].$view.find(".cirras_ruler");

		// 隐藏测量过的半径   
		_presenter2["default"].$view.find(".red").removeClass("red");
		lineItem.find(".cirras_info").addClass("hide_dom");
		lineItem.find(".cirras_focus").addClass("hide_dom");

		//显示尺子
		$(ruler).css({ transform: "rotate(" + rulerAngle + "deg)" });

		for (var i = 0; i < lineAngle.length; i++) {
			//显示r=2
			if (ismeasured[i]) {
				lineItem.eq(i).find(".cirras_info").removeClass("hide_dom");
			}
			//显示刻度2
			if (rulerAngle === lineAngle[i]) {
				//红线
				lineItem.eq(i).addClass("red");
				lineItem.eq(i).find(".cirras_focus").removeClass("hide_dom");
				// 显示吸附点
				ruler.find(".cirras_whitepoint").removeClass("hide_dom");
			}
		}

		// 按钮状态
		var resetBtn = _presenter2["default"].$view.find(".btn_reset");
		if (data.btnEnable) {
			resetBtn.removeClass("click_disabled");
		} else {
			resetBtn.addClass("click_disabled");
		}
	}

	module.exports = exports["default"];

	/***/
},
/* 5 */
/***/function (module, exports) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});
	exports['default'] = {
		initData: {
			lineAngle: [0, 10, 90, 160, 220, 270, 310, 340],
			ismeasured: [],
			rulerAngle: 0, // 尺子位置
			btnEnable: false //重置按钮状态
		},
		controlData: {
			lineAngle: [0, 10, 90, 160, 220, 270, 310, 340],
			ismeasured: [],
			rulerAngle: 0, // 尺子位置
			btnEnable: false //重置按钮状态
		},
		cloneObj: function (_cloneObj) {
			function cloneObj(_x) {
				return _cloneObj.apply(this, arguments);
			}

			cloneObj.toString = function () {
				return _cloneObj.toString();
			};

			return cloneObj;
		}(function (obj) {
			if (!obj) return;
			var str,
			    newobj = obj.constructor === Array ? [] : {};
			if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object') {
				return;
			} else if (window.JSON) {
				str = JSON.stringify(obj), //系列化对象
				newobj = JSON.parse(str); //还原
			} else {
				for (var i in obj) {
					newobj[i] = _typeof(obj[i]) === 'object' ? cloneObj(obj[i]) : obj[i];
				}
			}
			return newobj;
		})
	};
	module.exports = exports['default'];

	/***/
},
/* 6 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});
	exports['default'] = radiusControl;

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _radiusData = __webpack_require__(5);

	var _radiusData2 = _interopRequireDefault(_radiusData);

	var _initPage = __webpack_require__(4);

	var _initPage2 = _interopRequireDefault(_initPage);

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	function radiusControl() {
		var content = _presenter2['default'].$view.find(".cirras_stage");
		var lineItem = content.find(".cirras_raline");
		var ruler = content.find(".cirras_ruler");
		var rotatePoint = ruler.find(".cirras_rotate");
		var circle = content.find(".cirras_circle");
		var lineAngle = _radiusData2['default'].controlData.lineAngle;
		var resetBtn = _presenter2['default'].$view.find(".btn_reset");
		var point = content.find(".cirras_whitepoint");
		var focus = _presenter2['default'].$view.find(".cirras_focus");
		var angle = 0; // 角度
		var lastAngle = _radiusData2['default'].controlData.rulerAngle; // 上一次角度
		var dis = 0; // 鼠标按下时的角度差
		var isDown = false;
		var curLineIndex = 0;

		// 计算curLineIndex
		for (var i = 0; i < lineAngle.length; i++) {
			if (lastAngle === lineAngle[i]) {
				curLineIndex = i;
			}
		}
		rotatePoint[0].removeEventListener("mousedown", fnDwon);
		rotatePoint[0].removeEventListener("touchstart", fnDwon);

		rotatePoint[0].addEventListener("mousedown", fnDwon);
		rotatePoint[0].addEventListener("touchstart", fnDwon);

		function fnDwon(event) {
			event.preventDefault();
			var ev = event.changedTouches ? event.changedTouches[0] : event;
			rotatePoint.addClass("ui_btn_on");
			var _angle = getAngle(ev);
			dis = _angle - lastAngle;
			angle = lastAngle; // 防止点击时angle为0
			isDown = true;

			_presenter2['default'].$view.on("touchmove mousemove", function (event) {
				event.preventDefault();

				if (!isDown) return;

				if (!rotate(event)) return;

				if (angle > lastAngle) {
					// 顺时针
					setNextLine(true);
				} else {
					setNextLine(false);
				}
				lastAngle = angle;
			});

			_presenter2['default'].$view.on("mouseup mouseleave touchend", function (event) {
				event.preventDefault();
				isDown = false;
				rotate(event);
				lineItem.removeClass("red");
				rotatePoint.removeClass("ui_btn_on");
				//存储尺子位置
				_radiusData2['default'].controlData.rulerAngle = angle;
				//根据角度判断是否吸附到相应的半径上
				adsorb();

				_presenter2['default'].$view.off("mousemove touchmove");
				_presenter2['default'].$view.off("mouseup touchend");
				_presenter2['default'].$view.off("mouseleave");
			});
		};

		//显示下一条预测量的半径为红色
		function setNextLine(clockwise) {
			var last = lineAngle.length - 1;
			content.find(".red").removeClass("red");
			//3度范围内不管旋转方向都测量该半径
			for (var _i = 0; _i < lineAngle.length; _i++) {
				if (lineAngle[_i] == 0 && Math.abs(angle - 360) <= 3) {
					$(lineItem[_i]).addClass("red");
					return;
				}
				if (Math.abs(angle - lineAngle[_i]) <= 3) {
					$(lineItem[_i]).addClass("red");
					return;
				}
			}

			//超过任意一条半径3度范围时根据旋转方向，设置这个方向的下一条半径为红色
			for (var _i2 = 0; _i2 < lineAngle.length; _i2++) {
				// 顺时针
				if (clockwise) {
					if (angle > lineAngle[last]) {
						$(lineItem[0]).addClass("red");
						break;
					}
					if (angle >= lineAngle[_i2] && angle < lineAngle[_i2 + 1]) {
						$(lineItem[_i2 + 1]).addClass("red");
						break;
					}
					// 逆时针
				} else {
					if (angle > lineAngle[last]) {
						$(lineItem[last]).addClass("red");
						break;
					}
					if (angle >= lineAngle[_i2] && angle < lineAngle[_i2 + 1]) {
						$(lineItem[_i2]).addClass("red");
						break;
					}
				}
			}
		}
		// 吸附
		function adsorb() {
			var _angle = angle;
			for (var _i3 = 0; _i3 < lineAngle.length; _i3++) {
				if (lineAngle[_i3] == 0 && Math.abs(angle - 360) <= 3) {
					_angle = lineAngle[_i3];
					lineItem.eq(_i3).addClass("red").find(".cirras_focus").removeClass("hide_dom");
					point.removeClass("hide_dom");
					curLineIndex = _i3;
					_radiusData2['default'].controlData.rulerAngle = _angle;
				}
				if (Math.abs(_angle - lineAngle[_i3]) <= 3) {
					_angle = lineAngle[_i3];
					lineItem.eq(_i3).addClass("red").find(".cirras_focus").removeClass("hide_dom");
					point.removeClass("hide_dom");
					curLineIndex = _i3;
					_radiusData2['default'].controlData.rulerAngle = _angle;
					break;
				}
			}
			lastAngle = _angle;
			//存储尺子位置
			if (_angle === angle) return;
			ruler.css({ transform: "rotateZ(" + _angle + "deg)" });
		}

		//通过鼠标位置获取与转轴的角度
		function getAngle(ev) {
			var ox = ev.clientX - circle.offset().left - circle.width() / 2;
			var oy = ev.clientY - circle.offset().top - circle.height() / 2;
			var angle = Math.atan2(oy, ox) / (Math.PI / 180);

			return adjustAngle(angle);
		}

		resetBtn[0].removeEventListener("click", reset);
		resetBtn[0].addEventListener("click", reset);
		//重置事件
		function reset(event) {
			event.preventDefault();
			if (resetBtn.hasClass("click_disabled")) return;
			(0, _initPage2['default'])(_radiusData2['default'].initData);

			angle = 0; // 角度
			lastAngle = 0; // 上一次角度
			dis = 0; // 鼠标按下时的角度差
			isDown = false;
			curLineIndex = 0;

			_radiusData2['default'].controlData.btnEnable = false;
			_radiusData2['default'].controlData.ismeasured = [];
			_radiusData2['default'].controlData.rulerAngle = 0;
			resetBtn.addClass("click_disabled");
		}
		//校正角度为0到360范围
		function adjustAngle(temAngle) {
			temAngle = temAngle < 0 ? temAngle + 360 : temAngle;
			if (temAngle >= 360) temAngle -= 360;
			return temAngle;
		}

		//通过判断是否离开上一条测量半径3度范围决定是否显示半径标识及激活重置按钮
		function setRandBut() {
			if (!(Math.abs(angle - lineAngle[curLineIndex]) <= 3 || Math.abs(angle - 360) <= 3 && curLineIndex == 0)) {
				_radiusData2['default'].controlData.btnEnable = true;
				resetBtn.removeClass("click_disabled");

				// 显示 r=2;
				if (!_radiusData2['default'].controlData.ismeasured[curLineIndex]) {
					lineItem.eq(curLineIndex).find(".cirras_info").removeClass("hide_dom");
					_radiusData2['default'].controlData.ismeasured[curLineIndex] = true;
				}
			}
		}

		function rotate(event) {
			event = event.originalEvent;
			var ev = event.changedTouches ? event.changedTouches[0] : event;
			var temAngle = getAngle(ev);
			temAngle -= dis; //防尺子跳动
			temAngle = adjustAngle(temAngle);
			// 防抖动
			if (Math.abs(temAngle - lastAngle) < 0.5) return;
			angle = temAngle;
			//隐藏吸附点与标签
			point.addClass("hide_dom");
			focus.addClass("hide_dom");

			//更新尺子角度
			ruler.css({ transform: "rotateZ(" + angle + "deg)" });
			//判断超出原测量半径3度范围后显示r=2及激活重置按钮
			setRandBut();
			return true;
		}
	}

	module.exports = exports['default'];

	/***/
},
/* 7 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _radiusData = __webpack_require__(5);

	var _radiusData2 = _interopRequireDefault(_radiusData);

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function (view) {
		_presenter2['default'].$view.find(".btn_text").html(_radiusData2['default'].i18n["reset"]); //重置
	};

	module.exports = exports['default'];

	/***/
},
/* 8 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function (path) {
		_presenter2['default'].path = path;
	};

	module.exports = exports['default'];

	/***/
},
/* 9 */
/***/function (module, exports, __webpack_require__) {

	/**
  * 运行环境下, 销毁Module时执行的方法
  * @remark 该方法为Module生命周期方法, 仅在ICPlayer切换页面时执行
  */
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function () {
		//解除绑定的Module事件
	};

	module.exports = exports['default'];

	/***/
},
/* 10 */
/***/function (module, exports, __webpack_require__) {

	/**
  * Created by liuyuanpeng on 2016/6/23.
  */
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function () {
		var question_id = '',
		    question_url = '';
		if (_presenter2['default'].model !== undefined) {
			try {
				question_id = _presenter2['default'].model.question_id;
				question_url = JSON.stringify(_presenter2['default'].model.question_url);
			} catch (e) {
				console.log('json stringify failed');
			}
		}
		return {
			id: question_id,
			dispatchOnly: true,
			type_code: 'CircleRadiusSurvey',
			type_name: '圆半径测量',
			url: question_url,
			notExistStatistics: true,
			noNeedQuizProgress: true
		};
	};

	module.exports = exports['default'];

	/***/
},
/* 11 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	var _radiusData = __webpack_require__(5);

	var _radiusData2 = _interopRequireDefault(_radiusData);

	exports['default'] = function () {
		var result = {
			width: "100%",
			gTran: _radiusData2['default'].controlData
		};
		return result;
	};

	module.exports = exports['default'];

	/***/
},
/* 12 */
/***/function (module, exports) {

	"use strict";

	Object.defineProperty(exports, "__esModule", {
		value: true
	});

	exports["default"] = function () {};

	module.exports = exports["default"];

	/***/
},
/* 13 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _setLangType = __webpack_require__(14);

	var _setLangType2 = _interopRequireDefault(_setLangType);

	exports['default'] = function (urlParams) {
		(0, _setLangType2['default'])(urlParams);
	};

	module.exports = exports['default'];

	/***/
},
/* 14 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _presenter = __webpack_require__(2);

	var _presenter2 = _interopRequireDefault(_presenter);

	exports['default'] = function (obj) {
		_presenter2['default'].langType = obj._lang_;
	};

	module.exports = exports['default'];

	/***/
},
/* 15 */
/***/function (module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequireDefault(obj) {
		return obj && obj.__esModule ? obj : { 'default': obj };
	}

	var _radiusData = __webpack_require__(5);

	var _radiusData2 = _interopRequireDefault(_radiusData);

	exports['default'] = function (properties) {
		_radiusData2['default'].i18n = properties;
	};

	module.exports = exports['default'];

	/***/
}]);]]></presenter><resources><file src="./resources/images/bg_num.png"/><file src="./resources/images/icon_rotate_act.png"/><file src="./resources/images/icon_rotate.png"/><file src="./resources/images/ruler.png"/></resources></addon>