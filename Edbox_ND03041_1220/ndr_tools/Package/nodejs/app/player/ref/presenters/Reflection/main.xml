<?xml version='1.0' encoding='UTF-8'?>
<addon id="templateid"><properties><property name="question_id" displayName="题目ID" type="string" isLocalized="false"/></properties><dependencies><jsDependency><javaScript name="out_frame" version="1.0.8"/><javaScript name="lightReflector" version="1.1.2"/><javaScript name="kitty" version="2.0.4.1"/><javaScript name="tools_common" version="1.3.0"/></jsDependency></dependencies><css><![CDATA[.exam_skin_wood .reflection{position:relative;width:100%;height:100%;background:#bfd3e2;text-align:center;overflow:hidden}.exam_skin_wood .reflection .reflection_middle{position:absolute;left:0;right:0;top:2.66667em;bottom:4.91667em}.exam_skin_wood .reflection .reflection_middle:after{content:"";display:inline-block;width:0;height:100%;vertical-align:middle}.exam_skin_wood .reflection .reflection_mid_container{position:relative;display:inline-block;width:71.58333em;height:37.33333em;vertical-align:middle;padding-left:1.2em}.exam_skin_wood .reflection .reflection_aside,.exam_skin_wood .reflection .reflection_main{vertical-align:top}.exam_skin_wood .reflection .reflection_main{float:left;position:relative;width:63.33333em;height:37.33333em;-webkit-perspective:200em;perspective:200em;-moz-perspective:200em;-ms-perspective:200em;-webkit-perspective-origin:31.5em 50%;perspective-origin:31.5em 50%;-moz-perspective-origin:31.5em 50%;-ms-perspective-origin:31.5em 50%;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.exam_skin_wood .reflection .reflection_main.flip .page_left{-webkit-animation:flipBook1 3s linear 0s forwards;animation:flipBook1 3s linear 0s forwards;-webkit-transform-origin:100% 50%;transform-origin:100% 50%;will-change:transform}.exam_skin_wood .reflection .reflection_main.flip .page_main.left_wrap{-webkit-animation:flipBook2 3s linear 0s forwards;animation:flipBook2 3s linear 0s forwards}.exam_skin_wood .reflection .reflection_main.flip .cover_page{-webkit-animation:flipBook3 3s linear 0s forwards;animation:flipBook3 3s linear 0s forwards;-webkit-transform-origin:0 50%;transform-origin:0 50%}.exam_skin_wood .reflection .page_main{position:absolute;padding:.625em 1.25em .83333em;width:62.83333em;height:37.08333em;left:0;top:.20833em;background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:100% 100%;background-position:100% 0}.exam_skin_wood .reflection .page_main.left_wrap{left:0;top:0;background:0 0}.exam_skin_wood .reflection .reflection_page{position:absolute;width:31.41667em;height:37.08333em;left:0;top:.20833em;z-index:9}.exam_skin_wood .reflection .reflection_page.cover_page{left:0;background:#bfd3e2;z-index:11;-webkit-transform:rotateY(0);transform:rotateY(0);opacity:0}.exam_skin_wood .reflection .reflection_page.page_left{z-index:11;overflow:hidden}.exam_skin_wood .reflection .reflection_page.page_right{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:100% 0}.exam_skin_wood .reflection .reflection_page_btn{background:url(resources/wood/images/page_btn.png) no-repeat;width:100%;height:100%;background-size:100% 100%}.exam_skin_wood .reflection .reflection_aside{float:left;position:relative;width:5.83333em;height:33.33333em;margin-top:2.29167em;background:#b1c9dc;border-radius:.33333em;overflow:hidden}.exam_skin_wood .reflection .flip-animation-1{-webkit-animation:flipBook1 3s linear 0s forwards;animation:flipBook1 3s linear 0s forwards;-webkit-transform-origin:.20833em 0;transform-origin:.20833em 0;-webkit-transform:rotateY(0);transform:rotateY(0)}.exam_skin_wood .reflection .reflection_foot{position:absolute;left:0;right:0;bottom:0;padding:0 4.16667em;height:4.91667em;background:#cfdee9;text-align:center}.exam_skin_wood .reflection .reflection_foot .footer_inbock{display:inline-block;height:100%}.exam_skin_wood .reflection .reflection_btm_left{float:right;height:100%}.exam_skin_wood .reflection .reflection_left_btn_a{display:block;height:100%}.exam_skin_wood .reflection .reflection_left_btn{position:relative;display:inline-block;float:left;min-width:5.41667em;height:100%;margin:0 1.83333em;text-align:center}.exam_skin_wood .reflection .reflection_btm_right{position:relative;float:right;height:100%;padding:1.04167em 1.45833em 0 1.54167em}.exam_skin_wood .reflection .reflection_btm_right:before{content:"";position:absolute;left:0;top:0;display:block;float:left;width:0;height:100%;border-left:1px solid #e7f3fc;border-right:1px solid #b3c1cb}.exam_skin_wood .reflection .reflection_brbtn_lay{float:left;margin:0 1.04167em}.exam_skin_wood .reflection .reflection_brbtn_lay.click_disabled .reflection_brbtn{border-color:#93989a;background:linear-gradient(180deg,#c8d1d7 0,#c1c8cc)}.exam_skin_wood .reflection .reflection_brbtn_lay.click_disabled .reflection_brbtn .text{color:#97a0a6}.exam_skin_wood .reflection .reflection_brbtn{display:block;padding:0 .75em;min-width:6.25em;height:2.83333em;line-height:2.75em;background:linear-gradient(180deg,#fff 0,#e9e9e9);border:1px solid #397274;border-radius:.33333em;color:#333;text-align:center}.exam_skin_wood .reflection .reflection_brbtn .text{font-size:1.16667em}.exam_skin_wood .reflection .reflection_brbtn:active{background:linear-gradient(180deg,#89c5c7 0,#77b8ba);color:#fff}.exam_skin_wood .reflection .reflection_mode_list{position:relative;height:100%}.exam_skin_wood .reflection .reflection_mode{position:relative;float:left;width:100%;height:5.54167em;background:url(resources/wood/images/icon_preset.png) no-repeat;background-size:3.91667em auto;cursor:pointer}.exam_skin_wood .reflection .reflection_mode.drsgx{background-position:center -.625em}.exam_skin_wood .reflection .reflection_mode.dfsgx{background-position:center -7.08333em}.exam_skin_wood .reflection .reflection_mode.rfsgx{background-position:center -13.25em}.exam_skin_wood .reflection .reflection_mode.sfsgx{background-position:center -19.58333em}.exam_skin_wood .reflection .reflection_mode.sqrsgx{background-position:center -25.5em}.exam_skin_wood .reflection .reflection_mode.glkn{background:url(resources/wood/images/icon_glkn.png) no-repeat;background-position:1.04167em .83333em;background-size:4.33333em auto}.exam_skin_wood .reflection .reflection_mode.on:after{content:"";display:block;position:absolute;left:0;top:0;width:100%;height:100%;background:rgba(91,146,186,.3)}.exam_skin_wood .reflection .reflection_tip{position:absolute;top:2.08333em;left:1.66667em;padding:.5em 1em .5em .95833em;background:rgba(106,159,201,.37);border-radius:.33333em;white-space:nowrap}.exam_skin_wood .reflection .reflection_tip_word{display:inline-block;text-align:left;vertical-align:top;font-weight:700}.exam_skin_wood .reflection .reflection_tip_word .faxian,.exam_skin_wood .reflection .reflection_tip_word .rushedian,.exam_skin_wood .reflection .reflection_tip_word .rusheguangxian,.exam_skin_wood .reflection .reflection_tip_word .rushejiao,.exam_skin_wood .reflection .reflection_tip_word .zheshejiao,.exam_skin_wood .reflection .reflection_tip_word .zheshiguangxian{height:2.75em;line-height:2.75em}.exam_skin_wood .reflection .reflection_tip_word .faxian .text,.exam_skin_wood .reflection .reflection_tip_word .rushedian .text,.exam_skin_wood .reflection .reflection_tip_word .rusheguangxian .text,.exam_skin_wood .reflection .reflection_tip_word .rushejiao .text,.exam_skin_wood .reflection .reflection_tip_word .zheshejiao .text,.exam_skin_wood .reflection .reflection_tip_word .zheshiguangxian .text{font-size:2em}.exam_skin_wood .reflection .reflection_tip_word .faxian .text{color:#4d4d4d}.exam_skin_wood .reflection .reflection_tip_word .rushedian .text{color:#ffe434}.exam_skin_wood .reflection .reflection_tip_word .zheshejiao .text{color:#04740b}.exam_skin_wood .reflection .reflection_tip_word .rushejiao .text{color:#8300de}.exam_skin_wood .reflection .reflection_tip_word .rusheguangxian .text{color:#005798}.exam_skin_wood .reflection .reflection_tip_word .zheshiguangxian .text{color:#cb1f1f}.exam_skin_wood .reflection .reflection_tip_pic{display:inline-block;margin-left:1.41667em;width:3.04167em;text-align:center;vertical-align:top}.exam_skin_wood .reflection .reflection_tip_pic li{width:100%;height:2.75em;background:url(resources/wood/images/tips.png) no-repeat;background-size:100% auto}.exam_skin_wood .reflection .reflection_tip_pic .faxian{background-position:0 0}.exam_skin_wood .reflection .reflection_tip_pic .rushedian{background-position:0 -2.66667em}.exam_skin_wood .reflection .reflection_tip_pic .zheshejiao{background-position:0 -5.5em}.exam_skin_wood .reflection .reflection_tip_pic .rushejiao{background-position:0 -8.25em}.exam_skin_wood .reflection .reflection_tip_pic .rusheguangxian{background-position:0 -11.16667em}.exam_skin_wood .reflection .reflection_tip_pic .zheshiguangxian{background-position:0 -14em}@-webkit-keyframes flipBook1{0%{background:url(resources/wood/images/page_btn.png) no-repeat;background-size:33.33333em 100%;background-position:0 0;-webkit-transform:rotateY(179.9deg) perspective(600px);transform:rotateY(179.9deg) perspective(600px)}50%{background:url(resources/wood/images/page_btn.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(90deg) perspective(600px);transform:rotateY(90deg) perspective(600px)}52%{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0}99.9%{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(0) perspective(600px);transform:rotateY(0) perspective(600px);opacity:1}to{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(0) perspective(600px);transform:rotateY(0) perspective(600px);opacity:0}}@keyframes flipBook1{0%{background:url(resources/wood/images/page_btn.png) no-repeat;background-size:33.33333em 100%;background-position:0 0;-webkit-transform:rotateY(179.9deg) perspective(600px);transform:rotateY(179.9deg) perspective(600px)}50%{background:url(resources/wood/images/page_btn.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(90deg) perspective(600px);transform:rotateY(90deg) perspective(600px)}52%{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0}99.9%{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(0) perspective(600px);transform:rotateY(0) perspective(600px);opacity:1}to{background:url(resources/wood/images/page_wrap_bg.png) no-repeat;background-size:44.5em 100%;background-position:0 0;-webkit-transform:rotateY(0) perspective(600px);transform:rotateY(0) perspective(600px);opacity:0}}@-webkit-keyframes flipBook2{0%{opacity:0}50%{opacity:0}50.1%{opacity:1}to{opacity:1}}@keyframes flipBook2{0%{opacity:0}50%{opacity:0}50.1%{opacity:1}to{opacity:1}}@-webkit-keyframes flipBook3{0%{opacity:1}99.9%{opacity:1}to{opacity:0}}@keyframes flipBook3{0%{opacity:1}99.9%{opacity:1}to{opacity:0}}.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .faxian .text,.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .rushedian .text,.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .rusheguangxian .text,.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .rushejiao .text,.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .zheshejiao .text,.typefaces_long .exam_skin_wood .reflection .reflection_tip_word .zheshiguangxian .text{display:inline-block;font-size:1.41667em;white-space:normal;max-width:6.25em;line-height:.9}.typefaces_long .exam_skin_wood .reflection .reflection_tip_word li{margin:.41667em 0}.typefaces_long .exam_skin_wood .reflection .reflection_tip_pic li{margin:.29167em 0}.typefaces_long .exam_skin_wood .reflection .reflection_brbtn{max-width:11.04167em;line-height:1.2em;height:2.83333em}.typefaces_long .exam_skin_wood .reflection .reflection_brbtn .text{font-size:1.08333em}.typefaces_long .exam_skin_wood .reflection_btm_right{padding-right:0}.typefaces_long .exam_skin_wood .reflection_btm_right .reflection_brbtn_lay{margin:0 .5em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn{margin:0 .83333em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:first-of-type .tool_operate_bar{max-width:10.83333em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:first-of-type .tool_operate_bar .tool_operate_text{font-size:1.08333em;line-height:1;margin-top:0}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2){margin-left:1.45833em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2) .tool_operate_bar{max-width:8.75em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2) .tool_operate_bar .tool_operate_text{font-size:1.08333em;line-height:1;margin-top:0}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3){margin:0 3.33333em 0 4.41667em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3) .tool_operate_text{display:none}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3) .tool_operate_imgcnt{height:3.33333em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(4){padding-top:.4em}.typefaces_long .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(4) .tool_operate_text{margin-top:.4em;font-size:1.08333em;line-height:1;white-space:nowrap}.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .faxian .text,.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .rushedian .text,.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .rusheguangxian .text,.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .rushejiao .text,.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .zheshejiao .text,.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word .zheshiguangxian .text{display:inline-block;font-size:1.41667em;white-space:normal;max-width:6.25em;line-height:.9}.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_word li{margin:.41667em 0}.typefaces_ru_RU .exam_skin_wood .reflection .reflection_tip_pic li{margin:.29167em 0}.typefaces_ru_RU .exam_skin_wood .reflection .reflection_brbtn{max-width:11.04167em;line-height:1.2em;height:2.83333em}.typefaces_ru_RU .exam_skin_wood .reflection .reflection_brbtn .text{font-size:1.08333em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_right{padding-right:0}.typefaces_ru_RU .exam_skin_wood .reflection_btm_right .reflection_brbtn_lay{margin:0 .5em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn{margin:0 .83333em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:first-of-type .tool_operate_bar{max-width:10.83333em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:first-of-type .tool_operate_bar .tool_operate_text{font-size:1.08333em;line-height:1;margin-top:0}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2){margin-left:1.45833em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2) .tool_operate_bar{max-width:8.75em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(2) .tool_operate_bar .tool_operate_text{font-size:1.08333em;line-height:1;margin-top:0}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3){margin:0 3.33333em 0 4.41667em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3) .tool_operate_text{display:none}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(3) .tool_operate_imgcnt{height:3.33333em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(4){padding-top:.4em}.typefaces_ru_RU .exam_skin_wood .reflection_btm_left .reflection_left_btn:nth-of-type(4) .tool_operate_text{margin-top:.4em;font-size:1.08333em;line-height:1;white-space:nowrap}]]></css><view><![CDATA[<div class="exam_skin_wood"><div class="reflection lightMovement"><div class="reflection_middle"><div class="reflection_mid_container"><div class="reflection_main flip"><div class="reflection_page cover_page"></div><div class="page_main"><div class="reflection_tip _js_tip"><ul class="reflection_tip_word"><li class="faxian"><span class="text _js_tip_normal_line">法线</span></li><li class="rushedian"><span class="text _js_tip_incidence_point">入射点</span></li><li class="zheshejiao"><span class="text _js_tip_reflection_angle">反射角</span></li><li class="rushejiao"><span class="text _js_tip_incidence_angle">入射角</span></li><li class="rusheguangxian"><span class="text _js_tip_incidence_line">入射光线</span></li><li class="zheshiguangxian"><span class="text _js_tip_reflection_line">反射光线</span></li></ul><ul class="reflection_tip_pic"><li class="faxian"></li><li class="rushedian"></li><li class="zheshejiao"></li><li class="rushejiao"></li><li class="rusheguangxian"></li><li class="zheshiguangxian"></li></ul></div><div class="page_main_svg" style="position: relative"></div></div><div class="reflection_page page_left"><div class="page_main left_wrap"><div class="js_reflection_tip"></div><div class="js_temp_svg"></div></div></div></div><div class="reflection_aside"><ul class="reflection_mode_list"><li class="reflection_mode drsgx on _js_mode_li _js_drsgx"></li><li class="reflection_mode dfsgx _js_mode_li _js_dfsgx"></li><li class="reflection_mode glkn _js_mode_li _js_glkn"></li><li class="reflection_mode rfsgx _js_mode_li _js_rfsgx"></li><li class="reflection_mode sfsgx _js_mode_li _js_sfsgx"></li><li class="reflection_mode sqrsgx _js_mode_li _js_sqrsgx"></li></ul></div></div></div><div class="reflection_foot"><div class="footer_inbock"><ul class="reflection_btm_right clearfix"><li class="reflection_brbtn_lay _js_done_li"><a href="#" class="reflection_brbtn"><em class="text _js_done_li_text">一键完成</em></a></li><li class="reflection_brbtn_lay _js_step_li"><a href="#" class="reflection_brbtn"><em class="text _js_step_li_text">逐步画</em></a></li></ul><ul class="reflection_btm_left clearfix"><li class="reflection_left_btn btn_ghq _js_btn_li _js_ghq"><a href="javascript:;" class="tool_operate_bar"><span class="tool_operate_imgcnt"><i class="tool_operate_icon tool_ghq _js_tool_ghq"></i> </span><span class="tool_operate_text _js_ghq_text">光与面夹角</span></a></li><li class="reflection_left_btn btn_ghfx _js_btn_li _js_ghfx"><a href="javascript:;" class="tool_operate_bar"><span class="tool_operate_imgcnt"><i class="tool_operate_icon tool_ghfx _js_tool_ghfx"></i> </span><span class="tool_operate_text _js_ghfx_text">入/反射角</span></a></li><li class="reflection_left_btn btn_reset _js_btn_li _js_reset"><a href="javascript:;" class="tool_operate_bar"><span class="tool_operate_imgcnt"><i class="tool_operate_icon tool_reset"></i> </span><span class="tool_operate_text _js_reset_text">重置</span></a></li><li class="reflection_left_btn _js_btn_li _js_switch"><a href="javascript:;" class="tool_operate_bar"><span class="tool_operate_imgcnt"><label class="com_applicationset_switch"><input type="checkbox"></label></span><span class="tool_operate_text _js_switch_text">显示名称</span></a></li></ul></div></div></div></div>]]></view><presenter><![CDATA["use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

(function () {

    var i18nModel = {
        "rf_angle_of_line": "光与面夹角",
        "rf_in_and_re_angle": "入/反射角",
        "rf_reset": "重置",
        "rf_show_name": "显示名称",
        "rf_draw_all": "一键完成",
        "rf_draw_next": "逐步画",
        "rf_incidence_line_name": "入射光线",
        "rf_reflection_line_name": "反射光线",
        "rf_reflection_surface": "反射面",
        "rf_normal_name": "法线",
        "rf_incidence_angle": "入射角",
        "rf_reflection_angle": "反射角",
        "rf_incidence_point": "入射点",
        "rf_equal_angle_name": "反射角=入射角=0°"
    };
    var Presenter = BasicPresenter.extend({
        metaInfo: {
            name: "Reflection",
            type: PresenterType.PRESENTER_COMPONENT,
            subtype: ""
        },
        /**
         * Presenter的初始化方法
         * @private
         */
        $init: function $init() {
            this._super();
        },
        /**
         * Presenter对外暴露的方法
         */
        _service_: {
            constructor: function constructor(parent) {
                this.parent = parent;
            },
            setLocationProperties: function setLocationProperties(data) {
                $.extend(i18nModel, data || {});
            },
            getExtendData: function getExtendData() {
                var data = {};
                data.reflector = this.parent.reflector.getData();
                data.nameVisible = this.parent.$applicationsetSwitch.hasClass('checked');
                data.surfaceAngleVisible = this.parent.reflector.getSurfaceAngleVisible();
                data.normalAngleVisible = this.parent.reflector.getNormalAngleVisible();
                data.currentIndex = this.parent.reflector.getCurrentIndex();
                return data;
            }
        },
        getService: function getService() {
            this._service_.constructor(this);
            return this._service_;
        },
        /****以下开始为icPlayer的生命周期方法*****/
        run: function run(view, model) {
            var $deferred = $.Deferred();
            var that = this;
            this.$view = $(view);
            this.model = model;
            this.animateFinish = false;
            var data = model.__ExtendModel;

            //初始化获取dom对象
            this._findView();
            this.reflector = LightReflector.create({
                reflectorType: [1, 2, 6, 3, 4, 5],
                nameVisible: false,
                viewPortWidth: 1300, //1300
                viewPortHeight: 766, //766
                surfaceAngleVisible: data ? data.surfaceAngleVisible : true,
                normalAngleVisible: data ? data.normalAngleVisible : true,
                langData: i18nModel
            });

            var $mainSvg = this.$view.find('.page_main_svg');
            var $tempSvg = this.$view.find('.js_temp_svg');
            $mainSvg.css('visibility', 'hidden');
            $tempSvg.css('visibility', 'hidden');
            this.$view.find('._js_tip').css('visibility', 'hidden');
            //LightReflector.setLogLevel('debug');
            this.reflector.on('change', function (type) {
                that._initNextBtnStatus();
            });
            if (data) {
                this.reflector.setData(data.reflector);
                this.reflector.render($mainSvg);

                if (_typeof(data.currentIndex) !== (typeof undefined === "undefined" ? "undefined" : _typeof(undefined))) {
                    this.$jsDesignList.removeClass('on');
                    this.$jsDesignList.eq(data.currentIndex).addClass('on');
                    this.reflector.show(data.currentIndex);
                }
            } else {
                this.reflector.render($mainSvg);
            }

            //创建临时显示内容
            var tempReflector = LightReflector.create({
                reflectorType: [1],
                nameVisible: false,
                viewPortWidth: 1300, //1300
                viewPortHeight: 766, //766
                surfaceAngleVisible: data ? data.surfaceAngleVisible : true,
                normalAngleVisible: data ? data.normalAngleVisible : true,
                langData: i18nModel,
                showDefaultRotateBtn: true
            });
            tempReflector.render($tempSvg);
            tempReflector.setLock(true);
            this.reflector.setLock(true);
            var $reflectionTip = this.$view.find('.js_reflection_tip');

            //延迟处理，样式应用会出现延迟现象
            setTimeout(function () {
                that.$view.find('.reflection_main').addClass('flip');
                $reflectionTip.append(that.$view.find('._js_tip')[0].outerHTML);
                $mainSvg.css('visibility', '');
                that.$view.find('._js_tip').css('visibility', '');
                $tempSvg.css('visibility', '');
                that.$view.find('.reflection_mid_container').css('visibility', '');
                that.reflector.updatePos();
                tempReflector.updatePos();
            }, 200);

            //动画结束回调
            setTimeout(function () {
                that.animateFinish = true;
                that.reflector.setLock(false);
                //移除临时层
                that.$view.find('.reflection_page.page_left').remove();
                that.$view.find('.reflection_page.cover_page').remove();
                // $deferred.resolve();
            }, 3100);

            that._initNextBtnStatus();
            this._i18n();
            if (this.reflector.getSurfaceAngleVisible()) {
                this.$jsToolGhq.removeClass("tool_ghqha");
            } else {
                this.$jsToolGhq.addClass("tool_ghqha");
            }
            if (this.reflector.getNormalAngleVisible()) {
                this.$jsToolGhfx.removeClass("tool_ghfxha");
            } else {
                this.$jsToolGhfx.addClass("tool_ghfxha");
            }
            var nameVisible = data ? data.nameVisible : true;
            if (nameVisible) {
                this.$applicationsetSwitch.addClass("checked");
            } else {
                this.$applicationsetSwitch.removeClass("checked");
            }
            $deferred.resolve();
            return $deferred.promise();
        },
        afterRender: function afterRender() {
            var that = this;
            $('.tooldiolag_control').css('visibility', '');
            var $deferred = $.Deferred();
            setTimeout(function () {
                $deferred.resolve();
                player.controller.getEventBus().sendEvent("PLAYER.TOOL.FORBIDE_FULL", { id: that.model.$.unqiueId, isForbide: false });
            }, 3100);
            return $deferred.promise();
        },
        pageShow: function pageShow() {

            this._bindEvent();
        },
        pageLeave: function pageLeave() {
            this._unbindEvent();
        },
        destroy: function destroy() {
            this.reflector.destroy();
        },
        /****以下开始为Presenter的私有方法*****/
        _findView: function _findView() {
            this._$jsDoneLi = this.$view.find('._js_done_li');
            this._$jsStepLi = this.$view.find('._js_step_li');
            this.$jsTip = this.$view.find('._js_tip');
            this.$jsToolList = this.$view.find("._js_btn_li");
            this.$jsDesignList = this.$view.find(".reflection_mode");
            this.$applicationsetSwitch = this.$view.find('.com_applicationset_switch');
            this.$jsToolGhq = this.$view.find('._js_tool_ghq');
            this.$jsToolGhfx = this.$view.find('._js_tool_ghfx');
        },
        _initNextBtnStatus: function _initNextBtnStatus() {
            if (this.reflector.hasNext()) {
                this._$jsDoneLi.removeClass('click_disabled');
                this._$jsStepLi.removeClass('click_disabled');
            } else {
                this._$jsDoneLi.addClass('click_disabled');
                this._$jsStepLi.addClass('click_disabled');
            }
        },
        _i18n: function _i18n() {
            this.$view.find('._js_done_li_text').html(i18nModel['rf_draw_all']);
            this.$view.find('._js_step_li_text ').html(i18nModel['rf_draw_next']);
            this.$view.find('._js_ghq_text ').html(i18nModel['rf_angle_of_line']);
            this.$view.find('._js_ghfx_text ').html(i18nModel['rf_in_and_re_angle']);
            this.$view.find('._js_reset_text ').html(i18nModel['rf_reset']);
            this.$view.find('._js_switch_text ').html(i18nModel['rf_show_name']);

            this.$view.find('._js_tip_normal_line').html(i18nModel['rf_normal_name']);
            this.$view.find('._js_tip_incidence_point').html(i18nModel['rf_incidence_point']);
            this.$view.find('._js_tip_reflection_angle').html(i18nModel['rf_reflection_angle']);
            this.$view.find('._js_tip_incidence_angle').html(i18nModel['rf_incidence_angle']);
            this.$view.find('._js_tip_incidence_line').html(i18nModel['rf_incidence_line_name']);
            this.$view.find('._js_tip_reflection_line').html(i18nModel['rf_reflection_line_name']);
        },
        _bindEvent: function _bindEvent() {
            var that = this;
            this._$jsDoneLi.on('click', function () {
                if (!that.animateFinish) {
                    return;
                }
                that.reflector.drawAll();
                that._$jsDoneLi.addClass('click_disabled');
                that._$jsStepLi.addClass('click_disabled');
            });

            this._$jsStepLi.on('click', function () {
                if (!that.animateFinish) {
                    return;
                }
                that.reflector.drawNext();
                that._initNextBtnStatus();
            });

            this.$jsToolList.on('click', function (e) {
                e.preventDefault();
                if (!that.animateFinish) {
                    return;
                }
                if ($(this).hasClass('_js_ghq')) {
                    //是光与面夹角
                    that.$jsToolGhq.toggleClass("tool_ghqha");
                    that.reflector.setSurfaceAngleVisible(!that.reflector.getSurfaceAngleVisible());
                } else if ($(this).hasClass('_js_ghfx')) {
                    //入射角和反射角
                    that.$jsToolGhfx.toggleClass("tool_ghfxha");
                    that.reflector.setNormalAngleVisible(!that.reflector.getNormalAngleVisible());
                } else if ($(this).hasClass('_js_reset')) {
                    that.reflector.reset();
                } else {
                    that.$applicationsetSwitch.toggleClass("checked");
                    if (that.$applicationsetSwitch.hasClass('checked')) {
                        that.$jsTip.show();
                    } else {
                        that.$jsTip.hide();
                    }
                }
            });
            that.$jsDesignList.on('click', function () {
                if (!that.animateFinish) {
                    return;
                }
                var num = $(this).index();
                that.reflector.show(num);
                that.$jsDesignList.removeClass('on');
                $(this).addClass('on');
                that._initNextBtnStatus();
            });
        },
        _unbindEvent: function _unbindEvent() {}
    });
    window.AddonReflection_create = function () {
        return new Presenter('Reflection');
    };
})();]]></presenter><resources><file src="./resources/wood/images/icon_glkn.png"/><file src="./resources/wood/images/icon_movelight.png"/><file src="./resources/wood/images/icon_preset.png"/><file src="./resources/wood/images/page_btn.png"/><file src="./resources/wood/images/page_wrap_bg.png"/><file src="./resources/wood/images/tips.png"/></resources></addon>