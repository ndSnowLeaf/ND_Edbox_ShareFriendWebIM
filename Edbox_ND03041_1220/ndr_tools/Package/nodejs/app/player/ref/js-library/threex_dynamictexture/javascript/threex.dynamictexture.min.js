var THREEx=THREEx||{};THREEx.DynamicTexture=function(t,e){var i=document.createElement("canvas");i.width=t,i.height=e,this.canvas=i;var n=i.getContext("2d");this.context=n;var a=new THREE.Texture(i);this.texture=a},THREEx.DynamicTexture.prototype.clear=function(t){return void 0!==t?(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.texture.needsUpdate=!0,this},THREEx.DynamicTexture.prototype.drawText=function(t,e,i,n,a){if(void 0!==a&&(this.context.font=a),void 0===e||null===e){var r=this.context.measureText(t);e=(this.canvas.width-r.width)/2}return this.context.fillStyle=n,this.context.fillText(t,e,i),this.texture.needsUpdate=!0,this},THREEx.DynamicTexture.prototype.drawTextCooked=function(t){function e(t){for(var e="",a=(1-2*r.margin)*n.width;e.length!==t.length;){var h=i.measureText(e);if(h.width>a)break;e+=t.substr(e.length,1)}return e}var i=this.context,n=this.canvas;t=t||{};var a=t.text,r={margin:void 0!==t.margin?t.margin:.1,lineHeight:void 0!==t.lineHeight?t.lineHeight:.1,align:void 0!==t.align?t.align:"left",fillStyle:void 0!==t.fillStyle?t.fillStyle:"black",font:void 0!==t.font?t.font:"bold 102.4px Arial"};console.assert("string"==typeof a),i.save(),i.fillStyle=r.fillStyle,i.font=r.font;for(var h=(r.lineHeight+r.margin)*n.height;a.length>0;){var s=e(a);a=a.substr(s.length);var l=i.measureText(s);if("left"===r.align)var o=r.margin*n.width;else if("right"===r.align)var o=(1-r.margin)*n.width-l.width;else if("center"===r.align)var o=(n.width-l.width)/2;else console.assert(!1);this.context.fillText(s,o,h),h+=r.lineHeight*n.height}return i.restore(),this.texture.needsUpdate=!0,this},THREEx.DynamicTexture.prototype.drawImage=function(){return this.context.drawImage.apply(this.context,arguments),this.texture.needsUpdate=!0,this};